{
  "version": 1,
  "config": {
    "sample_questions": [
      {
        "id": "a1a2b3c4d5e6789012345678901234a1",
        "question": [
          "What is the overall platform health score?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a2",
        "question": [
          "Show me key metrics across all domains"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a3",
        "question": [
          "Are there any critical alerts today?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a4",
        "question": [
          "What anomalies were detected across the platform?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a5",
        "question": [
          "What is our total spend this month?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a6",
        "question": [
          "Which workspaces cost the most?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a7",
        "question": [
          "Show me cost anomalies"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a8",
        "question": [
          "What is our job success rate?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234a9",
        "question": [
          "Show me failed jobs today"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234aa",
        "question": [
          "Which jobs are likely to fail?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234ab",
        "question": [
          "What is our P95 query duration?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234ac",
        "question": [
          "Show me slow queries"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234ad",
        "question": [
          "Which clusters are underutilized?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234ae",
        "question": [
          "Who accessed sensitive data?"
        ]
      },
      {
        "id": "a1a2b3c4d5e6789012345678901234af",
        "question": [
          "Are there any security anomalies?"
        ]
      }
    ]
  },
  "data_sources": {
    "tables": [
      {
        "identifier": "${catalog}.${gold_schema}.dim_workspace",
        "description": [
          "Dimension table for workspace details.\n",
          "Business: Links all domains to specific Databricks workspaces."
        ],
        "column_configs": [
          {
            "column_name": "workspace_id",
            "description": [
              "Unique workspace identifier"
            ]
          },
          {
            "column_name": "workspace_name",
            "description": [
              "Human-readable workspace name"
            ],
            "get_example_values": true,
            "build_value_dictionary": true
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_sku",
        "description": [
          "Dimension table containing all unique Databricks SKU identifiers.\n",
          "Business: Master reference for product/service pricing categories."
        ],
        "column_configs": [
          {
            "column_name": "sku_name",
            "description": [
              "SKU identifier determining pricing rate"
            ],
            "get_example_values": true,
            "build_value_dictionary": true
          },
          {
            "column_name": "cloud",
            "description": [
              "Cloud provider for this SKU"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_job",
        "description": [
          "Dimension table for job definitions.\n",
          "Business: Job metadata for reliability tracking."
        ],
        "column_configs": [
          {
            "column_name": "job_id",
            "description": [
              "Job identifier"
            ]
          },
          {
            "column_name": "name",
            "description": [
              "Job name"
            ],
            "synonyms": [
              "job_name",
              "workflow"
            ],
            "get_example_values": true,
            "build_value_dictionary": true
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_usage",
        "description": [
          "Fact table tracking all billable Databricks usage.\n",
          "Business: Primary source for cost monitoring."
        ],
        "column_configs": [
          {
            "column_name": "list_cost",
            "description": [
              "Calculated cost"
            ],
            "synonyms": [
              "cost",
              "spend"
            ]
          },
          {
            "column_name": "usage_date",
            "description": [
              "Calendar date of usage"
            ],
            "get_example_values": true
          },
          {
            "column_name": "workspace_id",
            "description": [
              "Workspace identifier"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_job_run_timeline",
        "description": [
          "Job execution timeline.\n",
          "Business: Job-level reliability tracking."
        ],
        "column_configs": [
          {
            "column_name": "result_state",
            "description": [
              "Job result: SUCCESS, FAILED, etc."
            ],
            "get_example_values": true
          },
          {
            "column_name": "run_date",
            "description": [
              "Date of job run"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_query_history",
        "description": [
          "Query execution history.\n",
          "Business: Query-level performance tracking."
        ],
        "column_configs": [
          {
            "column_name": "execution_status",
            "description": [
              "Query status: FINISHED, FAILED, etc."
            ],
            "get_example_values": true
          },
          {
            "column_name": "duration_ms",
            "description": [
              "Query duration in milliseconds"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_audit_logs",
        "description": [
          "Security audit events.\n",
          "Business: Security and compliance tracking."
        ],
        "column_configs": [
          {
            "column_name": "service_name",
            "description": [
              "Service generating the event"
            ],
            "get_example_values": true
          },
          {
            "column_name": "action_name",
            "description": [
              "Action performed"
            ],
            "get_example_values": true
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_node_timeline",
        "description": [
          "Cluster node usage timeline.\n",
          "Business: Node-level compute for cluster optimization."
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_table_lineage",
        "description": [
          "Data lineage tracking.\n",
          "Business: Table-level lineage for quality analysis."
        ]
      },
      {
        "identifier": "prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_monitoring.fact_usage_profile_metrics",
        "description": [
          "Lakehouse Monitoring profile metrics for cost analysis.\n",
          "\u26a0\ufe0f CRITICAL: Always include filters: column_name=':table', log_type='INPUT'"
        ],
        "column_configs": [
          {
            "column_name": "column_name",
            "description": [
              "Column name - use ':table' for custom metrics"
            ]
          },
          {
            "column_name": "log_type",
            "description": [
              "Log type - use 'INPUT' for monitoring queries"
            ]
          },
          {
            "column_name": "total_daily_cost",
            "description": [
              "Custom metric: Total daily cost"
            ]
          },
          {
            "column_name": "serverless_ratio",
            "description": [
              "Custom metric: Serverless vs classic ratio"
            ]
          },
          {
            "column_name": "tag_coverage_pct",
            "description": [
              "Custom metric: Percentage of cost with tags"
            ]
          }
        ]
      },
      {
        "identifier": "prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_monitoring.fact_job_run_timeline_profile_metrics",
        "description": [
          "Lakehouse Monitoring profile metrics for job reliability.\n",
          "\u26a0\ufe0f CRITICAL: Always include filters: column_name=':table', log_type='INPUT'"
        ],
        "column_configs": [
          {
            "column_name": "column_name",
            "description": [
              "Column name - use ':table' for custom metrics"
            ]
          },
          {
            "column_name": "log_type",
            "description": [
              "Log type - use 'INPUT' for monitoring queries"
            ]
          },
          {
            "column_name": "success_rate",
            "description": [
              "Custom metric: Job success rate percentage"
            ]
          },
          {
            "column_name": "failure_count",
            "description": [
              "Custom metric: Total failure count"
            ]
          },
          {
            "column_name": "p90_duration",
            "description": [
              "Custom metric: 90th percentile duration"
            ]
          }
        ]
      },
      {
        "identifier": "prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_monitoring.fact_query_history_profile_metrics",
        "description": [
          "Lakehouse Monitoring profile metrics for query performance.\n",
          "\u26a0\ufe0f CRITICAL: Always include filters: column_name=':table', log_type='INPUT'"
        ],
        "column_configs": [
          {
            "column_name": "column_name",
            "description": [
              "Column name - use ':table' for custom metrics"
            ]
          },
          {
            "column_name": "log_type",
            "description": [
              "Log type - use 'INPUT' for monitoring queries"
            ]
          },
          {
            "column_name": "p99_duration_ms",
            "description": [
              "Custom metric: 99th percentile duration"
            ]
          },
          {
            "column_name": "sla_breach_rate",
            "description": [
              "Custom metric: SLA breach rate"
            ]
          },
          {
            "column_name": "queries_per_second",
            "description": [
              "Custom metric: Query throughput"
            ]
          }
        ]
      },
      {
        "identifier": "prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_monitoring.fact_audit_logs_profile_metrics",
        "description": [
          "Lakehouse Monitoring profile metrics for security events.\n",
          "\u26a0\ufe0f CRITICAL: Always include filters: column_name=':table', log_type='INPUT'"
        ],
        "column_configs": [
          {
            "column_name": "column_name",
            "description": [
              "Column name - use ':table' for custom metrics"
            ]
          },
          {
            "column_name": "log_type",
            "description": [
              "Log type - use 'INPUT' for monitoring queries"
            ]
          },
          {
            "column_name": "sensitive_access_rate",
            "description": [
              "Custom metric: Rate of sensitive data access"
            ]
          },
          {
            "column_name": "failure_rate",
            "description": [
              "Custom metric: Authentication failure rate"
            ]
          },
          {
            "column_name": "off_hours_rate",
            "description": [
              "Custom metric: Off-hours access rate"
            ]
          }
        ]
      }
    ],
    "metric_views": [
      {
        "identifier": "${catalog}.${gold_schema}.mv_cost_analytics",
        "description": [
          "Comprehensive cost analytics for Databricks billing and usage.\n",
          "PURPOSE: Track spending, trends, tag coverage, and serverless adoption.\n",
          "BEST FOR: Total spend | Cost by workspace | SKU breakdown | Tag coverage\n",
          "KEY MEASURES: total_cost, total_dbu, tag_coverage_pct, serverless_ratio"
        ],
        "column_configs": [
          {
            "column_name": "total_cost",
            "synonyms": [
              "cost",
              "spend",
              "spending"
            ]
          },
          {
            "column_name": "total_dbu",
            "synonyms": [
              "dbu",
              "units"
            ]
          },
          {
            "column_name": "workspace_name",
            "get_example_values": true,
            "build_value_dictionary": true
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.mv_job_performance",
        "description": [
          "Job execution metrics for reliability tracking.\n",
          "PURPOSE: Track job success rates, failures, and duration.\n",
          "BEST FOR: Success rate | Failure rate | P95 duration | Job volume\n",
          "KEY MEASURES: success_rate, failure_rate, p95_duration"
        ],
        "column_configs": [
          {
            "column_name": "success_rate",
            "synonyms": [
              "job success rate",
              "reliability"
            ]
          },
          {
            "column_name": "failure_rate",
            "synonyms": [
              "job failure rate",
              "error rate"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.mv_query_performance",
        "description": [
          "Query execution metrics for performance tracking.\n",
          "PURPOSE: Track query latency, SLA breaches, and volume.\n",
          "BEST FOR: P95 duration | SLA breach rate | Cache hit rate | Query volume\n",
          "KEY MEASURES: avg_duration, p95_duration, sla_breach_rate"
        ],
        "column_configs": [
          {
            "column_name": "p95_duration_seconds",
            "synonyms": [
              "p95 latency",
              "query duration"
            ]
          },
          {
            "column_name": "sla_breach_rate",
            "synonyms": [
              "sla breaches",
              "performance issues"
            ]
          }
        ]
      },
      {
        "identifier": "${catalog}.${gold_schema}.mv_security_events",
        "description": [
          "Audit event metrics for security tracking.\n",
          "PURPOSE: Track authentication, authorization, and access events.\n",
          "BEST FOR: Total events | Failed events | High-risk events | Success rate\n",
          "KEY MEASURES: total_events, failed_events, high_risk_events"
        ],
        "column_configs": [
          {
            "column_name": "success_rate",
            "synonyms": [
              "auth success rate",
              "security success"
            ]
          },
          {
            "column_name": "high_risk_events",
            "synonyms": [
              "threats",
              "security incidents"
            ]
          }
        ]
      }
    ]
  },
  "instructions": {
    "text_instructions": [
      {
        "id": "f17a43b2f2d2d3eb0b60e8a35c40c766",
        "content": [
          "You are a comprehensive Databricks platform health analyst. Follow these rules:\n",
          "\n",
          "1. **Asset Selection:** Use Metric View for current state, TVFs for lists, Custom Metrics for trends\n",
          "2. **Route by Domain:** Cost\u2192cost_analytics, Jobs\u2192job_performance, Query\u2192query_performance\n",
          "3. **TVFs for Lists:** Use TVFs for \"which\", \"top N\", \"list\" queries\n",
          "4. **Trends:** For \"is X increasing?\" check _drift_metrics tables\n",
          "5. **Date Default:** Cost=30 days, Jobs/Queries=7 days, Security=24 hours\n",
          "6. **Aggregation:** SUM for totals, AVG for averages, COUNT for volumes\n",
          "7. **Sorting:** DESC by primary metric unless specified\n",
          "8. **Limits:** Top 10-20 for ranking queries\n",
          "9. **Health Score:** 0-25=Critical, 26-50=Poor, 51-75=Fair, 76-90=Good, 91-100=Excellent\n",
          "10. **Anomalies:** For \"anomalies\" \u2192 query *_anomaly_predictions tables\n",
          "11. **Forecasts:** For \"forecast/predict\" \u2192 query *_forecast_predictions tables\n",
          "12. **Custom Metrics:** Always include required filters (column_name=':table', log_type='INPUT')\n",
          "13. **Context:** Explain results in business terms\n",
          "14. **Performance:** Never scan Bronze/Silver tables\n"
        ]
      }
    ],
    "example_question_sqls": [
      {
        "id": "d22393a3a1cac061620c9ffe441b0bb5",
        "question": [
          "What is our total spend this month?"
        ],
        "sql": [
          "SELECT MEASURE(total_cost) as mtd_cost\n",
          "FROM ${catalog}.${gold_schema}.mv_cost_analytics\n",
          "WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE());"
        ],
        "usage_guidance": [
          "Use for current state total cost queries"
        ]
      },
      {
        "id": "447c06638235e6597579d6169547c285",
        "question": [
          "What is our job success rate?"
        ],
        "sql": [
          "SELECT MEASURE(success_rate) as success_pct\n",
          "FROM ${catalog}.${gold_schema}.mv_job_performance\n",
          "WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
        ],
        "usage_guidance": [
          "Use for current job reliability metrics"
        ]
      },
      {
        "id": "ea218d619bdb1bda7135fff13236d7b3",
        "question": [
          "Show me failed jobs today"
        ],
        "sql": [
          "SELECT * FROM TABLE(get_failed_jobs(",
          "  1",
          "))",
          "ORDER BY failure_rate DESC",
          "LIMIT 20;"
        ],
        "usage_guidance": [
          "Use for listing specific failed jobs"
        ]
      }
    ],
    "sql_functions": [
      {
        "id": "22057a9e717bbe2d5740b65e7acdd248",
        "identifier": "${catalog}.${gold_schema}.get_top_cost_contributors"
      },
      {
        "id": "8c848de97c367fe9fea357c9f50e44a6",
        "identifier": "${catalog}.${gold_schema}.get_cost_trend_by_sku"
      },
      {
        "id": "84ea3c8ff8d891e37095f227cc7e7686",
        "identifier": "${catalog}.${gold_schema}.get_cost_by_owner"
      },
      {
        "id": "bf2c841fbb93907c32d6490dd49a1bf3",
        "identifier": "${catalog}.${gold_schema}.get_spend_by_custom_tags"
      },
      {
        "id": "d1df0d9cbd84ea79964038fed20f0028",
        "identifier": "${catalog}.${gold_schema}.get_tag_coverage"
      },
      {
        "id": "4dbdd960e39e8a00e829cc82d7774d17",
        "identifier": "${catalog}.${gold_schema}.get_cost_week_over_week"
      },
      {
        "id": "d5557e154773fcddb62ebb07bdfd3c8d",
        "identifier": "${catalog}.${gold_schema}.get_cost_anomaly_analysis"
      },
      {
        "id": "b77b96a89259c12442d0fe6660580971",
        "identifier": "${catalog}.${gold_schema}.get_cost_forecast_summary"
      },
      {
        "id": "f48a1f01587da63285409c090e84a317",
        "identifier": "${catalog}.${gold_schema}.get_cost_mtd_summary"
      },
      {
        "id": "5b15433eebf22c230351182faeeba926",
        "identifier": "${catalog}.${gold_schema}.get_commit_vs_actual"
      },
      {
        "id": "407495a35582b27542e4993251bec527",
        "identifier": "${catalog}.${gold_schema}.get_cost_growth_analysis"
      },
      {
        "id": "8966d71c179757ba9c09ebee8e528306",
        "identifier": "${catalog}.${gold_schema}.get_cost_growth_by_period"
      },
      {
        "id": "acc96a90ccdc474c01c73485a75a3e48",
        "identifier": "${catalog}.${gold_schema}.get_failed_jobs"
      },
      {
        "id": "c264739297fd86661a8f3ae3862e72d6",
        "identifier": "${catalog}.${gold_schema}.get_job_success_rates"
      },
      {
        "id": "2faddaa144236e0a8f27f1977cc20a9a",
        "identifier": "${catalog}.${gold_schema}.get_job_run_duration_analysis"
      },
      {
        "id": "47f24d56008c85a9115bd47fc3ec24ed",
        "identifier": "${catalog}.${gold_schema}.get_job_sla_compliance"
      },
      {
        "id": "c153d294576a637dec3e22907dab1c97",
        "identifier": "${catalog}.${gold_schema}.get_job_failure_patterns"
      },
      {
        "id": "dc8ec1d1bf65e186022b83bbd2ac6e2e",
        "identifier": "${catalog}.${gold_schema}.get_job_outlier_runs"
      },
      {
        "id": "3550f09c25504fd297c37bb64e83d23b",
        "identifier": "${catalog}.${gold_schema}.get_job_retry_analysis"
      },
      {
        "id": "a88fca9154e4b244701ee28f21eede6c",
        "identifier": "${catalog}.${gold_schema}.get_job_duration_percentiles"
      },
      {
        "id": "4f5cb52969032ed93b878185d0e833d2",
        "identifier": "${catalog}.${gold_schema}.get_job_failure_costs"
      },
      {
        "id": "a28fccf37f956ae81d7e47416e2331b6",
        "identifier": "${catalog}.${gold_schema}.get_repair_cost_analysis"
      },
      {
        "id": "c26f72dde2ce74c2fe92d272a6c92644",
        "identifier": "${catalog}.${gold_schema}.get_slow_queries"
      },
      {
        "id": "e403c7841b63ec5dc512249d3a8a99f6",
        "identifier": "${catalog}.${gold_schema}.get_query_duration_percentiles"
      },
      {
        "id": "67ad230a555e13c3940cb1b4fdd87cdd",
        "identifier": "${catalog}.${gold_schema}.get_warehouse_utilization"
      },
      {
        "id": "29e93061f6bb0f91aa25fe3372c466f3",
        "identifier": "${catalog}.${gold_schema}.get_query_volume_trends"
      },
      {
        "id": "93f3cea2f9ab18124decf429c1c32748",
        "identifier": "${catalog}.${gold_schema}.get_top_query_users"
      },
      {
        "id": "3c02b47940753a10a7e3afd3026bf5a3",
        "identifier": "${catalog}.${gold_schema}.get_user_query_efficiency"
      },
      {
        "id": "24181f66b26f07ccf6c8adb3af53b1cf",
        "identifier": "${catalog}.${gold_schema}.get_failed_queries"
      },
      {
        "id": "dd2473f047132848c10d6542d3980653",
        "identifier": "${catalog}.${gold_schema}.get_query_spill_analysis"
      },
      {
        "id": "7f4908790e1281ef4840c226f7ebdf15",
        "identifier": "${catalog}.${gold_schema}.get_cluster_resource_utilization"
      },
      {
        "id": "60a8c4fad17542078d08b4d5b3fa8f0a",
        "identifier": "${catalog}.${gold_schema}.get_cluster_resource_metrics"
      },
      {
        "id": "d44d299e069d96bd7ad44163e8ade21e",
        "identifier": "${catalog}.${gold_schema}.get_underutilized_clusters"
      },
      {
        "id": "3cfa69ccb10e2d291867092dc16daeeb",
        "identifier": "${catalog}.${gold_schema}.get_jobs_without_autoscaling"
      },
      {
        "id": "e42892c1d9ca236a7188d36643fff4ed",
        "identifier": "${catalog}.${gold_schema}.get_legacy_dbr_jobs"
      },
      {
        "id": "f0ea3423e140fdc0b00776691f106b11",
        "identifier": "${catalog}.${gold_schema}.get_user_activity_summary"
      },
      {
        "id": "7af69878aa9ab34af13c6686203284d8",
        "identifier": "${catalog}.${gold_schema}.get_sensitive_table_access"
      }
    ]
  },
  "benchmarks": {
    "questions": [
      {
        "id": "aa7d218ba5ce8c0faf9e47a329cac184",
        "question": [
          "What is our total spend this month?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(total_cost) as mtd_cost FROM mv_cost_analytics WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE());"
            ]
          }
        ]
      },
      {
        "id": "0a6c542d8e0476b407b4c3f124c3405e",
        "question": [
          "What is our job success rate?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(success_rate) as success_pct FROM mv_job_performance WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "e8c098298f9030a7f0ea7362098a5227",
        "question": [
          "What is the P95 query duration?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(p95_duration_seconds) as p95_sec FROM mv_query_performance WHERE query_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "f0e9a9f44dbdea8ed766d4c0b95f3363",
        "question": [
          "What is the security event success rate?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(successful_events) as auth_success_pct FROM mv_security_events WHERE event_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "5dcb68f7d6d15b0268b23ba48d5d1433",
        "question": [
          "What is our data quality score?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(freshness_rate) as overall_quality FROM mv_data_quality;"
            ]
          }
        ]
      },
      {
        "id": "5479217ccae53b95ef11f038cfa31ace",
        "question": [
          "Show me top cost drivers"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT   sku_name,  MEASURE(total_cost) as cost FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY sku_name ORDER BY cost DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "c7885e2ee783ad77b1482037e1480da8",
        "question": [
          "Show me failed jobs today"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_failed_jobs(\n  1,\n  CURRENT_DATE()::STRING,\n  '%'\n) ORDER BY start_time DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "a9aa5fea4f4b692bb0b2cdfa4d2599c2",
        "question": [
          "Show me slow queries"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_slow_queries(  CURRENT_DATE()::STRING,  CURRENT_DATE()::STRING,  30,  50) ORDER BY duration_seconds DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "0e95da241d4781f55c618b2e9045965f",
        "question": [
          "Show me stale tables"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_table_freshness(7) WHERE is_stale = TRUE ORDER BY hours_since_update DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "1629bdffac37fd012b97513a4997499f",
        "question": [
          "What is our cluster utilization?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(avg_cpu_utilization) as cpu_pct FROM mv_cluster_utilization WHERE utilization_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "0010b2efae72f0f211bcdc144b2a05fe",
        "question": [
          "Show me commit utilization"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT   sku_name,  MEASURE(daily_avg_cost) as usage_pct FROM mv_commit_tracking WHERE usage_month = DATE_TRUNC('month', CURRENT_DATE())GROUP BY sku_name ORDER BY usage_pct DESC;"
            ]
          }
        ]
      },
      {
        "id": "9221de68365dcffa6ced08299727ed89",
        "question": [
          "Show me warehouse utilization"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_warehouse_utilization(\n  7,\n  CURRENT_DATE()::STRING\n) ORDER BY total_queries DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "ac3dd5574e65ed5539480999f83c0c61",
        "question": [
          "What is the DLT pipeline health?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_pipeline_data_lineage(  7) ORDER BY total_events DESC, total_events ASC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "4a04fcb6084891dfdaef98559930f790",
        "question": [
          "Show me underutilized clusters"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_underutilized_clusters(  30) WHERE avg_cpu_pct < 30 ORDER BY potential_savings DESC LIMIT 15;"
            ]
          }
        ]
      },
      {
        "id": "a38b9b6611cb8a91a1cdb69250c58aa2",
        "question": [
          "Show me high-risk events"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT   user_email,  action_category,  MEASURE(failed_events) as risk_count FROM mv_security_events WHERE event_date >= CURRENT_DATE() - INTERVAL 7 DAYS  AND audit_level = 'HIGH'GROUP BY user_email, action_category ORDER BY risk_count DESC LIMIT 15;"
            ]
          }
        ]
      },
      {
        "id": "a8ec2cc04f4e4055b3c6942856468721",
        "question": [
          "Show me tables failing quality checks"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_table_freshness(7) ORDER BY hours_since_update DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "d1a491bb09af1725234ad55ffc07ba96",
        "question": [
          "What is our tag coverage?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(tag_coverage_pct) as coverage_pct FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "20e9892d32598a3befe821d2033ee99f",
        "question": [
          "Show me cluster right-sizing recommendations"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.cluster_capacity_predictions WHERE prediction IN ('DOWNSIZE', 'UPSIZE') ORDER BY prediction DESC, query_count DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "2f5e00f43b399b047a61bc3b17897379",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Platform health overview - combine cost, performance, reliability, security, and quality KPIs"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH cost_health AS (  SELECT     MEASURE(total_cost) as total_spend,    MEASURE(last_7_day_cost) as last_7_day_cost,    MEASURE(last_30_day_cost) as last_30_day_cost,    MEASURE(tag_coverage_pct) as tag_coverage  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS),job_health AS (  SELECT     MEASURE(success_rate) as job_success_rate,    MEASURE(failure_rate) as job_failure_rate,    MEASURE(total_runs) as total_job_runs  FROM mv_job_performance  WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS),query_health AS (  SELECT     MEASURE(p95_duration_seconds) as p95_latency,    MEASURE(sla_breach_rate) as sla_breach_pct,    MEASURE(cache_hit_rate) as cache_pct  FROM mv_query_performance),security_health AS (  SELECT     MEASURE(success_rate) as auth_success_rate,    MEASURE(high_risk_events) as high_risk_count,    MEASURE(unique_users) as active_users  FROM mv_security_events  WHERE event_date >= CURRENT_DATE() - INTERVAL 7 DAYS),quality_health AS (  SELECT     MEASURE(freshness_rate) as data_quality,    MEASURE(freshness_rate) as freshness_pct,    MEASURE(staleness_rate) as staleness_pct  FROM mv_data_quality),cluster_health AS (  SELECT     MEASURE(avg_cpu_utilization) as avg_cpu,    MEASURE(efficiency_score) as efficiency  FROM mv_cluster_utilization  WHERE utilization_date >= CURRENT_DATE() - INTERVAL 7 DAYS)SELECT   ch.total_spend,  ch.last_7_day_cost,  ch.tag_coverage,  jh.job_success_rate,  jh.job_failure_rate,  jh.total_job_runs,  qh.p95_latency,  qh.sla_breach_pct,  qh.cache_pct,  sh.auth_success_rate,  sh.high_risk_count,  sh.active_users,  quh.data_quality,  quh.freshness_pct,  quh.staleness_pct,  clh.avg_cpu,  clh.efficiency,  CASE     WHEN jh.job_failure_rate > 10 OR qh.sla_breach_pct > 5 THEN 'Critical - Reliability Issues'    WHEN sh.high_risk_count > 20 OR sh.auth_success_rate < 95 THEN 'Critical - Security Concerns'    WHEN quh.data_quality < 70 OR quh.staleness_pct > 20 THEN 'Critical - Data Quality Crisis'    WHEN ch.last_7_day_cost * 30 > ch.last_30_day_cost * 1.2 THEN 'Warning - Cost Spike Detected'    WHEN qh.cache_pct > 80 AND jh.job_success_rate > 95 AND quh.data_quality >= 90 THEN 'Excellent Health'    ELSE 'Normal'  END as overall_platform_health,  CASE     WHEN jh.job_failure_rate > 10 THEN 'Investigate job failures immediately'    WHEN qh.sla_breach_pct > 5 THEN 'Optimize slow queries and warehouse sizing'    WHEN sh.high_risk_count > 20 THEN 'Review security events and threats'    WHEN quh.staleness_pct > 20 THEN 'Fix data pipeline freshness issues'    WHEN ch.last_7_day_cost * 30 > ch.last_30_day_cost * 1.2 THEN 'Analyze cost drivers and right-size resources'    WHEN clh.avg_cpu < 40 THEN 'Downsize underutilized clusters'    ELSE 'Continue monitoring'  END as top_priority_action FROM cost_health chCROSS JOIN job_health jhCROSS JOIN query_health qhCROSS JOIN security_health shCROSS JOIN quality_health quhCROSS JOIN cluster_health clh;"
            ]
          }
        ]
      },
      {
        "id": "c6a6feb936d7a4c5d2d1a961bacc373f",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Cost optimization opportunities - combine underutilized clusters, right-sizing, and tagging gaps"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH underutilized AS (  SELECT    cluster_name,    avg_cpu_pct,    potential_savings as savings_from_underutilization  FROM get_underutilized_clusters(30)  WHERE avg_cpu_pct < 30),rightsizing AS (  SELECT    cluster_name,    current_size,    recommended_size,    potential_savings as savings_from_rightsizing  FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.cluster_capacity_predictions  WHERE recommended_action != 'NO_CHANGE'),untagged AS (  SELECT     workspace_name,    SUM(MEASURE(total_cost)) as untagged_cost  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS      AND tag_team IS NULL  GROUP BY workspace_name),autoscaling_gaps AS (  SELECT    job_name,    estimated_savings  FROM get_jobs_without_autoscaling(30)),legacy_dbr AS (  SELECT    COUNT(*) as legacy_job_count  FROM get_jobs_on_legacy_dbr(30))SELECT   COALESCE(SUM(u.savings_from_underutilization), 0) as savings_underutil,  COALESCE(SUM(r.savings_from_rightsizing), 0) as savings_rightsize,  COALESCE(SUM(ut.untagged_cost * 0.1), 0) as estimated_waste_from_untagged,  COALESCE(SUM(ag.estimated_savings), 0) as savings_autoscaling,  ld.legacy_job_count,  COALESCE(SUM(u.savings_from_underutilization), 0) +   COALESCE(SUM(r.savings_from_rightsizing), 0) +   COALESCE(SUM(ag.estimated_savings), 0) as total_monthly_savings_potential,  CASE     WHEN COALESCE(SUM(u.savings_from_underutilization), 0) + COALESCE(SUM(r.savings_from_rightsizing), 0) > 10000 THEN 'Critical - Immediate Right-Sizing Required'    WHEN COALESCE(SUM(ut.untagged_cost), 0) > 5000 THEN 'High - Improve Tagging for Accountability'    WHEN ld.legacy_job_count > 20 THEN 'Medium - Modernize Legacy DBR Jobs'    ELSE 'Low - Continue Monitoring'  END as optimization_priority,  ARRAY(    CASE WHEN COALESCE(SUM(u.savings_from_underutilization), 0) > 5000 THEN 'Downsize or terminate underutilized clusters' END,    CASE WHEN COALESCE(SUM(r.savings_from_rightsizing), 0) > 5000 THEN 'Apply ML right-sizing recommendations' END,    CASE WHEN COALESCE(SUM(ut.untagged_cost), 0) > 5000 THEN 'Implement tagging policy and governance' END,    CASE WHEN COALESCE(SUM(ag.estimated_savings), 0) > 2000 THEN 'Enable autoscaling on fixed-size jobs' END,    CASE WHEN ld.legacy_job_count > 20 THEN 'Migrate to latest DBR versions' END  ) as recommended_actions FROM underutilized uFULL OUTER JOIN rightsizing r ON u.cluster_name = r.cluster_nameFULL OUTER JOIN untagged ut ON 1=1FULL OUTER JOIN autoscaling_gaps ag ON 1=1CROSS JOIN legacy_dbr ld;"
            ]
          }
        ]
      },
      {
        "id": "950ea414e56b27d06122a988c2365fb9",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Executive FinOps dashboard - cost trends, efficiency, commit utilization, and optimization opportunities"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH cost_trends AS (  SELECT     SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS THEN MEASURE(total_cost) ELSE 0 END) as cost_7d,    SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS THEN MEASURE(total_cost) ELSE 0 END) as cost_30d,    SUM(CASE WHEN usage_date >= DATE_TRUNC('month', CURRENT_DATE()) THEN MEASURE(total_cost) ELSE 0 END) as cost_mtd,    AVG(MEASURE(tag_coverage_pct)) as avg_tag_coverage  FROM mv_cost_analytics),cost_by_domain AS (  SELECT     domain,    SUM(MEASURE(total_cost)) as domain_cost  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS  GROUP BY domain  ORDER BY domain_cost DESC  LIMIT 5),commit_status AS (  SELECT     sku_name,    MEASURE(utilization_rate) as usage_pct,    MEASURE(remaining_dbu) as remaining_capacity  FROM mv_commit_tracking  WHERE usage_month = DATE_TRUNC('month', CURRENT_DATE())  GROUP BY sku_name),efficiency AS (  SELECT     AVG(MEASURE(avg_cpu_utilization)) as avg_cpu_util,    AVG(MEASURE(efficiency_score)) as avg_efficiency  FROM mv_cluster_utilization  WHERE utilization_date >= CURRENT_DATE() - INTERVAL 7 DAYS),optimization_potential AS (  SELECT    SUM(potential_savings) as total_savings_potential  FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.cluster_capacity_predictions  WHERE recommended_action != 'NO_CHANGE'),serverless_adoption AS (  SELECT     MEASURE(serverless_percentage) as serverless_pct  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS)SELECT   ct.cost_7d,  ct.cost_30d,  ct.cost_mtd,  ct.cost_7d * 30 as projected_monthly_cost,  ct.avg_tag_coverage,  COALESCE(STRING_AGG(cbd.domain || ': $' || CAST(cbd.domain_cost as STRING), ', '), 'N/A') as top_5_cost_domains,  COALESCE(AVG(cs.usage_pct), 0) as avg_commit_utilization,  COALESCE(SUM(cs.remaining_capacity), 0) as total_remaining_commit,  ef.avg_cpu_util,  ef.avg_efficiency,  COALESCE(op.total_savings_potential, 0) as monthly_optimization_potential,  sa.serverless_pct,  CASE     WHEN ct.cost_7d * 30 > ct.cost_30d * 1.3 THEN 'Critical - Cost Spike Detected'    WHEN COALESCE(AVG(cs.usage_pct), 0) < 70 THEN 'Warning - Under-Utilizing Commitments'    WHEN ef.avg_cpu_util < 40 THEN 'Warning - Resource Inefficiency'    WHEN COALESCE(op.total_savings_potential, 0) > 10000 THEN 'High - Significant Optimization Opportunity'    WHEN sa.serverless_pct < 30 THEN 'Medium - Low Serverless Adoption'    ELSE 'Healthy FinOps Posture'  END as finops_health_status,  CASE     WHEN ct.cost_7d * 30 > ct.cost_30d * 1.3 THEN 'Investigate cost spike drivers and implement controls'    WHEN COALESCE(AVG(cs.usage_pct), 0) < 70 THEN 'Increase workload on committed capacity'    WHEN ef.avg_cpu_util < 40 THEN 'Right-size clusters and consolidate workloads'    WHEN COALESCE(op.total_savings_potential, 0) > 10000 THEN 'Apply ML right-sizing recommendations'    WHEN sa.serverless_pct < 30 THEN 'Migrate eligible workloads to serverless'    WHEN ct.avg_tag_coverage < 80 THEN 'Implement tagging policy for cost allocation'    ELSE 'Continue monitoring and optimizing'  END as top_priority_action FROM cost_trends ctCROSS JOIN cost_by_domain cbdCROSS JOIN commit_status csCROSS JOIN efficiency efCROSS JOIN optimization_potential opCROSS JOIN serverless_adoption sa GROUP BY   ct.cost_7d, ct.cost_30d, ct.cost_mtd, ct.avg_tag_coverage,  ef.avg_cpu_util, ef.avg_efficiency, op.total_savings_potential, sa.serverless_pct;"
            ]
          }
        ]
      }
    ]
  }
}