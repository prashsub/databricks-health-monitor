{
  "version": 1,
  "config": {
    "sample_questions": [
      {
        "id": "359b158cf434496bb5d58f2af67f8b99",
        "question": [
          "What is our total spend this month?"
        ]
      },
      {
        "id": "1e8b0798988c4ac78aec26bd42b230b7",
        "question": [
          "Show me the top 10 workspaces by cost"
        ]
      },
      {
        "id": "6e8daeb868c747af84b6d0f747b67672",
        "question": [
          "What was our daily cost trend for the last 30 days?"
        ]
      },
      {
        "id": "70042595785947a18c0855373323b854",
        "question": [
          "What percentage of our spend is tagged?"
        ]
      },
      {
        "id": "fb16e6ed5752441fa54e701837a2ac6a",
        "question": [
          "Which SKU costs the most?"
        ]
      },
      {
        "id": "b42e56ff231e4261843beccf44399ffd",
        "question": [
          "Show me cost by owner"
        ]
      },
      {
        "id": "b22db94421a4439e83edf10a83b88b9a",
        "question": [
          "What is our serverless vs non-serverless spend?"
        ]
      },
      {
        "id": "357d2076fc3d45f58cfdf325c8e433cc",
        "question": [
          "Break down cost by team tag"
        ]
      },
      {
        "id": "cd3fb96cbb1a41eb9740037bc57aa794",
        "question": [
          "Which ALL_PURPOSE clusters could be migrated to JOBS clusters?"
        ]
      },
      {
        "id": "6954e82fd25748929d908c5a0da74e88",
        "question": [
          "What are our cost anomalies?"
        ]
      },
      {
        "id": "75b7750217f4478db3d301c085995b84",
        "question": [
          "Show me week-over-week cost growth"
        ]
      },
      {
        "id": "9cd1ec86074342b1a8e3f039f6d9aea1",
        "question": [
          "What is the cost forecast for next month?"
        ]
      },
      {
        "id": "0864d52916174c85a8792848faba90fa",
        "question": [
          "Are there any cost anomalies today?"
        ]
      },
      {
        "id": "837d5ee1cd7b478c96fc4bf25169989d",
        "question": [
          "Which resources need tags?"
        ]
      },
      {
        "id": "9594390cbe8045c4b758e185acbb3c27",
        "question": [
          "What's the predicted cost for next week?"
        ]
      }
    ]
  },
  "data_sources": {
    "tables": [
      {
        "identifier": "${catalog}.${gold_schema}.dim_sku"
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_workspace"
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_cluster"
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_node_type"
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_job"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_usage"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_account_prices"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_list_prices"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_node_timeline"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_job_run_timeline"
      },
      {
        "identifier": "${catalog}.${feature_schema}.cost_anomaly_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.budget_forecast_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.job_cost_optimizer_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.chargeback_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.commitment_recommendations"
      },
      {
        "identifier": "${catalog}.${feature_schema}.tag_recommendations"
      },
      {
        "identifier": "${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics"
      },
      {
        "identifier": "${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics"
      }
    ],
    "metric_views": [
      {
        "identifier": "${catalog}.${gold_schema}.mv_cost_analytics"
      },
      {
        "identifier": "${catalog}.${gold_schema}.mv_commit_tracking"
      }
    ]
  },
  "instructions": {
    "text_instructions": [
      {
        "id": "7476024fbc0641f7831cfa77e5dcd005",
        "content": [
          "You are a Databricks FinOps analyst. Follow these rules:",
          "",
          "1. **Asset Selection:** Use Metric View for current state, TVFs for lists/investigation, Custom Metrics for trends",
          "2. **Primary Source:** Use mv_cost_analytics metric view for dashboard KPIs",
          "3. **TVFs for Lists:** Use TVFs for \"top N\", \"which\", \"list\" queries with TABLE() wrapper",
          "4. **Trends:** For \"is X increasing?\" check _drift_metrics tables",
          "5. **Date Default:** If no date specified, default to last 30 days",
          "6. **Aggregation:** Use SUM for totals, AVG for averages",
          "7. **Sorting:** Sort by cost DESC unless specified",
          "8. **Limits:** Top 10-20 for ranking queries",
          "9. **Currency:** Format as USD with 2 decimals ($1,234.56)",
          "10. **Percentages:** Show as % with 1 decimal (45.3%)",
          "11. **Synonyms:** cost=spend=billing, workspace=environment",
          "12. **ML Anomalies:** For \"anomalies\" \u2192 query ${catalog}.${feature_schema}.cost_anomaly_predictions",
          "13. **ML Forecast:** For \"forecast/predict\" \u2192 query ${catalog}.${feature_schema}.budget_forecast_predictions",
          "14. **Tag Questions:** For \"untagged\" \u2192 use get_untagged_resources TVF",
          "15. **Commit:** For budget tracking \u2192 use mv_commit_tracking metric view",
          "16. **Custom Metrics:** Always include required filters (column_name=':table', log_type='INPUT')",
          "17. **ML Tables Schema:** Always use ${catalog}.${feature_schema} (NOT hardcoded!)",
          "18. **Performance:** Never scan Bronze/Silver tables"
        ]
      }
    ],
    "sql_functions": [
      {
        "id": "e3a4efdbc0d546ecb9e568055c0daa07",
        "identifier": "${catalog}.${gold_schema}.get_top_cost_contributors"
      },
      {
        "id": "c248a5a3077645808bf1d52b5f36332c",
        "identifier": "${catalog}.${gold_schema}.get_cost_trend_by_sku"
      },
      {
        "id": "c79b1e4c0561401fb9070ed45fd38246",
        "identifier": "${catalog}.${gold_schema}.get_cost_by_owner"
      },
      {
        "id": "64d838e5fe67420ea113dc1b1090ed49",
        "identifier": "${catalog}.${gold_schema}.get_spend_by_custom_tags"
      },
      {
        "id": "53058d91a239467e8f22640cf0fbedae",
        "identifier": "${catalog}.${gold_schema}.get_tag_coverage"
      },
      {
        "id": "eb9f6d969bb34883938a13305ee6dc6c",
        "identifier": "${catalog}.${gold_schema}.get_cost_week_over_week"
      },
      {
        "id": "96113003617840fe814e28515920b541",
        "identifier": "${catalog}.${gold_schema}.get_cost_anomalies"
      },
      {
        "id": "bce3fa53e90748cfaf06dc265c80aa41",
        "identifier": "${catalog}.${gold_schema}.get_cost_forecast_summary"
      },
      {
        "id": "55d87186facd473085b8c6b62401e388",
        "identifier": "${catalog}.${gold_schema}.get_cost_mtd_summary"
      },
      {
        "id": "5ad5f8ae985e42c48ac68283df2db663",
        "identifier": "${catalog}.${gold_schema}.get_commit_vs_actual"
      },
      {
        "id": "c3291b431a6a4fbeb4924f74230a7d6a",
        "identifier": "${catalog}.${gold_schema}.get_cost_growth_analysis"
      },
      {
        "id": "b08f254b097e40f5b0281b6d0054861a",
        "identifier": "${catalog}.${gold_schema}.get_cost_growth_by_period"
      },
      {
        "id": "998e525a949d4a139f9e977eb5d7c721",
        "identifier": "${catalog}.${gold_schema}.get_all_purpose_cluster_cost"
      },
      {
        "id": "387f0216df574f838646662c7d71acc6",
        "identifier": "${catalog}.${gold_schema}.get_cluster_right_sizing_recommendations"
      },
      {
        "id": "4b83f326a9c74184a32e436b68eaccb1",
        "identifier": "${catalog}.${gold_schema}.get_most_expensive_jobs"
      },
      {
        "id": "e45a57bee30847cca1781cce52d1eda6",
        "identifier": "${catalog}.${gold_schema}.get_job_spend_trend_analysis"
      },
      {
        "id": "a7940891e68148ec8d7b3c8892116f00",
        "identifier": "${catalog}.${gold_schema}.get_untagged_resources"
      }
    ]
  },
  "benchmarks": {
    "questions": [
      {
        "id": "d011553e5b6d48159a9db87546cc0dde",
        "question": [
          "Query get_top_cost_contributors"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_top_cost_contributors(\"2025-12-15\", \"2026-01-14\", 20) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "68aa571b464046d790f1394a6937b15e",
        "question": [
          "Query get_cost_trend_by_sku"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_cost_trend_by_sku(\"2025-12-15\", \"2026-01-14\", \"ALL\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "fca4b55070144952a9cd95770c97b795",
        "question": [
          "Query get_cost_by_owner"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_cost_by_owner(\"2025-12-15\", \"2026-01-14\", 20) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "6b8b29cd8056480bb8b778e494febbc5",
        "question": [
          "Query get_spend_by_custom_tags"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_spend_by_custom_tags(\"2025-12-15\", \"2026-01-14\", \"ALL\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "890dfaaa43cb4980b4187510d2cd60ef",
        "question": [
          "Query get_tag_coverage"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_tag_coverage(\"2025-12-15\", \"2026-01-14\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "834c2a3fb38e48bfaf9a01b1e6d0ae81",
        "question": [
          "Query get_cost_week_over_week"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_cost_week_over_week(4) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "dc0564794653452da46b38afab4bd7fe",
        "question": [
          "Query get_cost_anomalies"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_cost_anomalies(\"2025-12-15\", \"2026-01-14\", 2.0) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "78a3ad855ce44e64a31b43b519007540",
        "question": [
          "Query get_cost_forecast_summary"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_cost_forecast_summary(3) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "45a8b2c946e649e1823626737adb44e5",
        "question": [
          "What is the total cost by workspace?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT workspace_name, MEASURE(total_cost) AS total_cost FROM ${catalog}.${gold_schema}.mv_cost_analytics GROUP BY workspace_name ORDER BY total_cost DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "e8f827fa331a488ebb648c229c533058",
        "question": [
          "What is the monthly cost trend for commit tracking?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT usage_month, MEASURE(total_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.mv_commit_tracking GROUP BY usage_month ORDER BY usage_month LIMIT 12;"
            ]
          }
        ]
      },
      {
        "id": "5b603b08de3f4c618ccf243ec1f6ca87",
        "question": [
          "Show predictions from cost_anomaly_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.cost_anomaly_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "128f1fac0b674e589bff1eb9d3e5e513",
        "question": [
          "Show predictions from budget_forecast_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.budget_forecast_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "175b1ccdc9634fd3975777487bde678a",
        "question": [
          "Show predictions from job_cost_optimizer_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.job_cost_optimizer_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "409dace281b64752b78fbb49171c1276",
        "question": [
          "Show monitoring data from fact_usage_profile_metrics"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "0272bc4f825a47c8ad4437b4c345a225",
        "question": [
          "Show monitoring data from fact_usage_drift_metrics"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "c1b4ab3b2cc54d6480a3e5e8887ad4c6",
        "question": [
          "Show data from fact_usage"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_usage LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "8ffa5503aab54c9085d72b9e06765c2c",
        "question": [
          "Show data from fact_account_prices"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_account_prices LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "361d0f26df9f4bc8b4fb22a5534ab5be",
        "question": [
          "Show data from fact_list_prices"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_list_prices LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "36022841a0784763887aee4284fb6267",
        "question": [
          "Show dim_sku"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.dim_sku LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "4b2df68c61604281ade6f215ef025598",
        "question": [
          "Show dim_workspace"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.dim_workspace LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "1869ffcfec11499aa5ee1ec933720655",
        "question": [
          "What are the main cost drivers and how have they changed over time?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: What are the main cost drivers and how have they changed over time?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "e7d7aafa11bb4bfa81aae6077a59fe75",
        "question": [
          "Which teams are overspending relative to their budget allocation?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: Which teams are overspending relative to their budget allocation?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "9b516dc2b66a4a5298f18df32100a738",
        "question": [
          "What cost optimization opportunities exist in our serverless workloads?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: What cost optimization opportunities exist in our serverless workloads?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "0afa4c0ed3f04f8fa852e73aa97daa4c",
        "question": [
          "How does our commitment utilization compare to forecasted usage?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: How does our commitment utilization compare to forecasted usage?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "d076a2b658464d7bb067c04a7964b61d",
        "question": [
          "What would be the ROI of implementing recommended cost optimizations?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: What would be the ROI of implementing recommended cost optimizations?' AS analysis;"
            ]
          }
        ]
      }
    ]
  }
}