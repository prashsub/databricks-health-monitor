{
  "version": 1,
  "config": {
    "name": "Health Monitor Cost Intelligence Space",
    "description": [
      "Natural language interface for Databricks cost analytics and FinOps. Enables finance teams, platform administrators, and executives to query billing, usage, and cost optimization insights without SQL."
    ],
    "sample_questions": [
      "What is our total spend this month?",
      "Show me the top 10 workspaces by cost",
      "What was our daily cost trend for the last 30 days?",
      "What percentage of our spend is tagged?",
      "Which SKU costs the most?",
      "Show me cost by owner",
      "What is our serverless vs non-serverless spend?",
      "Break down cost by team tag",
      "Which ALL_PURPOSE clusters could be migrated to JOBS clusters?",
      "What are our cost anomalies?",
      "Show me week-over-week cost growth",
      "What is the cost forecast for next month?",
      "Are there any cost anomalies today?",
      "Which resources need tags?",
      "What's the predicted cost for next week?"
    ]
  },
  "data_sources": {
    "metric_views": [
      {
        "id": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6",
        "name": "mv_cost_analytics",
        "full_name": "${catalog}.${gold_schema}.mv_cost_analytics",
        "description": [
          "Comprehensive cost analytics metric view providing aggregated measures for total cost, DBUs, cost trends (7d, 30d), serverless percentage, and tag coverage percentage."
        ]
      },
      {
        "id": "b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7",
        "name": "mv_commit_tracking",
        "full_name": "${catalog}.${gold_schema}.mv_commit_tracking",
        "description": [
          "Contract and commitment monitoring metric view tracking commit amounts, consumed amounts, remaining amounts, and daily burn rate."
        ]
      }
    ]
  },
  "instructions": {
    "text_instructions": [
      "You are a Databricks FinOps analyst. Follow these rules:",
      "",
      "1. **Asset Selection:** Use Metric View for current state, TVFs for lists/investigation, Custom Metrics for trends",
      "2. **Primary Source:** Use mv_cost_analytics metric view for dashboard KPIs",
      "3. **TVFs for Lists:** Use TVFs for \"top N\", \"which\", \"list\" queries with TABLE() wrapper",
      "4. **Trends:** For \"is X increasing?\" check _drift_metrics tables",
      "5. **Date Default:** If no date specified, default to last 30 days",
      "6. **Aggregation:** Use SUM for totals, AVG for averages",
      "7. **Sorting:** Sort by cost DESC unless specified",
      "8. **Limits:** Top 10-20 for ranking queries",
      "9. **Currency:** Format as USD with 2 decimals ($1,234.56)",
      "10. **Percentages:** Show as % with 1 decimal (45.3%)",
      "11. **Synonyms:** cost=spend=billing, workspace=environment",
      "12. **ML Anomalies:** For \"anomalies\" \u2192 query ${catalog}.${feature_schema}.cost_anomaly_predictions",
      "13. **ML Forecast:** For \"forecast/predict\" \u2192 query ${catalog}.${feature_schema}.budget_forecast_predictions",
      "14. **Tag Questions:** For \"untagged\" \u2192 use get_untagged_resources TVF",
      "15. **Commit:** For budget tracking \u2192 use mv_commit_tracking metric view",
      "16. **Custom Metrics:** Always include required filters (column_name=':table', log_type='INPUT')",
      "17. **ML Tables Schema:** Always use ${catalog}.${feature_schema} (NOT hardcoded!)",
      "18. **Performance:** Never scan Bronze/Silver tables"
    ],
    "sql_functions": [
      {
        "id": "c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8",
        "name": "get_top_cost_contributors",
        "signature": "get_top_cost_contributors(start_date STRING, end_date STRING, top_n INT DEFAULT 10)",
        "full_name": "get_top_cost_contributors",
        "description": [
          "Returns the top N cost contributors by workspace and SKU. Use when user asks for \"top N workspaces by cost\" or \"highest cost contributors\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- top_n: Number of top contributors to return (default: 10)",
          "",
          "**Returns:** workspace_name, sku_name, total_cost, total_dbus, pct_of_total",
          "",
          "**Example:** `SELECT * FROM TABLE(get_top_cost_contributors('2024-12-01', '2024-12-31', 10))`"
        ]
      },
      {
        "id": "d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9",
        "name": "get_cost_trend_by_sku",
        "signature": "get_cost_trend_by_sku(start_date STRING, end_date STRING, sku_filter STRING DEFAULT '%')",
        "full_name": "get_cost_trend_by_sku",
        "description": [
          "Returns daily cost trend by SKU with optional filtering. Use when user asks for \"cost trend by SKU\" or \"daily cost breakdown\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- sku_filter: SQL LIKE pattern for SKU filtering (default: '%' for all)",
          "",
          "**Returns:** usage_date, sku_name, daily_cost, cumulative_cost",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_trend_by_sku('2024-12-01', '2024-12-31', '%'))`"
        ]
      },
      {
        "id": "e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
        "name": "get_cost_by_owner",
        "signature": "get_cost_by_owner(start_date STRING, end_date STRING, top_n INT DEFAULT 20)",
        "full_name": "get_cost_by_owner",
        "description": [
          "Returns cost allocation by resource owner. Use when user asks for \"cost by owner\" or \"chargeback report\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- top_n: Number of top owners to return (default: 20)",
          "",
          "**Returns:** owner, workspace_name, total_cost, pct_of_total",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_by_owner('2024-12-01', '2024-12-31', 20))`"
        ]
      },
      {
        "id": "f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1",
        "name": "get_cost_by_tag",
        "signature": "get_cost_by_tag(start_date STRING, end_date STRING, tag_key STRING DEFAULT 'team')",
        "full_name": "get_cost_by_tag",
        "description": [
          "Returns tag-based cost allocation. Use when user asks for \"cost by team\" or \"cost by project\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- tag_key: Tag key to group by (default: 'team')",
          "",
          "**Returns:** tag_value, total_cost, pct_of_total",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_by_tag('2024-12-01', '2024-12-31', 'team'))`"
        ]
      },
      {
        "id": "a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2",
        "name": "get_untagged_resources",
        "signature": "get_untagged_resources(start_date STRING, end_date STRING, resource_type STRING DEFAULT 'ALL')",
        "full_name": "get_untagged_resources",
        "description": [
          "Returns resources without tags. Use when user asks for \"untagged resources\" or \"tag compliance\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- resource_type: Resource type filter ('ALL', 'CLUSTER', 'JOB', 'WAREHOUSE')",
          "",
          "**Returns:** workspace_name, resource_id, total_cost, days_untagged",
          "",
          "**Example:** `SELECT * FROM TABLE(get_untagged_resources('2024-12-01', '2024-12-31', 'ALL'))`"
        ]
      },
      {
        "id": "b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3",
        "name": "get_cost_anomalies",
        "signature": "get_cost_anomalies(start_date STRING, end_date STRING, z_score_threshold DOUBLE DEFAULT 2.0)",
        "full_name": "get_cost_anomalies",
        "description": [
          "Returns cost anomalies detected by z-score analysis. Use when user asks for \"cost anomalies\" or \"unusual spending patterns\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- z_score_threshold: Z-score threshold for anomaly detection (default: 2.0)",
          "",
          "**Returns:** usage_date, workspace_name, actual_cost, expected_cost, z_score, is_anomaly",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_anomalies('2024-12-01', '2024-12-31', 2.0))`"
        ]
      },
      {
        "id": "c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4",
        "name": "get_cost_mtd_summary",
        "signature": "get_cost_mtd_summary()",
        "full_name": "get_cost_mtd_summary",
        "description": [
          "Returns month-to-date cost summary with daily breakdown and cumulative totals. Use when user asks for \"MTD cost\" or \"month to date spending\".",
          "",
          "**Parameters:** None",
          "",
          "**Returns:** usage_date, daily_cost, cumulative_cost, day_of_month",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_mtd_summary())`"
        ]
      },
      {
        "id": "d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5",
        "name": "get_cost_week_over_week",
        "signature": "get_cost_week_over_week(weeks_back INT DEFAULT 4)",
        "full_name": "get_cost_week_over_week",
        "description": [
          "Returns week-over-week cost comparison. Use when user asks for \"weekly cost trend\" or \"week over week comparison\".",
          "",
          "**Parameters:**",
          "- weeks_back: Number of weeks to look back (default: 4)",
          "",
          "**Returns:** week_start, week_end, total_cost, wow_growth_pct",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_week_over_week(4))`"
        ]
      },
      {
        "id": "e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6",
        "name": "get_spend_by_custom_tags",
        "signature": "get_spend_by_custom_tags(start_date STRING, end_date STRING, tag_keys STRING)",
        "full_name": "get_spend_by_custom_tags",
        "description": [
          "Returns cost breakdown by custom tag values. Use when user asks for \"cost by tag\" or \"spending by team/project\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- tag_keys: Comma-separated string of tag keys (e.g., 'team,project')",
          "",
          "**Returns:** tag_key, tag_value, total_cost, pct_of_total",
          "",
          "**Example:** `SELECT * FROM TABLE(get_spend_by_custom_tags('2024-12-01', '2024-12-31', 'team,project'))`"
        ]
      },
      {
        "id": "f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7",
        "name": "get_most_expensive_jobs",
        "signature": "get_most_expensive_jobs(start_date STRING, end_date STRING, top_n INT DEFAULT 20)",
        "full_name": "get_most_expensive_jobs",
        "description": [
          "Returns most expensive jobs by total cost. Use when user asks for \"most expensive jobs\" or \"job costs\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- top_n: Number of top jobs to return (default: 20)",
          "",
          "**Returns:** job_name, workspace_name, total_cost, run_count, avg_cost_per_run",
          "",
          "**Example:** `SELECT * FROM TABLE(get_most_expensive_jobs('2024-12-01', '2024-12-31', 20))`"
        ]
      },
      {
        "id": "a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8",
        "name": "get_warehouse_utilization",
        "signature": "get_warehouse_utilization(start_date STRING, end_date STRING)",
        "full_name": "get_warehouse_utilization",
        "description": [
          "Returns SQL warehouse utilization metrics. Use when user asks for \"warehouse utilization\" or \"SQL warehouse usage\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "",
          "**Returns:** warehouse_name, total_queries, avg_duration_seconds, total_uptime_hours",
          "",
          "**Example:** `SELECT * FROM TABLE(get_warehouse_utilization('2024-12-01', '2024-12-31'))`"
        ]
      },
      {
        "id": "b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9",
        "name": "get_cost_forecast_summary",
        "signature": "get_cost_forecast_summary(forecast_months INT DEFAULT 3)",
        "full_name": "get_cost_forecast_summary",
        "description": [
          "Returns cost forecast predictions. Use when user asks for \"cost forecast\" or \"predict future cost\".",
          "",
          "**Parameters:**",
          "- forecast_months: Number of months to forecast (default: 3)",
          "",
          "**Returns:** forecast_month, predicted_cost, confidence_lower, confidence_upper",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_forecast_summary(3))`"
        ]
      },
      {
        "id": "c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0",
        "name": "get_cost_growth_analysis",
        "signature": "get_cost_growth_analysis(entity_type STRING, days_back INT DEFAULT 30, top_n INT DEFAULT 10)",
        "full_name": "get_cost_growth_analysis",
        "description": [
          "Returns cost growth analysis by entity type. Use when user asks for \"cost growth\" or \"fastest growing costs\".",
          "",
          "**Parameters:**",
          "- entity_type: Entity to analyze ('workspace', 'sku', 'job', 'cluster')",
          "- days_back: Number of days to analyze (default: 30)",
          "- top_n: Number of top results (default: 10)",
          "",
          "**Returns:** entity_name, current_cost, previous_cost, growth_pct, growth_rate",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_growth_analysis('workspace', 30, 10))`"
        ]
      },
      {
        "id": "d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1",
        "name": "get_tag_coverage",
        "signature": "get_tag_coverage(start_date STRING, end_date STRING)",
        "full_name": "get_tag_coverage",
        "description": [
          "Returns tag coverage analysis. Use when user asks for \"tag coverage\" or \"tagging compliance\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "",
          "**Returns:** resource_type, total_resources, tagged_resources, coverage_pct, untagged_cost",
          "",
          "**Example:** `SELECT * FROM TABLE(get_tag_coverage('2024-12-01', '2024-12-31'))`"
        ]
      },
      {
        "id": "e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2",
        "name": "get_commit_vs_actual",
        "signature": "get_commit_vs_actual(commit_year INT, annual_commit_amount DECIMAL, as_of_date DATE)",
        "full_name": "get_commit_vs_actual",
        "description": [
          "Returns commitment vs actual usage tracking. Use when user asks for \"commit utilization\" or \"commitment tracking\".",
          "",
          "**Parameters:**",
          "- commit_year: Year of commitment",
          "- annual_commit_amount: Annual commitment amount (DECIMAL)",
          "- as_of_date: Date for point-in-time analysis (DATE type)",
          "",
          "**Returns:** commit_amount, consumed_amount, remaining_amount, burn_rate_daily, projected_year_end",
          "",
          "**Example:** `SELECT * FROM TABLE(get_commit_vs_actual(2024, 1000000, CURRENT_DATE()))`"
        ]
      },
      {
        "id": "f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c4",
        "name": "get_all_purpose_cluster_cost",
        "signature": "get_all_purpose_cluster_cost(start_date STRING, end_date STRING, top_n INT DEFAULT 20)",
        "full_name": "get_all_purpose_cluster_cost",
        "description": [
          "Returns ALL_PURPOSE cluster costs with migration savings potential. Use when user asks for \"ALL_PURPOSE cluster costs\" or \"migration opportunities\".",
          "",
          "**Parameters:**",
          "- start_date: Start date in 'YYYY-MM-DD' format",
          "- end_date: End date in 'YYYY-MM-DD' format",
          "- top_n: Number of top clusters to return (default: 20)",
          "",
          "**Returns:** cluster_name, workspace_name, total_cost, migration_savings_potential",
          "",
          "**Example:** `SELECT * FROM TABLE(get_all_purpose_cluster_cost('2024-12-01', '2024-12-31', 20))`"
        ]
      },
      {
        "id": "a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d5",
        "name": "get_cost_growth_by_period",
        "signature": "get_cost_growth_by_period(entity_type STRING, top_n INT DEFAULT 10)",
        "full_name": "get_cost_growth_by_period",
        "description": [
          "Returns period-over-period cost growth analysis. Use when user asks for \"period growth\" or \"cost comparison\".",
          "",
          "**Parameters:**",
          "- entity_type: Entity to analyze ('workspace', 'sku', 'job', 'cluster')",
          "- top_n: Number of top results (default: 10)",
          "",
          "**Returns:** entity_name, current_period_cost, previous_period_cost, growth_pct",
          "",
          "**Example:** `SELECT * FROM TABLE(get_cost_growth_by_period('workspace', 10))`"
        ]
      }
    ]
  },
  "benchmarks": {
    "questions": [
      {
        "id": "f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3",
        "question": [
          "What is our total spend this month?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(total_cost) as mtd_cost FROM mv_cost_analytics WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE());"
            ]
          }
        ]
      },
      {
        "id": "a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4",
        "question": [
          "Show me cost by workspace for the last 30 days"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  workspace_name,  MEASURE(total_cost) as total_cost,  MEASURE(total_dbu) as total_dbus FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY workspace_name ORDER BY total_cost DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5",
        "question": [
          "What is our tag coverage percentage?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(tag_coverage_pct) as tag_coverage FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6",
        "question": [
          "What is our serverless adoption rate?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(serverless_ratio) as serverless_pct FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7",
        "question": [
          "Show me daily cost trend for the last 7 days"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  usage_date,  MEASURE(total_cost) as daily_cost FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY usage_date ORDER BY usage_date DESC;"
            ]
          }
        ]
      },
      {
        "id": "e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8",
        "question": [
          "Show me the top 10 cost contributors this month"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_top_cost_contributors(  CAST(DATE_TRUNC('month', CURRENT_DATE()) AS STRING),  CAST(CURRENT_DATE() AS STRING),  10);"
            ]
          }
        ]
      },
      {
        "id": "f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9",
        "question": [
          "What are the cost anomalies in the last 30 days?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_cost_anomalies(  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING),  2.0) ORDER BY z_score DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0",
        "question": [
          "Show me untagged resources"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_untagged_resources(  CAST(CURRENT_DATE() - INTERVAL 7 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING)) ORDER BY total_cost DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1",
        "question": [
          "What is the cost breakdown by owner?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_cost_by_owner(  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING),  15);"
            ]
          }
        ]
      },
      {
        "id": "c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2",
        "question": [
          "Show me serverless vs classic cost comparison"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  is_serverless,  MEASURE(total_cost) as total_cost,  MEASURE(total_dbu) as total_dbus FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY is_serverless ORDER BY total_cost DESC;"
            ]
          }
        ]
      },
      {
        "id": "d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3",
        "question": [
          "What is the daily cost summary?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_cost_mtd_summary() LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4",
        "question": [
          "Show me cost by SKU for last month"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  sku_name,  MEASURE(total_cost) as sku_cost FROM mv_cost_analytics WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE() - INTERVAL 1 MONTH)  AND usage_date < DATE_TRUNC('month', CURRENT_DATE())GROUP BY sku_name ORDER BY sku_cost DESC;"
            ]
          }
        ]
      },
      {
        "id": "f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5",
        "question": [
          "What is our week-over-week cost growth?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(week_over_week_growth_pct) as wow_growth FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d7",
        "question": [
          "Show me cost by team tag"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_cost_by_tag(  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING),  'team') ORDER BY total_cost DESC LIMIT 15;"
            ]
          }
        ]
      },
      {
        "id": "b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e8",
        "question": [
          "What is the job cost breakdown?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_most_expensive_jobs(  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING),  20);"
            ]
          }
        ]
      },
      {
        "id": "c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f9",
        "question": [
          "What is our year-to-date cost?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(ytd_cost) as ytd_total FROM mv_cost_analytics WHERE usage_date >= DATE_TRUNC('year', CURRENT_DATE());"
            ]
          }
        ]
      },
      {
        "id": "d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a0",
        "question": [
          "Show me ALL_PURPOSE cluster costs and migration opportunities"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_all_purpose_cluster_cost(  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING),  20) ORDER BY total_cost DESC LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b1",
        "question": [
          "What is the cost per DBU?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT MEASURE(cost_per_dbu) as avg_cost_per_dbu FROM mv_cost_analytics WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS;"
            ]
          }
        ]
      },
      {
        "id": "f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c2",
        "question": [
          "Show me warehouse cost analysis"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM get_warehouse_utilization(\n  CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),  CAST(CURRENT_DATE() AS STRING)) ORDER BY total_queries DESC LIMIT 15;"
            ]
          }
        ]
      },
      {
        "id": "a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d3",
        "question": [
          "What is our commit tracking status?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  MEASURE(mtd_cost) as month_to_date,  MEASURE(projected_monthly_cost) as projected_month_end,  MEASURE(daily_avg_cost) as daily_burn_rate FROM mv_commit_tracking;"
            ]
          }
        ]
      },
      {
        "id": "c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f5",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Cross-domain cost and reliability correlation - which workspaces have both high cost AND high job failure rates, indicating infrastructure issues"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH cost_ranking AS (  SELECT    workspace_name,    MEASURE(total_cost) as workspace_cost,    RANK() OVER (ORDER BY MEASURE(total_cost) DESC) as cost_rank  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS  GROUP BY workspace_name),reliability_ranking AS (  SELECT    workspace_name,    MEASURE(failure_rate) as failure_rate,    MEASURE(total_runs) as total_runs,    RANK() OVER (ORDER BY MEASURE(failure_rate) DESC) as failure_rank  FROM mv_job_performance  WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS  GROUP BY workspace_name)SELECT  c.workspace_name,  c.workspace_cost,  c.cost_rank,  r.failure_rate,  r.total_runs,  r.failure_rank,  (c.cost_rank + r.failure_rank) / 2.0 as combined_priority_score FROM cost_ranking c JOIN reliability_ranking r ON c.workspace_name = r.workspace_name WHERE c.cost_rank <= 20 OR r.failure_rank <= 20 ORDER BY combined_priority_score ASC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a6",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: SKU-level cost efficiency analysis with utilization patterns - identify overprovisioned compute types with low utilization but high cost"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH sku_costs AS (  SELECT    sku_name,    MEASURE(total_cost) as total_sku_cost,    MEASURE(total_dbu) as total_dbu,    MEASURE(total_cost) / NULLIF(MEASURE(total_dbu), 0) as cost_per_dbu  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS    AND sku_name LIKE '%COMPUTE%'  GROUP BY sku_name),cluster_util AS (  SELECT    MEASURE(avg_cpu_utilization) as avg_cpu,    MEASURE(avg_memory_utilization) as avg_memory  FROM mv_cluster_utilization  WHERE utilization_date >= CURRENT_DATE() - INTERVAL 30 DAYS)SELECT  scCROSS.sku_name,  scCROSS.total_sku_cost,  scCROSS.total_dbu,  scCROSS.cost_per_dbu,  cu.avg_cpu,  cu.avg_memory,  CASE    WHEN cu.avg_cpu < 30 AND scCROSS.total_sku_cost > 5000 THEN 'Severely Underutilized'    WHEN cu.avg_cpu < 50 AND scCROSS.total_sku_cost > 2000 THEN 'Underutilized'    WHEN cu.avg_cpu > 80 THEN 'Well Utilized'    ELSE 'Normal'  END as utilization_status,  CASE    WHEN cu.avg_cpu < 30 THEN scCROSS.total_sku_cost * 0.6    WHEN cu.avg_cpu < 50 THEN scCROSS.total_sku_cost * 0.3    ELSE 0  END as potential_savings FROM sku_costs scCROSS JOIN cluster_util cu WHERE scCROSS.total_sku_cost > 1000 ORDER BY potential_savings DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b7",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Tag compliance and cost attribution gap analysis - which business units have the largest unattributable spend"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH tagged_costs AS (  SELECT    team_tag,    MEASURE(total_cost) as tagged_cost  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS    AND team_tag IS NOT NULL  GROUP BY team_tag),total_costs AS (  SELECT MEASURE(total_cost) as platform_total  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS),untagged AS (  SELECT SUM(total_cost) as total_untagged  FROM get_untagged_resources(    CAST(CURRENT_DATE() - INTERVAL 30 DAYS AS STRING),    CAST(CURRENT_DATE() AS STRING)  )))SELECT  tc.team_tag,  tc.tagged_cost,  tc.tagged_cost / NULLIF(t.platform_total, 0) * 100 as pct_of_total,  u.total_untagged,  u.total_untagged / NULLIF(t.platform_total, 0) * 100 as untagged_pct,  t.platform_total as total_platform_cost FROM tagged_costs tcCROSS JOIN total_costs tCROSS JOIN untagged u ORDER BY tc.tagged_cost DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c8",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: ML-powered cost anomaly predictions with workspace context"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT  w.workspace_name,  ca.usage_date,  ca.prediction as deviation FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.cost_anomaly_predictions ca JOIN dim_workspace w ON ca.workspace_id = w.workspace_id WHERE ca.usage_date = CURRENT_DATE() ORDER BY ca.prediction DESC LIMIT 10;"
            ]
          }
        ]
      },
      {
        "id": "a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d9",
        "question": [
          "\ud83d\udd2c DEEP RESEARCH: Predictive cost optimization roadmap - combine ML forecasts, anomaly detection, and commitment recommendations"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "WITH cost_forecast AS (  SELECT    workspace_id,    predicted_cost as projected_monthly_cost  FROM get_cost_forecast_summary(1)  LIMIT 1),current_costs AS (  SELECT    workspace_id,    MEASURE(total_cost) / 30.0 as projected_daily_cost  FROM mv_cost_analytics  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS  GROUP BY workspace_id),anomalies AS (  SELECT    w.workspace_id,    COUNT(*) as anomaly_count  FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.cost_anomaly_predictions ca  JOIN dim_workspace w ON ca.workspace_id = w.workspace_id  WHERE ca.usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS    AND ca.prediction > 0.5  GROUP BY w.workspace_id),commitments AS (  SELECT    w.workspace_id,    AVG(cr.prediction) as recommended_commit  FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold_ml.commitment_recommendations cr  JOIN dim_workspace w ON cr.workspace_id = w.workspace_id  WHERE cr.usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS  GROUP BY w.workspace_id)SELECT  cc.workspace_id,  cc.projected_daily_cost,  cc.projected_daily_cost * 30 as projected_monthly_cost,  COALESCE(a.anomaly_count, 0) as recent_anomalies,  COALESCE(cm.recommended_commit, 0) as commit_recommendation,  CASE    WHEN a.anomaly_count > 5 THEN 'Investigate Anomalies First'    WHEN cc.projected_daily_cost > 1000 AND cm.recommended_commit > 0 THEN 'Evaluate Commitment'    WHEN cc.projected_daily_cost > 500 THEN 'Monitor Closely'    ELSE 'Normal'  END as action_priority FROM current_costs ccLEFT JOIN anomalies a ON cc.workspace_id = a.workspace_idLEFT JOIN commitments cm ON cc.workspace_id = cm.workspace_id WHERE cc.projected_daily_cost > 100 ORDER BY cc.projected_daily_cost DESC LIMIT 15;"
            ]
          }
        ]
      }
    ]
  }
}