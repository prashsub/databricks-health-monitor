{
  "version": 1,
  "config": {
    "sample_questions": [
      {
        "id": "a1b2c3d4e5f6789012345678901234ab",
        "question": [
          "Who accessed this table?"
        ]
      },
      {
        "id": "b2c3d4e5f6789012345678901234abc1",
        "question": [
          "Show me user activity for john@company.com"
        ]
      },
      {
        "id": "c3d4e5f6789012345678901234abc12d",
        "question": [
          "Which tables are most frequently accessed?"
        ]
      },
      {
        "id": "d4e5f6789012345678901234abc12de3",
        "question": [
          "Who accessed sensitive data this week?"
        ]
      },
      {
        "id": "e5f6789012345678901234abc12de34f",
        "question": [
          "Show me failed access attempts"
        ]
      },
      {
        "id": "f6789012345678901234abc12de34f56",
        "question": [
          "What permission changes happened today?"
        ]
      },
      {
        "id": "789012345678901234abc12de34f5678",
        "question": [
          "Show me off-hours activity"
        ]
      },
      {
        "id": "89012345678901234abc12de34f56789",
        "question": [
          "Which service accounts are most active?"
        ]
      },
      {
        "id": "9012345678901234abc12de34f56789a",
        "question": [
          "Show me unusual access patterns"
        ]
      },
      {
        "id": "012345678901234abc12de34f56789ab",
        "question": [
          "What sensitive actions occurred?"
        ]
      },
      {
        "id": "12345678901234abc12de34f56789abc",
        "question": [
          "Show me security events timeline"
        ]
      },
      {
        "id": "2345678901234abc12de34f56789abcd",
        "question": [
          "Which users have the most failed actions?"
        ]
      },
      {
        "id": "345678901234abc12de34f56789abcde",
        "question": [
          "Are there any security anomalies?"
        ]
      },
      {
        "id": "45678901234abc12de34f56789abcdef",
        "question": [
          "What's the risk score for this user?"
        ]
      },
      {
        "id": "5678901234abc12de34f56789abcdef0",
        "question": [
          "Show me suspicious activity patterns"
        ]
      }
    ]
  },
  "data_sources": {
    "tables": [
      {
        "identifier": "${catalog}.${gold_schema}.dim_user"
      },
      {
        "identifier": "${catalog}.${gold_schema}.dim_workspace"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_audit_logs"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_table_lineage"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_inbound_network"
      },
      {
        "identifier": "${catalog}.${gold_schema}.fact_outbound_network"
      },
      {
        "identifier": "${catalog}.${feature_schema}.security_threat_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.user_behavior_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.privilege_escalation_predictions"
      },
      {
        "identifier": "${catalog}.${feature_schema}.exfiltration_predictions"
      },
      {
        "identifier": "${catalog}.${gold_schema}_monitoring.fact_audit_logs_profile_metrics"
      },
      {
        "identifier": "${catalog}.${gold_schema}_monitoring.fact_audit_logs_drift_metrics"
      }
    ],
    "metric_views": [
      {
        "identifier": "${catalog}.${gold_schema}.mv_security_events"
      },
      {
        "identifier": "${catalog}.${gold_schema}.mv_governance_analytics"
      }
    ]
  },
  "instructions": {
    "text_instructions": [
      {
        "id": "6789abcdef0123456789abcdef012345",
        "content": [
          "You are a Databricks security and compliance analyst. Follow these rules:",
          "",
          "1. **Asset Selection:** Use Metric View for current state, TVFs for lists, Custom Metrics for trends",
          "2. **Primary Source:** Use mv_security_events metric view for dashboard KPIs",
          "3. **TVFs for Lists:** Use TVFs for user-specific or \"who accessed\" queries, always wrap with TABLE()",
          "4. **Trends:** For \"is failure rate increasing?\" check _drift_metrics tables",
          "5. **Date Default:** If no date specified, default to last 7 days",
          "6. **User Types:** HUMAN_USER, SERVICE_PRINCIPAL, SYSTEM",
          "7. **Risk Levels:** LOW (0-25), MEDIUM (26-50), HIGH (51-75), CRITICAL (76-100)",
          "8. **Sorting:** Sort by risk_score DESC for security queries",
          "9. **Limits:** Top 20 for activity lists",
          "10. **Synonyms:** user=identity=principal, access=event=action",
          "11. **Custom Metrics:** Always include required filters (column_name=':table', log_type='INPUT')",
          "12. **Context:** Explain READ vs WRITE vs DDL actions",
          "13. **Compliance:** Never expose PII in responses",
          "14. **Performance:** Never scan Bronze/Silver tables",
          "15. **TVF Calls:** Always use TABLE() wrapper for TVF calls"
        ]
      }
    ],
    "sql_functions": [
      {
        "id": "d183e935b05649d481565b52ca6fdd92",
        "identifier": "${catalog}.${gold_schema}.get_user_activity_summary"
      },
      {
        "id": "37fe8790bb554cd0a9971d623b86dd23",
        "identifier": "${catalog}.${gold_schema}.get_sensitive_table_access"
      },
      {
        "id": "a6c6405c629e499f9312206feb90f606",
        "identifier": "${catalog}.${gold_schema}.get_permission_changes"
      },
      {
        "id": "746b8203b71c425fb5f9beb38dc54c33",
        "identifier": "${catalog}.${gold_schema}.get_security_events_timeline"
      },
      {
        "id": "77f8d42ac0ea4f46a0faa2fe016d6686",
        "identifier": "${catalog}.${gold_schema}.get_off_hours_activity"
      },
      {
        "id": "08d9a7b1123d46a2b69a0444ae221f86",
        "identifier": "${catalog}.${gold_schema}.get_failed_actions"
      },
      {
        "id": "ab369808dd424ae3aa0a18eab69b800c",
        "identifier": "${catalog}.${gold_schema}.get_table_access_audit"
      },
      {
        "id": "b3c0b475ebdc4b10b8806e2fc030481a",
        "identifier": "${catalog}.${gold_schema}.get_ip_address_analysis"
      },
      {
        "id": "56de784f8bf64011861570e53d96fe88",
        "identifier": "${catalog}.${gold_schema}.get_service_account_audit"
      },
      {
        "id": "11a8b10980e64d59b557af256ccb1f42",
        "identifier": "${catalog}.${gold_schema}.get_user_activity_patterns"
      }
    ]
  },
  "benchmarks": {
    "questions": [
      {
        "id": "260dcfb6a92a46efb3a9ab24239c0957",
        "question": [
          "Query get_user_activity_summary"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_user_activity_summary(\"2025-12-15\", \"2026-01-14\", 20) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "554898a3c9fc4ed3ac5bafba12928de7",
        "question": [
          "Query get_sensitive_table_access"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_sensitive_table_access(\"2025-12-15\", \"2026-01-14\", \"%\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "d688f368be0a4851966d9a99d7cf525a",
        "question": [
          "Query get_permission_changes"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_permission_changes(\"2025-12-15\", \"2026-01-14\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "ead0ad71887b4329b82c0e0dd5580391",
        "question": [
          "Query get_security_events_timeline"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_security_events_timeline(\"2025-12-15\", \"2026-01-14\", \"ALL\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "6ac79e2c5171423a8157c5c8673d1c29",
        "question": [
          "Query get_off_hours_activity"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_off_hours_activity(\"2025-12-15\", \"2026-01-14\", 9, 18) LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "e0f49b0156404aa38ea8293d7e173107",
        "question": [
          "Query get_failed_actions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_failed_actions(\"2025-12-15\", \"2026-01-14\", \"ALL\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "3cb7729026c54c5187ce9b999b68d01b",
        "question": [
          "Query get_table_access_audit"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_table_access_audit(\"2025-12-15\", \"2026-01-14\", \"%\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "4a955b9b36f84ce2bd5212799e4a548e",
        "question": [
          "Query get_ip_address_analysis"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.get_ip_address_analysis(\"2025-12-15\", \"2026-01-14\") LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "95597dc790bc48afab885f3385c33678",
        "question": [
          "Show metrics from mv_security_events"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.mv_security_events LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "2f7993e8dcde4be3b75264cda2578351",
        "question": [
          "Show metrics from mv_governance_analytics"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.mv_governance_analytics LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "460fdbe2f3304d54a06bb9805113d3b2",
        "question": [
          "Show predictions from security_threat_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.security_threat_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "7da2737ad1bd48b0bbdcd50cd8be0ba0",
        "question": [
          "Show predictions from user_behavior_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.user_behavior_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "6e8e501638324ea4933afb248394c3f6",
        "question": [
          "Show predictions from privilege_escalation_predictions"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${feature_schema}.privilege_escalation_predictions LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "e5017247b7254c3680a3dc76f904386f",
        "question": [
          "Show monitoring data from fact_audit_logs_profile_metrics"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}_monitoring.fact_audit_logs_profile_metrics LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "7ea4168bf9054bdf9c90fefc3693983c",
        "question": [
          "Show monitoring data from fact_audit_logs_drift_metrics"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}_monitoring.fact_audit_logs_drift_metrics LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "948ba9c4f70a4e1390f5dfe810b3182d",
        "question": [
          "Show data from fact_audit_logs"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_audit_logs LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "34fcd0092bbe45078250e3936a270226",
        "question": [
          "Show data from fact_table_lineage"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_table_lineage LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "c7e4fb121f194838b75ec61821c8a7e1",
        "question": [
          "Show data from fact_inbound_network"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.fact_inbound_network LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "30879eae595f4362ae176a8e839e87d3",
        "question": [
          "Show dim_user"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.dim_user LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "74be8ee2a3fe48a2a4e3e2669dbb246d",
        "question": [
          "Show dim_workspace"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT * FROM ${catalog}.${gold_schema}.dim_workspace LIMIT 20;"
            ]
          }
        ]
      },
      {
        "id": "9fda507dc1f940d0929bdcfc3af9d146",
        "question": [
          "Are there any unusual access patterns that might indicate security risks?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: Are there any unusual access patterns that might indicate security risks?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "70720a24f621460c8f33c3edd0f26fc4",
        "question": [
          "Which users have accessed sensitive data outside business hours?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: Which users have accessed sensitive data outside business hours?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "d1997678a0474fa0bbf54d084db79cdc",
        "question": [
          "What permission changes have occurred in the last 30 days?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: What permission changes have occurred in the last 30 days?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "fee0a587c37f4f2295f79896e87ee353",
        "question": [
          "Are there any service accounts with excessive privileges?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: Are there any service accounts with excessive privileges?' AS analysis;"
            ]
          }
        ]
      },
      {
        "id": "3d1e0ed1c5e645f9bc4c45f11410009f",
        "question": [
          "What is the compliance status of our data access controls?"
        ],
        "answer": [
          {
            "format": "SQL",
            "content": [
              "SELECT 'Deep research: What is the compliance status of our data access controls?' AS analysis;"
            ]
          }
        ]
      }
    ]
  }
}