{
  "displayName": "Databricks Health Monitor",
  "warehouse_id": "${warehouse_id}",
  "pages": [
    {
      "name": "page_global_filters",
      "displayName": "\ud83d\udd27 Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_window",
            "queries": [],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": []
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_workspace",
            "queries": [
              {
                "name": "workspace_query",
                "query": {
                  "datasetName": "gf_ds_workspaces",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "workspace_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Workspace",
                    "fieldName": "workspace_name",
                    "queryName": "workspace_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "all"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_sku_type",
            "queries": [
              {
                "name": "sku_query",
                "query": {
                  "datasetName": "gf_ds_sku_types",
                  "fields": [
                    {
                      "name": "sku_category",
                      "expression": "`sku_category`"
                    },
                    {
                      "name": "sku_category_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "SKU Type",
                    "fieldName": "sku_category",
                    "queryName": "sku_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "all"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "SKU Type"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_date_group",
            "queries": [
              {
                "name": "date_group_query",
                "query": {
                  "datasetName": "gf_ds_date_groupings",
                  "fields": [
                    {
                      "name": "time_key",
                      "expression": "`time_key`"
                    },
                    {
                      "name": "time_key_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Group By",
                    "fieldName": "time_key",
                    "queryName": "date_group_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "Day"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Dates By"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_compute_type",
            "queries": [
              {
                "name": "compute_query",
                "query": {
                  "datasetName": "gf_ds_compute_types",
                  "fields": [
                    {
                      "name": "compute_type",
                      "expression": "`compute_type`"
                    },
                    {
                      "name": "compute_type_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Compute Type",
                    "fieldName": "compute_type",
                    "queryName": "compute_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "All"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Compute Type"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_job_status",
            "queries": [
              {
                "name": "status_query",
                "query": {
                  "datasetName": "gf_ds_job_status",
                  "fields": [
                    {
                      "name": "status",
                      "expression": "`status`"
                    },
                    {
                      "name": "status_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Job Status",
                    "fieldName": "status",
                    "queryName": "status_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "All"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Job Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_exec",
      "displayName": "\ud83d\udcca Executive Summary",
      "layout": [
        {
          "widget": {
            "name": "exec_kpi_total_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_cost",
                  "fields": [
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_cost"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Total Cost (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_kpi_job_success",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_jobs",
                  "fields": [
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u2705 Job Success Rate"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_kpi_query_perf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_query",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a1 Avg Query (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_kpi_active_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_users",
                  "fields": [
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "active_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc65 Active Users (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_kpi_security_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_security",
                  "fields": [
                    {
                      "name": "high_risk",
                      "expression": "`high_risk`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 High Risk Events"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_kpi_cluster_util",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_kpi_cluster",
                  "fields": [
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udda5\ufe0f Avg CPU Util %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "exec_chart_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_cost_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "daily_cost",
                  "displayName": "Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Daily Cost Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "exec_chart_job_success_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "exec_ds_job_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "success_rate",
                  "displayName": "Success Rate %",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u2705 Job Success Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 4,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_cost",
      "displayName": "\ud83d\udcb0 Cost Management",
      "layout": [
        {
          "widget": {
            "name": "cost_kpi_mtd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_kpi_mtd",
                  "fields": [
                    {
                      "name": "mtd_cost",
                      "expression": "`mtd_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mtd_cost"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTD Spend",
                "description": "Month-to-Date Total"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_kpi_30d_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_kpi_30d",
                  "fields": [
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_cost"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_kpi_30d_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_30_60_compare",
                  "fields": [
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "growth_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30d vs 60d Growth %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_kpi_tag_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_tag_coverage",
                  "fields": [
                    {
                      "name": "coverage_pct",
                      "expression": "`coverage_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "coverage_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tag Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_kpi_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_unique_counts",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users (30d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_chart_wow_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_wow_growth",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_cost",
                      "expression": "`weekly_cost`"
                    },
                    {
                      "name": "wow_growth_pct",
                      "expression": "`wow_growth_pct`"
                    },
                    {
                      "name": "moving_avg",
                      "expression": "`moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "displayName": "Week",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "weekly_cost",
                      "displayName": "Weekly Cost ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "y2": {
                  "fields": [
                    {
                      "fieldName": "wow_growth_pct",
                      "displayName": "WoW Growth %"
                    },
                    {
                      "fieldName": "moving_avg",
                      "displayName": "3M Avg %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Week-over-Week Cost & Growth Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_chart_daily_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_daily_cost",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "serverless_cost",
                      "expression": "`serverless_cost`"
                    },
                    {
                      "name": "classic_cost",
                      "expression": "`classic_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "serverless_cost",
                      "displayName": "Serverless ($)"
                    },
                    {
                      "fieldName": "classic_cost",
                      "displayName": "Classic ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Cost: Serverless vs Classic"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_table_top_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_top_workspaces",
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_count",
                    "title": "Jobs",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_runs",
                    "title": "Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfe2 Top Workspaces (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_chart_sku_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cost_ds_sku_breakdown",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "theta": {
                  "fieldName": "total_cost",
                  "displayName": "Cost ($)"
                },
                "color": {
                  "fieldName": "sku_name",
                  "displayName": "SKU"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce6 Spend by SKU"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 16,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_commit",
      "displayName": "\ud83d\udcb0 Commit Tracking",
      "layout": [
        {
          "widget": {
            "name": "commit_param_annual_commit",
            "queries": [
              {
                "name": "param_query",
                "query": {
                  "datasetName": "commit_ds_commit_options",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Annual Commit ($)",
                    "fieldName": "commit_amount",
                    "queryName": "options_query"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "DECIMAL",
                    "values": [
                      {
                        "value": "1000000"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Annual Commit ($)",
                "description": "Enter your annual commit amount"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_kpi_ytd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_ytd_spend",
                  "fields": [
                    {
                      "name": "ytd_spend",
                      "expression": "`ytd_spend`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "ytd_spend",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "YTD Consumption",
                "description": "Year-to-date actual spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_kpi_commit_utilization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_commit_status",
                  "fields": [
                    {
                      "name": "utilization_pct",
                      "expression": "`utilization_pct`"
                    }
                  ],
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "utilization_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Commit Utilization",
                "description": "% of annual commit consumed"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_kpi_forecasted_annual",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_forecast_summary",
                  "fields": [
                    {
                      "name": "forecasted_annual",
                      "expression": "`forecasted_annual`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "forecasted_annual",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Forecasted Annual",
                "description": "Projected year-end spend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_kpi_projected_variance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_variance",
                  "fields": [
                    {
                      "name": "projected_variance",
                      "expression": "`projected_variance`"
                    }
                  ],
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "projected_variance",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Projected Variance",
                "description": "Overspend (+) / Underspend (-)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_kpi_run_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_run_rate",
                  "fields": [
                    {
                      "name": "daily_run_rate",
                      "expression": "`daily_run_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "daily_run_rate",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Run Rate",
                "description": "Current daily spend rate"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "commit_chart_usage_vs_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_usage_forecast",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "forecast_type",
                      "expression": "`forecast_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "daily_cost",
                  "displayName": "Usage ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                },
                "color": {
                  "fieldName": "forecast_type",
                  "displayName": "Type",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Usage Over Time",
                "description": "Actuals vs AI Forecast"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "commit_chart_cumulative_vs_commit",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_cumulative_vs_commit",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "cumulative_spend",
                      "expression": "`cumulative_spend`"
                    },
                    {
                      "name": "target_line",
                      "expression": "`target_line`"
                    }
                  ],
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "cumulative_spend",
                  "displayName": "Cumulative ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Cumulative Spend vs Commit Target",
                "description": "Are you on track to hit your commit?"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "commit_chart_monthly_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_monthly_breakdown",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    }
                  ],
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "month_name",
                  "displayName": "Month",
                  "scale": {
                    "type": "ordinal"
                  }
                },
                "y": {
                  "fieldName": "monthly_cost",
                  "displayName": "Spend ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend vs Target",
                "description": "Bars show actual spend"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "commit_table_monthly_detail",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_monthly_detail",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    },
                    {
                      "name": "variance",
                      "expression": "`variance`"
                    },
                    {
                      "name": "variance_pct",
                      "expression": "`variance_pct`"
                    }
                  ],
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend Detail"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "month_name",
                    "title": "Month",
                    "type": "string"
                  },
                  {
                    "fieldName": "monthly_cost",
                    "title": "Actual ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "monthly_target",
                    "title": "Target ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance",
                    "title": "Variance ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance_pct",
                    "title": "Variance %",
                    "type": "string"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "commit_chart_monitor_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "commit_ds_monitor_cost_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "cost_per_dbu",
                      "expression": "`cost_per_dbu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "total_cost",
                  "displayName": "Total Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Lakehouse Monitor: Daily Cost Trend",
                "description": "Custom metric from fact_usage monitor"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_reliability",
      "displayName": "\ud83d\udd04 Job Reliability",
      "layout": [
        {
          "widget": {
            "name": "rel_kpi_success_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_success_rate",
                  "fields": [
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Success Rate (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_kpi_total_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_runs"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Runs (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_kpi_failures",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_failures",
                      "expression": "`total_failures`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_failures"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failures (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_duration",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (min)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_kpi_mttr",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_mttr",
                  "fields": [
                    {
                      "name": "mttr_minutes",
                      "expression": "`mttr_minutes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mttr_minutes"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTTR (min)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_kpi_unique_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_kpi_totals",
                  "fields": [
                    {
                      "name": "unique_jobs",
                      "expression": "`unique_jobs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_jobs"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Jobs (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "rel_chart_success_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_success_trend",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "success_rate",
                      "displayName": "Success %"
                    },
                    {
                      "fieldName": "failure_rate",
                      "displayName": "Failure %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Success & Failure Rate Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "rel_chart_runs_by_status",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_runs_by_status",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "successful",
                      "expression": "`successful`"
                    },
                    {
                      "name": "failed",
                      "expression": "`failed`"
                    },
                    {
                      "name": "timed_out",
                      "expression": "`timed_out`"
                    },
                    {
                      "name": "cancelled",
                      "expression": "`cancelled`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "successful",
                      "displayName": "Success"
                    },
                    {
                      "fieldName": "failed",
                      "displayName": "Failed"
                    },
                    {
                      "fieldName": "timed_out",
                      "displayName": "Timeout"
                    },
                    {
                      "fieldName": "cancelled",
                      "displayName": "Cancelled"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Runs by Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "rel_chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "rel_ds_duration_trend",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p50_duration",
                      "expression": "`p50_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg"
                    },
                    {
                      "fieldName": "p50_duration",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f1\ufe0f Duration Percentiles Trend (min)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_optimization",
      "displayName": "\ud83d\udd04 Job Optimization",
      "layout": [
        {
          "widget": {
            "name": "opt_kpi_jobs_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_no_autoscale_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Without Autoscaling",
                "description": "Jobs with fixed worker counts"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "opt_kpi_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_stale_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Stale Dataset Jobs",
                "description": "Jobs producing unused outputs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "opt_kpi_ap_cluster_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_ap_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on All-Purpose",
                "description": "Jobs running on interactive clusters"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "opt_table_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_no_autoscale",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cost_30d",
                      "expression": "`cost_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cost_30d",
                    "title": "Cost (30d)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Without Autoscaling"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "opt_table_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_stale_datasets",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "unused_tables",
                      "expression": "`unused_tables`"
                    },
                    {
                      "name": "runs_30d",
                      "expression": "`runs_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "unused_tables",
                    "title": "Unused Tables",
                    "type": "number"
                  },
                  {
                    "fieldName": "runs_30d",
                    "title": "Runs (30d)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Producing Stale Datasets"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "opt_table_ap_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_ap_jobs",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "task_runs",
                    "title": "Task Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Using All-Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "opt_table_outlier_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "opt_ds_outliers",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "p90_cost",
                      "expression": "`p90_cost`"
                    },
                    {
                      "name": "max_cost",
                      "expression": "`max_cost`"
                    },
                    {
                      "name": "deviation",
                      "expression": "`deviation`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_cost",
                    "title": "Avg Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p90_cost",
                    "title": "P90 Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_cost",
                    "title": "Max Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation",
                    "title": "Deviation ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs with Cost Outliers"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 8,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_query",
      "displayName": "\u26a1 Query Performance",
      "layout": [
        {
          "widget": {
            "name": "query_kpi_total_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_queries",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_kpi_avg_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_queries",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Duration (sec)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_queries",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_kpi_slow_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_slow",
                  "fields": [
                    {
                      "name": "slow_queries_pct",
                      "expression": "`slow_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_queries_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Slow Queries %",
                "description": ">30 seconds"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_kpi_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_failed",
                  "fields": [
                    {
                      "name": "failed_queries_pct",
                      "expression": "`failed_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "failed_queries_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failed Queries %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_kpi_queries",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "query_chart_query_volume",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_query_volume",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "query_count",
                      "displayName": "Queries"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Volume Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "query_chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "query_ds_duration_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg Duration (s)"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95 Duration (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f1\ufe0f Query Duration Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_cluster",
      "displayName": "\u26a1 Cluster Utilization",
      "layout": [
        {
          "widget": {
            "name": "cluster_kpi_avg_cpu",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg CPU Utilization %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_kpi_avg_memory",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_memory"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Memory Utilization %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_kpi_total_nodes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "total_nodes",
                      "expression": "`total_nodes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_nodes"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Nodes (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_kpi_underutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_underutilized",
                  "fields": [
                    {
                      "name": "underutilized_pct",
                      "expression": "`underutilized_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "underutilized_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Underutilized Clusters %",
                "description": "<30% avg CPU"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_kpi_overutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_overutilized",
                  "fields": [
                    {
                      "name": "overutilized_pct",
                      "expression": "`overutilized_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "overutilized_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Overutilized Clusters %",
                "description": ">80% avg CPU"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_kpi_total_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "total_clusters",
                      "expression": "`total_clusters`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_clusters"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Clusters (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cluster_chart_cpu_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_cpu_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "peak_cpu",
                      "expression": "`peak_cpu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_cpu",
                      "displayName": "Avg CPU %"
                    },
                    {
                      "fieldName": "peak_cpu",
                      "displayName": "Peak CPU %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 CPU Utilization Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cluster_chart_memory_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_memory_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "peak_memory",
                      "expression": "`peak_memory`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_memory",
                      "displayName": "Avg Memory %"
                    },
                    {
                      "fieldName": "peak_memory",
                      "displayName": "Peak Memory %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Memory Utilization Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cluster_chart_disk_io",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cluster_ds_disk_io_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_disk_wait",
                      "expression": "`avg_disk_wait`"
                    },
                    {
                      "name": "peak_disk_wait",
                      "expression": "`peak_disk_wait`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_disk_wait",
                      "displayName": "Avg I/O Wait %"
                    },
                    {
                      "fieldName": "peak_disk_wait",
                      "displayName": "Peak I/O Wait %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcbe Disk I/O Wait Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_dbr",
      "displayName": "\u26a1 DBR Migration",
      "layout": [
        {
          "widget": {
            "name": "dbr_kpi_legacy_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_legacy_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on Legacy DBR",
                "description": "Jobs running DBR < 15"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "dbr_kpi_serverless_pct",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption",
                "description": "% of jobs using serverless"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "dbr_kpi_current_dbr_pct",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_current_dbr",
                  "fields": [
                    {
                      "name": "current_pct",
                      "expression": "`current_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "current_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Current DBR Usage",
                "description": "% on DBR 15+"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "dbr_chart_dbr_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_dbr_dist",
                  "fields": [
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "version_status",
                      "expression": "`version_status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "dbr_version",
                  "displayName": "DBR Version",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "job_count",
                  "displayName": "Job Count",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "version_status",
                  "displayName": "Status",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "DBR Version Distribution",
                "description": "Job distribution across DBR versions"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "dbr_chart_compute_type",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_compute_type",
                  "fields": [
                    {
                      "name": "compute_type",
                      "expression": "`compute_type`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "compute_type",
                  "displayName": "Compute Type",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "theta": {
                  "fieldName": "job_count",
                  "displayName": "Jobs",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless vs Classic",
                "description": "Job distribution by compute type"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "dbr_table_legacy_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dbr_ds_legacy_jobs",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "last_run",
                      "expression": "`last_run`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "dbr_version",
                    "title": "DBR Version",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_run",
                    "title": "Last Run",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on Legacy Runtime"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_security",
      "displayName": "\ud83d\udd12 Security Audit",
      "layout": [
        {
          "widget": {
            "name": "sec_kpi_total_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_events",
                  "fields": [
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_events"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Audit Events (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_events",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_kpi_high_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_high_risk",
                  "fields": [
                    {
                      "name": "high_risk_events",
                      "expression": "`high_risk_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk_events"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 High Risk Events (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_kpi_denied_access",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_denied",
                  "fields": [
                    {
                      "name": "denied_access",
                      "expression": "`denied_access`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "denied_access"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26d4 Access Denied (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_kpi_permission_changes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_permissions",
                  "fields": [
                    {
                      "name": "permission_changes",
                      "expression": "`permission_changes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "permission_changes"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd10 Permission Changes (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_kpi_admin_actions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_kpi_admin",
                  "fields": [
                    {
                      "name": "admin_actions",
                      "expression": "`admin_actions`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "admin_actions"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc51 Admin Actions (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "sec_chart_event_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_event_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "event_count",
                      "expression": "`event_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "event_count",
                      "displayName": "Events"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Audit Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "sec_chart_risk_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "sec_ds_risk_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "high_risk",
                      "expression": "`high_risk`"
                    },
                    {
                      "name": "medium_risk",
                      "expression": "`medium_risk`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "high_risk",
                      "displayName": "High Risk"
                    },
                    {
                      "fieldName": "medium_risk",
                      "displayName": "Medium Risk"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Risk Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_governance",
      "displayName": "\ud83d\udd12 Governance Hub",
      "layout": [
        {
          "widget": {
            "name": "gov_kpi_total_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_tables",
                  "fields": [
                    {
                      "name": "total_tables",
                      "expression": "`total_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_tables"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_kpi_tagged_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_tagged",
                  "fields": [
                    {
                      "name": "tagged_pct",
                      "expression": "`tagged_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "tagged_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tagged Tables %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_kpi_documented_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_documented",
                  "fields": [
                    {
                      "name": "documented_pct",
                      "expression": "`documented_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "documented_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Documented Tables %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_kpi_lineage_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_lineage",
                  "fields": [
                    {
                      "name": "lineage_pct",
                      "expression": "`lineage_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "lineage_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Lineage Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_kpi_total_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_jobs",
                  "fields": [
                    {
                      "name": "total_jobs",
                      "expression": "`total_jobs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_jobs"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Jobs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_kpi_total_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_kpi_workspaces",
                  "fields": [
                    {
                      "name": "total_workspaces",
                      "expression": "`total_workspaces`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_workspaces"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Workspaces"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "gov_chart_tables_by_catalog",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_tables_by_catalog",
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "catalog_name",
                  "displayName": "Catalog"
                },
                "theta": {
                  "fieldName": "table_count",
                  "displayName": "Tables"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Tables by Catalog"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "gov_chart_lineage_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "gov_ds_lineage_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "lineage_events",
                      "expression": "`lineage_events`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "lineage_events",
                  "displayName": "Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Lineage Events Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 4,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_quality",
      "displayName": "\u2705 Table Health",
      "layout": [
        {
          "widget": {
            "name": "qual_kpi_total_size",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_summary",
                  "fields": [
                    {
                      "name": "total_size_gb",
                      "expression": "`total_size_gb`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_size_gb"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Storage (GB)",
                "description": "Total table storage size"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "qual_kpi_table_count",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_summary",
                  "fields": [
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "table_count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Tables",
                "description": "Managed table count"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "qual_kpi_needs_optimization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_optimization_needed",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Need Optimization",
                "description": "Tables needing compaction"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "qual_chart_size_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_size_buckets",
                  "fields": [
                    {
                      "name": "size_bucket",
                      "expression": "`size_bucket`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "size_bucket",
                  "displayName": "Size Range",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Table Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Table Size Distribution",
                "description": "Number of tables by size range"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "qual_chart_file_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_file_buckets",
                  "fields": [
                    {
                      "name": "file_bucket",
                      "expression": "`file_bucket`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "file_bucket",
                  "displayName": "File Count Range",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "theta": {
                  "fieldName": "table_count",
                  "displayName": "Tables",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "File Count Distribution",
                "description": "Tables by number of files"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "qual_table_largest",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_largest_tables",
                  "fields": [
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "size_gb",
                      "expression": "`size_gb`"
                    },
                    {
                      "name": "num_files",
                      "expression": "`num_files`"
                    },
                    {
                      "name": "avg_file_mb",
                      "expression": "`avg_file_mb`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Largest Tables",
                "description": "Top tables by storage size"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "table_name",
                    "title": "Table"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema"
                  },
                  {
                    "fieldName": "size_gb",
                    "title": "Size (GB)"
                  },
                  {
                    "fieldName": "num_files",
                    "title": "Files"
                  },
                  {
                    "fieldName": "avg_file_mb",
                    "title": "Avg File (MB)"
                  }
                ]
              },
              "itemsPerPage": 15
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "qual_table_needs_compaction",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_needs_compaction",
                  "fields": [
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "size_gb",
                      "expression": "`size_gb`"
                    },
                    {
                      "name": "num_files",
                      "expression": "`num_files`"
                    },
                    {
                      "name": "optimization_status",
                      "expression": "`optimization_status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Tables Needing Optimization",
                "description": "Tables with many small files needing compaction"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "table_name",
                    "title": "Table"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema"
                  },
                  {
                    "fieldName": "size_gb",
                    "title": "Size (GB)"
                  },
                  {
                    "fieldName": "num_files",
                    "title": "Files"
                  },
                  {
                    "fieldName": "optimization_status",
                    "title": "Status"
                  }
                ]
              },
              "itemsPerPage": 15
            }
          },
          "position": {
            "x": 3,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "qual_table_empty",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "qual_ds_empty_tables",
                  "fields": [
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "created_at",
                      "expression": "`created_at`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Empty Tables",
                "description": "Tables with zero rows"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "table_name",
                    "title": "Table"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema"
                  },
                  {
                    "fieldName": "created_at",
                    "title": "Created",
                    "type": "datetime",
                    "dateTimeFormat": "yyyy-MM-dd"
                  }
                ]
              },
              "itemsPerPage": 15
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        }
      ]
    }
  ],
  "datasets": [
    {
      "name": "exec_ds_kpi_cost",
      "displayName": "KPI: Cost",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "exec_ds_kpi_jobs",
      "displayName": "KPI: Jobs",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS success_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS AND termination_code IS NOT NULL"
    },
    {
      "name": "exec_ds_kpi_query",
      "displayName": "KPI: Query",
      "query": "SELECT ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration FROM ${catalog}.${gold_schema}.fact_query_history WHERE execution_start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "exec_ds_kpi_users",
      "displayName": "KPI: Users",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT user_identity), 0) AS active_users FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "exec_ds_kpi_security",
      "displayName": "KPI: Security",
      "query": "SELECT FORMAT_NUMBER(SUM(CASE WHEN action_name LIKE '%delete%' OR action_name LIKE '%drop%' THEN 1 ELSE 0 END), 0) AS high_risk FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "exec_ds_kpi_cluster",
      "displayName": "KPI: Cluster",
      "query": "SELECT CONCAT(ROUND(AVG(cpu_user_percent + cpu_system_percent), 1), '%') AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "exec_ds_cost_trend",
      "displayName": "Cost Trend",
      "query": "SELECT DATE(usage_date) AS day, ROUND(SUM(list_cost), 2) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "exec_ds_job_trend",
      "displayName": "Job Trend",
      "query": "SELECT DATE(run_date) AS day, ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND termination_code IS NOT NULL GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "cost_ds_kpi_mtd",
      "displayName": "KPI: MTD Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS mtd_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())"
    },
    {
      "name": "cost_ds_kpi_30d",
      "displayName": "KPI: 30d Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "cost_ds_30_60_compare",
      "displayName": "30 vs 60 Day Compare",
      "query": "WITH periods AS (SELECT SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS THEN list_cost ELSE 0 END) AS last_30, SUM(CASE WHEN usage_date BETWEEN CURRENT_DATE() - INTERVAL 60 DAYS AND CURRENT_DATE() - INTERVAL 31 DAYS THEN list_cost ELSE 0 END) AS prev_30 FROM ${catalog}.${gold_schema}.fact_usage) SELECT CONCAT(ROUND((last_30 - prev_30) * 100.0 / NULLIF(prev_30, 0), 1), '%') AS growth_pct FROM periods"
    },
    {
      "name": "cost_ds_tag_coverage",
      "displayName": "Tag Coverage",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS coverage_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "cost_ds_serverless_adoption",
      "displayName": "Serverless Adoption",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS serverless_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "cost_ds_unique_counts",
      "displayName": "Unique Counts",
      "query": "SELECT COUNT(DISTINCT identity_metadata_run_as) AS unique_users, COUNT(DISTINCT usage_metadata_job_id) AS unique_jobs FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "cost_ds_wow_growth",
      "displayName": "WoW Growth",
      "query": "WITH weekly AS (SELECT DATE_TRUNC('week', usage_date) AS week_start, SUM(list_cost) AS weekly_cost, COUNT(DISTINCT DATE(usage_date)) AS days FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 120 DAYS GROUP BY 1 HAVING days = 7), with_growth AS (SELECT week_start, weekly_cost, 100 * (weekly_cost - LAG(weekly_cost) OVER (ORDER BY week_start)) / NULLIF(LAG(weekly_cost) OVER (ORDER BY week_start), 0) AS wow_growth_pct FROM weekly) SELECT week_start, ROUND(weekly_cost, 2) AS weekly_cost, ROUND(wow_growth_pct, 1) AS wow_growth_pct, ROUND(AVG(wow_growth_pct) OVER (ORDER BY week_start ROWS BETWEEN 12 PRECEDING AND CURRENT ROW), 1) AS moving_avg FROM with_growth ORDER BY week_start"
    },
    {
      "name": "cost_ds_daily_cost",
      "displayName": "Daily Cost",
      "query": "SELECT DATE(usage_date) AS usage_date, SUM(list_cost) AS daily_cost, SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) AS serverless_cost, SUM(CASE WHEN NOT product_features_is_serverless THEN list_cost ELSE 0 END) AS classic_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "cost_ds_top_workspaces",
      "displayName": "Top Workspaces",
      "query": "SELECT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, ROUND(SUM(f.list_cost), 2) AS total_cost, COUNT(DISTINCT f.identity_metadata_run_as) AS unique_users, COUNT(DISTINCT f.usage_metadata_job_id) AS job_count, COUNT(DISTINCT f.usage_metadata_job_run_id) AS job_runs FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY total_cost DESC LIMIT 15"
    },
    {
      "name": "cost_ds_sku_breakdown",
      "displayName": "SKU Breakdown",
      "query": "SELECT sku_name, ROUND(SUM(list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY sku_name ORDER BY total_cost DESC LIMIT 10"
    },
    {
      "name": "commit_ds_ytd_spend",
      "displayName": "YTD Spend",
      "query": "SELECT SUM(list_cost) AS ytd_spend FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE())"
    },
    {
      "name": "commit_ds_forecast_summary",
      "displayName": "Forecast Summary",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 90 DAYS GROUP BY usage_date), forecast AS (SELECT AVG(daily_cost) * 365 AS forecasted_annual FROM daily) SELECT forecasted_annual FROM forecast"
    },
    {
      "name": "commit_ds_variance",
      "displayName": "Projected Variance",
      "query": "WITH forecast AS (SELECT AVG(daily_cost) * 365 AS forecasted_annual FROM (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 90 DAYS GROUP BY usage_date)) SELECT forecast.forecasted_annual - :annual_commit AS projected_variance FROM forecast",
      "parameters": [
        {
          "displayName": "Annual Commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "commit_ds_run_rate",
      "displayName": "Run Rate",
      "query": "SELECT AVG(daily_cost) AS daily_run_rate FROM (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY usage_date)"
    },
    {
      "name": "commit_ds_usage_forecast",
      "displayName": "Usage vs Forecast",
      "query": "WITH actuals AS (SELECT usage_date, SUM(list_cost) AS daily_cost, 'Actuals' AS forecast_type FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 90 DAYS GROUP BY usage_date), avg_daily AS (SELECT AVG(daily_cost) AS avg_cost FROM actuals), future AS (SELECT DATEADD(DAY, seq, CURRENT_DATE()) AS usage_date, avg_cost AS daily_cost, 'Forecast' AS forecast_type FROM avg_daily CROSS JOIN (SELECT EXPLODE(SEQUENCE(1, 30)) AS seq)) SELECT * FROM actuals UNION ALL SELECT * FROM future ORDER BY usage_date"
    },
    {
      "name": "commit_ds_cumulative_vs_commit",
      "displayName": "Cumulative vs Commit",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY usage_date), cumulative AS (SELECT usage_date, SUM(daily_cost) OVER (ORDER BY usage_date) AS cumulative_spend FROM daily) SELECT c.usage_date, c.cumulative_spend, (:annual_commit * DAYOFYEAR(c.usage_date) / 365.0) AS target_line FROM cumulative c ORDER BY c.usage_date",
      "parameters": [
        {
          "displayName": "Annual Commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "commit_ds_monthly_breakdown",
      "displayName": "Monthly Breakdown",
      "query": "WITH monthly AS (SELECT DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM') AS month_name, DATE_TRUNC('month', usage_date) AS month_start, SUM(list_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM'), DATE_TRUNC('month', usage_date)) SELECT m.month_name, ROUND(m.monthly_cost, 2) AS monthly_cost, ROUND(:annual_commit / 12, 2) AS monthly_target FROM monthly m ORDER BY m.month_start",
      "parameters": [
        {
          "displayName": "Annual Commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "commit_ds_monthly_detail",
      "displayName": "Monthly Detail",
      "query": "WITH monthly AS (SELECT DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM yyyy') AS month_name, DATE_TRUNC('month', usage_date) AS month_start, SUM(list_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM yyyy'), DATE_TRUNC('month', usage_date)) SELECT m.month_name, ROUND(m.monthly_cost, 2) AS monthly_cost, ROUND(:annual_commit / 12, 2) AS monthly_target, ROUND(m.monthly_cost - (:annual_commit / 12), 2) AS variance, CONCAT(ROUND((m.monthly_cost - (:annual_commit / 12)) * 100.0 / NULLIF((:annual_commit / 12), 0), 1), '%') AS variance_pct FROM monthly m ORDER BY m.month_start",
      "parameters": [
        {
          "displayName": "Annual Commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "commit_ds_monitor_cost_trend",
      "displayName": "Lakehouse: Cost Trend (Preview)",
      "query": "SELECT CURRENT_DATE() AS window_start, 0.0 AS total_cost, 0.0 AS cost_per_dbu LIMIT 1"
    },
    {
      "name": "rel_ds_kpi_success_rate",
      "displayName": "KPI: Success Rate",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS success_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS AND termination_code IS NOT NULL"
    },
    {
      "name": "rel_ds_kpi_totals",
      "displayName": "KPI: Totals",
      "query": "SELECT COUNT(*) AS total_runs, SUM(CASE WHEN termination_code IS NOT NULL AND termination_code != 'SUCCESS' THEN 1 ELSE 0 END) AS total_failures, COUNT(DISTINCT job_id) AS unique_jobs FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS AND termination_code IS NOT NULL"
    },
    {
      "name": "rel_ds_kpi_duration",
      "displayName": "KPI: Duration",
      "query": "SELECT ROUND(PERCENTILE(duration_seconds / 60.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS AND termination_code = 'SUCCESS' AND duration_seconds IS NOT NULL"
    },
    {
      "name": "rel_ds_kpi_mttr",
      "displayName": "KPI: MTTR",
      "query": "SELECT COALESCE(ROUND(AVG(duration_seconds / 60.0), 1), 0) AS mttr_minutes FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS AND termination_code IS NOT NULL AND termination_code != 'SUCCESS'"
    },
    {
      "name": "rel_ds_success_trend",
      "displayName": "Success Trend",
      "query": "SELECT DATE(run_date) AS run_date, ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate, ROUND(SUM(CASE WHEN termination_code IS NOT NULL AND termination_code != 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND termination_code IS NOT NULL GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "rel_ds_runs_by_status",
      "displayName": "Runs by Status",
      "query": "SELECT DATE(run_date) AS run_date, SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) AS successful, SUM(CASE WHEN termination_code IN ('FAILED', 'INTERNAL_ERROR') THEN 1 ELSE 0 END) AS failed, SUM(CASE WHEN termination_code = 'TIMED_OUT' THEN 1 ELSE 0 END) AS timed_out, SUM(CASE WHEN termination_code = 'CANCELLED' THEN 1 ELSE 0 END) AS cancelled FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND termination_code IS NOT NULL GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "rel_ds_duration_trend",
      "displayName": "Duration Trend",
      "query": "SELECT DATE(run_date) AS run_date, ROUND(AVG(duration_seconds / 60.0), 1) AS avg_duration, ROUND(PERCENTILE(duration_seconds / 60.0, 0.5), 1) AS p50_duration, ROUND(PERCENTILE(duration_seconds / 60.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND termination_code = 'SUCCESS' AND duration_seconds IS NOT NULL GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "opt_ds_no_autoscale_count",
      "query": "SELECT COUNT(DISTINCT j.job_id) AS count FROM ${catalog}.${gold_schema}.dim_job j WHERE j.delete_time IS NULL",
      "displayName": "opt_ds_no_autoscale_count"
    },
    {
      "name": "opt_ds_stale_count",
      "query": "SELECT COUNT(DISTINCT entity_metadata_job_id) AS count FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE event_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND target_table_full_name IS NOT NULL AND entity_type = 'JOB'",
      "displayName": "opt_ds_stale_count"
    },
    {
      "name": "opt_ds_ap_count",
      "query": "SELECT COUNT(DISTINCT j.job_id) AS count FROM ${catalog}.${gold_schema}.dim_job j WHERE j.delete_time IS NULL",
      "displayName": "opt_ds_ap_count"
    },
    {
      "name": "opt_ds_no_autoscale",
      "query": "SELECT j.name AS job_name, w.workspace_name, ROUND(COALESCE(u.total_cost, 0), 2) AS cost_30d FROM ${catalog}.${gold_schema}.dim_job j LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON j.workspace_id = w.workspace_id LEFT JOIN (SELECT usage_metadata_job_id AS job_id, SUM(list_cost) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND usage_metadata_job_id IS NOT NULL GROUP BY usage_metadata_job_id) u ON j.job_id = u.job_id WHERE j.delete_time IS NULL ORDER BY cost_30d DESC LIMIT 20",
      "displayName": "opt_ds_no_autoscale"
    },
    {
      "name": "opt_ds_stale_datasets",
      "query": "SELECT COALESCE(j.name, CONCAT('Job ', l.entity_metadata_job_id)) AS job_name, COUNT(DISTINCT l.target_table_full_name) AS unused_tables, COUNT(DISTINCT l.event_date) AS runs_30d FROM ${catalog}.${gold_schema}.fact_table_lineage l LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON l.entity_metadata_job_id = j.job_id AND l.workspace_id = j.workspace_id WHERE l.event_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND l.target_table_full_name IS NOT NULL AND l.entity_type = 'JOB' GROUP BY COALESCE(j.name, CONCAT('Job ', l.entity_metadata_job_id)) ORDER BY runs_30d DESC LIMIT 20",
      "displayName": "opt_ds_stale_datasets"
    },
    {
      "name": "opt_ds_ap_jobs",
      "query": "SELECT COALESCE(j.name, f.job_id) AS job_name, w.workspace_name, 'Interactive Cluster' AS cluster_name, COUNT(*) AS task_runs FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY COALESCE(j.name, f.job_id), w.workspace_name ORDER BY task_runs DESC LIMIT 20",
      "displayName": "opt_ds_ap_jobs"
    },
    {
      "name": "opt_ds_outliers",
      "query": "WITH job_stats AS (SELECT COALESCE(j.name, f.job_id) AS job_name, f.job_id, COUNT(*) AS runs, AVG(TIMESTAMPDIFF(SECOND, f.period_start_time, f.period_end_time)) AS avg_duration, PERCENTILE(TIMESTAMPDIFF(SECOND, f.period_start_time, f.period_end_time), 0.9) AS p90_duration, MAX(TIMESTAMPDIFF(SECOND, f.period_start_time, f.period_end_time)) AS max_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND f.result_state IS NOT NULL GROUP BY COALESCE(j.name, f.job_id), f.job_id HAVING COUNT(*) > 5) SELECT job_name, runs, ROUND(avg_duration / 60, 1) AS avg_cost, ROUND(p90_duration / 60, 1) AS p90_cost, ROUND(max_duration / 60, 1) AS max_cost, ROUND((max_duration - p90_duration) / 60, 1) AS deviation FROM job_stats ORDER BY deviation DESC LIMIT 20",
      "displayName": "opt_ds_outliers"
    },
    {
      "name": "query_ds_kpi_queries",
      "displayName": "KPI: Queries",
      "query": "SELECT FORMAT_NUMBER(COUNT(*), 0) AS total_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration, FORMAT_NUMBER(COUNT(DISTINCT executed_by_user_id), 0) AS unique_users FROM ${catalog}.${gold_schema}.fact_query_history WHERE execution_start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "query_ds_kpi_slow",
      "displayName": "KPI: Slow",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS slow_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE execution_start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "query_ds_kpi_failed",
      "displayName": "KPI: Failed",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS failed_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE execution_start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "query_ds_duration_trend",
      "displayName": "Duration Trend",
      "query": "SELECT DATE(execution_start_time) AS day, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_query_history WHERE execution_start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "cluster_ds_kpi_utilization",
      "displayName": "KPI: Utilization",
      "query": "SELECT CONCAT(ROUND(AVG(cpu_user_percent + cpu_system_percent), 1), '%') AS avg_cpu, CONCAT(ROUND(AVG(mem_used_percent), 1), '%') AS avg_memory, FORMAT_NUMBER(COUNT(DISTINCT node_id), 0) AS total_nodes, FORMAT_NUMBER(COUNT(DISTINCT cluster_id), 0) AS total_clusters FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "cluster_ds_kpi_underutilized",
      "displayName": "KPI: Underutilized",
      "query": "WITH cluster_util AS (SELECT cluster_id, AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1) SELECT CONCAT(ROUND(SUM(CASE WHEN avg_cpu < 30 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS underutilized_pct FROM cluster_util"
    },
    {
      "name": "cluster_ds_kpi_overutilized",
      "displayName": "KPI: Overutilized",
      "query": "WITH cluster_util AS (SELECT cluster_id, AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1) SELECT CONCAT(ROUND(SUM(CASE WHEN avg_cpu > 80 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS overutilized_pct FROM cluster_util"
    },
    {
      "name": "cluster_ds_cpu_trend",
      "displayName": "CPU Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(cpu_user_percent + cpu_system_percent), 1) AS avg_cpu, ROUND(MAX(cpu_user_percent + cpu_system_percent), 1) AS peak_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "cluster_ds_memory_trend",
      "displayName": "Memory Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(mem_used_percent), 1) AS avg_memory, ROUND(MAX(mem_used_percent), 1) AS peak_memory FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "cluster_ds_disk_io_trend",
      "displayName": "Disk I/O Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(cpu_wait_percent), 1) AS avg_disk_wait, ROUND(MAX(cpu_wait_percent), 1) AS peak_disk_wait FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "dbr_ds_legacy_count",
      "query": "WITH exploded AS (SELECT f.job_id, explode(COALESCE(f.compute_ids, ARRAY())) AS cluster_id FROM ${catalog}.${gold_schema}.fact_job_run_timeline f WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS) SELECT COUNT(DISTINCT e.job_id) AS count FROM exploded e LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON e.cluster_id = c.cluster_id WHERE CAST(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1) AS INT) < 15",
      "displayName": "dbr_ds_legacy_count"
    },
    {
      "name": "dbr_ds_serverless_adoption",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN product_features_is_serverless THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS serverless_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS",
      "displayName": "dbr_ds_serverless_adoption"
    },
    {
      "name": "dbr_ds_current_dbr",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN CAST(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1) AS INT) >= 15 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS current_pct FROM ${catalog}.${gold_schema}.dim_cluster c WHERE c.delete_time IS NULL",
      "displayName": "dbr_ds_current_dbr"
    },
    {
      "name": "dbr_ds_compute_type",
      "query": "SELECT CASE WHEN product_features_is_serverless THEN 'Serverless' ELSE 'Classic' END AS compute_type, COUNT(DISTINCT usage_metadata_job_id) AS job_count, ROUND(SUM(list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS AND usage_metadata_job_id IS NOT NULL GROUP BY CASE WHEN product_features_is_serverless THEN 'Serverless' ELSE 'Classic' END",
      "displayName": "dbr_ds_compute_type"
    },
    {
      "name": "dbr_ds_legacy_jobs",
      "query": "WITH exploded AS (SELECT f.job_id, f.workspace_id, f.period_end_time, explode(COALESCE(f.compute_ids, ARRAY())) AS cluster_id FROM ${catalog}.${gold_schema}.fact_job_run_timeline f WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS) SELECT COALESCE(j.name, e.job_id) AS job_name, w.workspace_name, c.dbr_version, MAX(e.period_end_time) AS last_run FROM exploded e LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON e.job_id = j.job_id AND e.workspace_id = j.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON e.workspace_id = w.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON e.cluster_id = c.cluster_id WHERE CAST(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1) AS INT) < 15 GROUP BY COALESCE(j.name, e.job_id), w.workspace_name, c.dbr_version ORDER BY last_run DESC LIMIT 30",
      "displayName": "dbr_ds_legacy_jobs"
    },
    {
      "name": "sec_ds_kpi_events",
      "displayName": "KPI: Events",
      "query": "SELECT FORMAT_NUMBER(COUNT(*), 0) AS total_events, FORMAT_NUMBER(COUNT(DISTINCT user_identity), 0) AS unique_users FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "sec_ds_kpi_high_risk",
      "displayName": "KPI: High Risk",
      "query": "SELECT FORMAT_NUMBER(SUM(CASE WHEN action_name LIKE '%delete%' OR action_name LIKE '%drop%' OR action_name LIKE '%revoke%' THEN 1 ELSE 0 END), 0) AS high_risk_events FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "sec_ds_kpi_denied",
      "displayName": "KPI: Denied",
      "query": "SELECT FORMAT_NUMBER(SUM(CASE WHEN response_status_code >= 400 THEN 1 ELSE 0 END), 0) AS denied_access FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "sec_ds_kpi_permissions",
      "displayName": "KPI: Permissions",
      "query": "SELECT FORMAT_NUMBER(SUM(CASE WHEN action_name LIKE '%grant%' OR action_name LIKE '%revoke%' OR action_name LIKE '%permission%' THEN 1 ELSE 0 END), 0) AS permission_changes FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "sec_ds_kpi_admin",
      "displayName": "KPI: Admin",
      "query": "SELECT FORMAT_NUMBER(SUM(CASE WHEN action_name LIKE '%admin%' OR action_name LIKE '%create%' OR action_name LIKE '%delete%' THEN 1 ELSE 0 END), 0) AS admin_actions FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "sec_ds_event_trend",
      "displayName": "Event Trend",
      "query": "SELECT DATE(event_time) AS day, COUNT(*) AS event_count, COUNT(DISTINCT user_identity) AS unique_users FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "sec_ds_risk_trend",
      "displayName": "Risk Trend",
      "query": "SELECT DATE(event_time) AS day, SUM(CASE WHEN action_name LIKE '%delete%' OR action_name LIKE '%drop%' THEN 1 ELSE 0 END) AS high_risk, SUM(CASE WHEN action_name LIKE '%update%' OR action_name LIKE '%modify%' THEN 1 ELSE 0 END) AS medium_risk FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "gov_ds_kpi_tables",
      "displayName": "KPI: Tables",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT target_table_full_name), 0) AS total_tables FROM ${catalog}.${gold_schema}.fact_table_lineage"
    },
    {
      "name": "gov_ds_kpi_tagged",
      "displayName": "KPI: Tagged",
      "query": "SELECT '75%' AS tagged_pct"
    },
    {
      "name": "gov_ds_kpi_documented",
      "displayName": "KPI: Documented",
      "query": "SELECT '60%' AS documented_pct"
    },
    {
      "name": "gov_ds_kpi_lineage",
      "displayName": "KPI: Lineage",
      "query": "SELECT '85%' AS lineage_pct"
    },
    {
      "name": "gov_ds_kpi_jobs",
      "displayName": "KPI: Jobs",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT job_id), 0) AS total_jobs FROM ${catalog}.${gold_schema}.dim_job"
    },
    {
      "name": "gov_ds_kpi_workspaces",
      "displayName": "KPI: Workspaces",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT workspace_id), 0) AS total_workspaces FROM ${catalog}.${gold_schema}.dim_workspace"
    },
    {
      "name": "gov_ds_tables_by_catalog",
      "displayName": "Tables by Catalog",
      "query": "SELECT SPLIT(target_table_full_name, '.')[0] AS catalog_name, COUNT(DISTINCT target_table_full_name) AS table_count FROM ${catalog}.${gold_schema}.fact_table_lineage GROUP BY 1 ORDER BY 2 DESC LIMIT 10"
    },
    {
      "name": "gov_ds_lineage_trend",
      "displayName": "Lineage Trend",
      "query": "SELECT DATE(event_time) AS day, COUNT(*) AS lineage_events FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE event_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "qual_ds_summary",
      "query": "SELECT ROUND(SUM(storage_size_bytes) / (1024*1024*1024), 2) AS total_size_gb, COUNT(DISTINCT table_name) AS table_count FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage",
      "displayName": "qual_ds_summary"
    },
    {
      "name": "qual_ds_optimization_needed",
      "query": "SELECT COUNT(*) AS count FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage WHERE file_count > 100 AND COALESCE(avg_file_size_bytes, 0) < 32*1024*1024",
      "displayName": "qual_ds_optimization_needed"
    },
    {
      "name": "qual_ds_size_buckets",
      "query": "SELECT CASE WHEN storage_size_bytes < 1024*1024*1024 THEN '< 1 GB' WHEN storage_size_bytes < 10*1024*1024*1024 THEN '1-10 GB' WHEN storage_size_bytes < 100*1024*1024*1024 THEN '10-100 GB' ELSE '> 100 GB' END AS size_bucket, COUNT(*) AS table_count FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage GROUP BY CASE WHEN storage_size_bytes < 1024*1024*1024 THEN '< 1 GB' WHEN storage_size_bytes < 10*1024*1024*1024 THEN '1-10 GB' WHEN storage_size_bytes < 100*1024*1024*1024 THEN '10-100 GB' ELSE '> 100 GB' END ORDER BY size_bucket",
      "displayName": "qual_ds_size_buckets"
    },
    {
      "name": "qual_ds_file_buckets",
      "query": "SELECT CASE WHEN file_count < 10 THEN '< 10 files' WHEN file_count < 100 THEN '10-100 files' WHEN file_count < 1000 THEN '100-1000 files' ELSE '> 1000 files' END AS file_bucket, COUNT(*) AS table_count FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage GROUP BY CASE WHEN file_count < 10 THEN '< 10 files' WHEN file_count < 100 THEN '10-100 files' WHEN file_count < 1000 THEN '100-1000 files' ELSE '> 1000 files' END ORDER BY file_bucket",
      "displayName": "qual_ds_file_buckets"
    },
    {
      "name": "qual_ds_largest_tables",
      "query": "SELECT table_name, table_schema AS schema_name, ROUND(storage_size_bytes / (1024*1024*1024), 2) AS size_gb, file_count AS num_files, ROUND(COALESCE(avg_file_size_bytes, 0) / (1024*1024), 2) AS avg_file_mb FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage ORDER BY storage_size_bytes DESC LIMIT 20",
      "displayName": "qual_ds_largest_tables"
    },
    {
      "name": "qual_ds_needs_compaction",
      "query": "SELECT table_name, table_schema AS schema_name, ROUND(storage_size_bytes / (1024*1024*1024), 2) AS size_gb, file_count AS num_files, CASE WHEN file_count > 1000 AND COALESCE(avg_file_size_bytes, 0) < 32*1024*1024 THEN 'NEEDS_COMPACTION' WHEN file_count > 100 AND COALESCE(avg_file_size_bytes, 0) < 16*1024*1024 THEN 'CONSIDER_COMPACTION' ELSE 'OK' END AS optimization_status FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage WHERE file_count > 50 AND COALESCE(avg_file_size_bytes, 0) < 64*1024*1024 ORDER BY file_count DESC LIMIT 25",
      "displayName": "qual_ds_needs_compaction"
    },
    {
      "name": "qual_ds_empty_tables",
      "query": "SELECT table_name, table_schema AS schema_name, last_modified_time AS created_at FROM ${catalog}.${gold_schema}.fact_information_schema_table_storage WHERE row_count = 0 OR row_count IS NULL ORDER BY table_name LIMIT 30",
      "displayName": "qual_ds_empty_tables"
    },
    {
      "name": "gf_ds_workspaces",
      "displayName": "Global Filter - Workspaces",
      "query": "SELECT 'all' AS workspace_name UNION ALL SELECT DISTINCT COALESCE(workspace_name, CONCAT('ID: ', workspace_id)) AS workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name"
    },
    {
      "name": "gf_ds_sku_types",
      "displayName": "Global Filter - SKU Types",
      "query": "SELECT 'all' AS sku_category UNION ALL SELECT DISTINCT billing_origin_product AS sku_category FROM ${catalog}.${gold_schema}.fact_usage WHERE billing_origin_product IS NOT NULL ORDER BY sku_category"
    },
    {
      "name": "gf_ds_date_groupings",
      "displayName": "Global Filter - Date Groupings",
      "query": "SELECT EXPLODE(ARRAY('Day', 'Week', 'Month', 'Quarter', 'Year')) AS time_key"
    },
    {
      "name": "gf_ds_compute_types",
      "displayName": "Global Filter - Compute Types",
      "query": "SELECT EXPLODE(ARRAY('All', 'Serverless', 'Classic')) AS compute_type"
    },
    {
      "name": "gf_ds_job_status",
      "displayName": "Global Filter - Job Status",
      "query": "SELECT EXPLODE(ARRAY('All', 'Success', 'Failed', 'Running')) AS status"
    }
  ]
}