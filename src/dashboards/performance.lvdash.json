{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_queries_time_range",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_slow_time_range",
                "query": {
                  "datasetName": "ds_kpi_slow",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_failed_time_range",
                "query": {
                  "datasetName": "ds_kpi_failed",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_query_volume_time_range",
                "query": {
                  "datasetName": "ds_query_volume",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slowest_queries_time_range",
                "query": {
                  "datasetName": "ds_slowest_queries",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slow_by_user_time_range",
                "query": {
                  "datasetName": "ds_slow_by_user",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slow_by_warehouse_time_range",
                "query": {
                  "datasetName": "ds_slow_by_warehouse",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slow_query_trend_time_range",
                "query": {
                  "datasetName": "ds_slow_query_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_queries_time_range",
                "query": {
                  "datasetName": "ds_failed_queries",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_by_error_time_range",
                "query": {
                  "datasetName": "ds_failed_by_error",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_trend_time_range",
                "query": {
                  "datasetName": "ds_failed_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_perf_time_range",
                "query": {
                  "datasetName": "ds_warehouse_perf",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_queries_by_warehouse_time_range",
                "query": {
                  "datasetName": "ds_queries_by_warehouse",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_hourly_time_range",
                "query": {
                  "datasetName": "ds_warehouse_hourly",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_usage_trend_time_range",
                "query": {
                  "datasetName": "ds_warehouse_usage_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_type_distribution_time_range",
                "query": {
                  "datasetName": "ds_warehouse_type_distribution",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_long_queries_time_range",
                "query": {
                  "datasetName": "ds_warehouse_long_queries",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_query_source_distribution_time_range",
                "query": {
                  "datasetName": "ds_query_source_distribution",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_warehouse_cost_ranking_time_range",
                "query": {
                  "datasetName": "ds_warehouse_cost_ranking",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_volume_time_range",
                "query": {
                  "datasetName": "ds_monitor_volume",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_utilization_time_range",
                "query": {
                  "datasetName": "ds_kpi_utilization",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_underutilized_time_range",
                "query": {
                  "datasetName": "ds_kpi_underutilized",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_overutilized_time_range",
                "query": {
                  "datasetName": "ds_kpi_overutilized",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_cpu_trend_time_range",
                "query": {
                  "datasetName": "ds_cpu_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_memory_trend_time_range",
                "query": {
                  "datasetName": "ds_memory_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_disk_io_trend_time_range",
                "query": {
                  "datasetName": "ds_disk_io_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_underutilized_clusters_time_range",
                "query": {
                  "datasetName": "ds_underutilized_clusters",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_overutilized_clusters_time_range",
                "query": {
                  "datasetName": "ds_overutilized_clusters",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_high_memory_swap_time_range",
                "query": {
                  "datasetName": "ds_high_memory_swap",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_high_io_wait_time_range",
                "query": {
                  "datasetName": "ds_high_io_wait",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_utilization_distribution_time_range",
                "query": {
                  "datasetName": "ds_utilization_distribution",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_cpu_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_cpu_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_memory_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_memory_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_legacy_count_time_range",
                "query": {
                  "datasetName": "ds_legacy_count",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_dbr_dist_time_range",
                "query": {
                  "datasetName": "ds_dbr_dist",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_compute_type_time_range",
                "query": {
                  "datasetName": "ds_compute_type",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_legacy_jobs_time_range",
                "query": {
                  "datasetName": "ds_legacy_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_low_cpu_time_range",
                "query": {
                  "datasetName": "ds_job_low_cpu",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_high_mem_time_range",
                "query": {
                  "datasetName": "ds_job_high_mem",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_cost_savings_time_range",
                "query": {
                  "datasetName": "ds_job_cost_savings",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_utilization_distribution_time_range",
                "query": {
                  "datasetName": "ds_job_utilization_distribution",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_kpi_utilization_time_range",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_expensive_time_range",
                "query": {
                  "datasetName": "ds_job_expensive",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_cost_change_time_range",
                "query": {
                  "datasetName": "ds_job_cost_change",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_failure_cost_time_range",
                "query": {
                  "datasetName": "ds_job_failure_cost",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_ap_clusters_time_range",
                "query": {
                  "datasetName": "ds_job_ap_clusters",
                  "parameters": [
                    { "name": "time_range", "keyword": "time_range" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_queries_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_slow_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_failed_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_query_volume_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slowest_queries_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slow_by_user_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slow_by_warehouse_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slow_query_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_queries_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_by_error_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_perf_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_queries_by_warehouse_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_hourly_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_usage_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_type_distribution_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_long_queries_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_query_source_distribution_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_warehouse_cost_ranking_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_volume_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_utilization_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_underutilized_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_overutilized_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_cpu_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_memory_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_disk_io_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_underutilized_clusters_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_overutilized_clusters_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_high_memory_swap_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_high_io_wait_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_utilization_distribution_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_cpu_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_memory_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_legacy_count_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_dbr_dist_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_compute_type_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_legacy_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_low_cpu_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_high_mem_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_cost_savings_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_utilization_distribution_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_kpi_utilization_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_expensive_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_cost_change_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_failure_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_ap_clusters_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_underutilized_clusters_param_workspace",
                "query": {
                  "datasetName": "ds_underutilized_clusters",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_overutilized_clusters_param_workspace",
                "query": {
                  "datasetName": "ds_overutilized_clusters",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_high_io_wait_param_workspace",
                "query": {
                  "datasetName": "ds_high_io_wait",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_low_cpu_high_cost_param_workspace",
                "query": {
                  "datasetName": "ds_low_cpu_high_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_legacy_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_legacy_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_underutilized_clusters_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_overutilized_clusters_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_high_io_wait_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_low_cpu_high_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_legacy_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_performance_overview",
      "displayName": "\u26a1 Performance Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_avg_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Duration (sec)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_slow_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_slow",
                  "fields": [
                    {
                      "name": "slow_queries_pct",
                      "expression": "`slow_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_queries_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Slow Queries %",
                "description": ">30 seconds"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_failed",
                  "fields": [
                    {
                      "name": "failed_queries_pct",
                      "expression": "`failed_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "failed_queries_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failed Queries %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_query_volume",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_query_volume",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "query_count",
                      "displayName": "Queries"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Volume Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg Duration (s)"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95 Duration (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f1\ufe0f Query Duration Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_slow_queries",
      "displayName": "\ud83d\udc0c Slow Queries Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_slowest_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slowest_queries",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_id",
                      "expression": "`query_id`"
                    },
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "duration_sec",
                      "expression": "`duration_sec`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_id",
                    "title": "Query ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "duration_sec",
                    "title": "Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "status",
                    "title": "Status",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc0c Top 20 Slowest Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_slow_by_user",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_by_user",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "slow_queries",
                      "expression": "`slow_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "slow_queries",
                    "title": "Slow Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc64 Slow Queries by User"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_slow_by_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_by_warehouse",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "query_preview",
                      "expression": "`query_preview`"
                    },
                    {
                      "name": "duration_seconds",
                      "expression": "`duration_seconds`"
                    },
                    {
                      "name": "duration_minutes",
                      "expression": "`duration_minutes`"
                    },
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "warehouse",
                      "expression": "`warehouse`"
                    },
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "query_preview",
                    "title": "Query (first 100 chars)",
                    "type": "string"
                  },
                  {
                    "fieldName": "duration_minutes",
                    "title": "Duration (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_date",
                    "title": "Date",
                    "type": "date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc0c Top Slow Queries (Actionable Detail)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_slow_query_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_query_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "slow_queries",
                      "expression": "`slow_queries`"
                    },
                    {
                      "name": "slow_pct",
                      "expression": "`slow_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "slow_queries",
                      "displayName": "Slow Queries"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Slow Query Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_failed_queries",
      "displayName": "\u274c Failed Queries",
      "layout": [
        {
          "widget": {
            "name": "table_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_queries",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_id",
                      "expression": "`query_id`"
                    },
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "error_message",
                      "expression": "`error_message`"
                    },
                    {
                      "name": "execution_time",
                      "expression": "`execution_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_id",
                    "title": "Query ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "error_message",
                    "title": "Error",
                    "type": "string"
                  },
                  {
                    "fieldName": "execution_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u274c Recent Failed Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failed_by_error",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_by_error",
                  "fields": [
                    {
                      "name": "error_category",
                      "expression": "`error_category`"
                    },
                    {
                      "name": "failure_count",
                      "expression": "`failure_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "error_category",
                  "displayName": "Error Category",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "failure_count",
                  "displayName": "Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Failures by Error Category"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failed_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "failed_count",
                      "expression": "`failed_count`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "failure_rate",
                      "displayName": "Failure Rate %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Failure Rate Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_warehouse_analysis",
      "displayName": "\ud83c\udfed Warehouse Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_warehouse_perf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_perf",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    },
                    {
                      "name": "data_scanned_gb",
                      "expression": "`data_scanned_gb`"
                    },
                    {
                      "name": "spill_pct",
                      "expression": "`spill_pct`"
                    },
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95 (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_rate",
                    "title": "Fail %",
                    "type": "number"
                  },
                  {
                    "fieldName": "data_scanned_gb",
                    "title": "Data (GB)",
                    "type": "number"
                  },
                  {
                    "fieldName": "spill_pct",
                    "title": "Spill %",
                    "type": "number"
                  },
                  {
                    "fieldName": "active_users",
                    "title": "Users",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfed Warehouse Performance Summary (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_queries_by_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_queries_by_warehouse",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "warehouse_name",
                  "displayName": "Warehouse",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "query_count",
                  "displayName": "Query Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Query Distribution by Warehouse"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_warehouse_hourly",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_hourly",
                  "fields": [
                    {
                      "name": "hour",
                      "expression": "`hour`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "hour",
                  "displayName": "Hour of Day",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "query_count",
                      "displayName": "Queries"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f0 Query Volume by Hour"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_warehouse_usage_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_usage_trend",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "compute_hours",
                      "expression": "`compute_hours`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "compute_hours",
                  "displayName": "Compute Hours",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "warehouse_name",
                  "displayName": "Warehouse",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Warehouse Usage Over Time (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_warehouse_type_dist",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_type_distribution",
                  "fields": [
                    {
                      "name": "warehouse_type",
                      "expression": "`warehouse_type`"
                    },
                    {
                      "name": "compute_hours",
                      "expression": "`compute_hours`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "warehouse_type",
                  "displayName": "Type",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "compute_hours",
                  "displayName": "Compute Hours",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfaf Usage by Warehouse Type"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_query_source_dist",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_query_source_distribution",
                  "fields": [
                    {
                      "name": "query_source",
                      "expression": "`query_source`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "query_source",
                  "displayName": "Source",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "query_count",
                  "displayName": "Queries",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcbb Query Source Distribution"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 18,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_warehouse_cost_ranking",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_cost_ranking",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "compute_hours",
                      "expression": "`compute_hours`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "compute_hours",
                  "displayName": "Compute Hours",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "y": {
                  "fieldName": "warehouse_name",
                  "displayName": "Warehouse",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "color": {
                  "fieldName": "warehouse_name",
                  "displayName": "Warehouse",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Top Warehouses by Compute Hours"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 24,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_long_running_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_long_queries",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "long_queries_30s",
                      "expression": "`long_queries_30s`"
                    },
                    {
                      "name": "long_queries_60s",
                      "expression": "`long_queries_60s`"
                    },
                    {
                      "name": "long_queries_5m",
                      "expression": "`long_queries_5m`"
                    },
                    {
                      "name": "long_query_pct",
                      "expression": "`long_query_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "long_queries_30s",
                    "title": ">30s",
                    "type": "number"
                  },
                  {
                    "fieldName": "long_queries_60s",
                    "title": ">60s",
                    "type": "number"
                  },
                  {
                    "fieldName": "long_queries_5m",
                    "title": ">5min",
                    "type": "number"
                  },
                  {
                    "fieldName": "long_query_pct",
                    "title": "Long Query %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Long-Running Queries by Warehouse"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 30,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_warehouse_config",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_config_snapshot",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "warehouse_type",
                      "expression": "`warehouse_type`"
                    },
                    {
                      "name": "warehouse_size",
                      "expression": "`warehouse_size`"
                    },
                    {
                      "name": "min_clusters",
                      "expression": "`min_clusters`"
                    },
                    {
                      "name": "max_clusters",
                      "expression": "`max_clusters`"
                    },
                    {
                      "name": "auto_stop_minutes",
                      "expression": "`auto_stop_minutes`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_type",
                    "title": "Type",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_size",
                    "title": "Size",
                    "type": "string"
                  },
                  {
                    "fieldName": "min_clusters",
                    "title": "Min",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_clusters",
                    "title": "Max",
                    "type": "number"
                  },
                  {
                    "fieldName": "auto_stop_minutes",
                    "title": "Auto-Stop (min)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u2699\ufe0f Warehouse Configuration Snapshot"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 36,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "table_ml_optimization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_optimization",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "query_pattern",
                      "expression": "`query_pattern`"
                    },
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "warehouse",
                      "expression": "`warehouse`"
                    },
                    {
                      "name": "p95_duration_sec",
                      "expression": "`p95_duration_sec`"
                    },
                    {
                      "name": "execution_count",
                      "expression": "`execution_count`"
                    },
                    {
                      "name": "optimization_tip",
                      "expression": "`optimization_tip`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "query_pattern",
                    "title": "Query Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "p95_duration_sec",
                    "title": "P95 (sec)",
                    "type": "number"
                  },
                  {
                    "fieldName": "execution_count",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "optimization_tip",
                    "title": "Optimization Tip",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Evidence",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 Query Optimization Recommendations",
                "description": "Recurring slow query patterns with actionable optimization tips"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "table_ml_regression",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_regression",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "query_pattern",
                      "expression": "`query_pattern`"
                    },
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "warehouse",
                      "expression": "`warehouse`"
                    },
                    {
                      "name": "baseline_avg_sec",
                      "expression": "`baseline_avg_sec`"
                    },
                    {
                      "name": "recent_avg_sec",
                      "expression": "`recent_avg_sec`"
                    },
                    {
                      "name": "regression_pct",
                      "expression": "`regression_pct`"
                    },
                    {
                      "name": "root_cause",
                      "expression": "`root_cause`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "query_pattern",
                    "title": "Query",
                    "type": "string"
                  },
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "baseline_avg_sec",
                    "title": "Baseline (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "recent_avg_sec",
                    "title": "Recent (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "regression_pct",
                    "title": " %",
                    "type": "number"
                  },
                  {
                    "fieldName": "root_cause",
                    "title": "Root Cause",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Evidence",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc9 Query Performance Regression Detection",
                "description": "Queries that have slowed down vs their baseline (last 7 days vs prior 23 days)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_warehouse",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    },
                    {
                      "name": "warehouse",
                      "expression": "`warehouse`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "p95_duration_sec",
                      "expression": "`p95_duration_sec`"
                    },
                    {
                      "name": "slow_query_pct",
                      "expression": "`slow_query_pct`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    },
                    {
                      "name": "evidence",
                      "expression": "`evidence`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "recommendation",
                    "title": "Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration_sec",
                    "title": "P95 (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "slow_query_pct",
                    "title": "Slow %",
                    "type": "number"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Rationale",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfed Warehouse Sizing Recommendations",
                "description": "Based on actual query performance metrics (P95, slow query %, utilization)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": " Query Metrics Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Total Queries"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_avg",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Avg Duration (s)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_slow",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "slow_query_rate",
                      "expression": "`slow_query_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_query_rate",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Slow Query Rate %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg Duration (s)"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95 Duration (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Query Duration Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_volume_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_volume",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_queries",
                      "displayName": "Queries"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Query Volume Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "duration_drift",
                      "expression": "`duration_drift`"
                    },
                    {
                      "name": "volume_drift",
                      "expression": "`volume_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "duration_drift",
                      "displayName": "Duration Drift %"
                    },
                    {
                      "fieldName": "volume_drift",
                      "displayName": "Volume Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Performance Drift Detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_drift_investigation",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_drift_investigation",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "impact",
                      "expression": "`impact`"
                    },
                    {
                      "name": "spike_date",
                      "expression": "`spike_date`"
                    },
                    {
                      "name": "query_pattern",
                      "expression": "`query_pattern`"
                    },
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "warehouse",
                      "expression": "`warehouse`"
                    },
                    {
                      "name": "executions",
                      "expression": "`executions`"
                    },
                    {
                      "name": "total_time_sec",
                      "expression": "`total_time_sec`"
                    },
                    {
                      "name": "investigation_note",
                      "expression": "`investigation_note`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "impact",
                    "title": "Impact",
                    "type": "string"
                  },
                  {
                    "fieldName": "spike_date",
                    "title": "Spike Date",
                    "type": "date"
                  },
                  {
                    "fieldName": "query_pattern",
                    "title": "Query Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "executions",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_time_sec",
                    "title": "Total Time (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "investigation_note",
                    "title": "Investigation Notes",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd0d Drift Spike Investigation - What Caused the Spikes?",
                "description": "Shows top queries contributing to days with >50% duration drift"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "slow_query_rate",
                      "expression": "`slow_query_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95 (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "slow_query_rate",
                    "title": "Slow %",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_rate",
                    "title": "Fail %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_utilization_overview",
      "displayName": "\ud83d\udda5\ufe0f Utilization Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_avg_cpu",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg CPU Utilization %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_avg_memory",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_memory",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Memory Utilization %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_nodes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "total_nodes",
                      "expression": "`total_nodes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_nodes",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Nodes (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_underutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_underutilized",
                  "fields": [
                    {
                      "name": "underutilized_pct",
                      "expression": "`underutilized_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "underutilized_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Underutilized Clusters %",
                "description": "<30% avg CPU"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_overutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_overutilized",
                  "fields": [
                    {
                      "name": "overutilized_pct",
                      "expression": "`overutilized_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "overutilized_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Overutilized Clusters %",
                "description": ">80% avg CPU"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_utilization",
                  "fields": [
                    {
                      "name": "total_clusters",
                      "expression": "`total_clusters`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_clusters",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Clusters (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_cpu_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_cpu_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "peak_cpu",
                      "expression": "`peak_cpu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_cpu",
                      "displayName": "Avg CPU %"
                    },
                    {
                      "fieldName": "peak_cpu",
                      "displayName": "Peak CPU %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 CPU Utilization Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_memory_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_memory_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "peak_memory",
                      "expression": "`peak_memory`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_memory",
                      "displayName": "Avg Memory %"
                    },
                    {
                      "fieldName": "peak_memory",
                      "displayName": "Peak Memory %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Memory Utilization Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_disk_io",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_disk_io_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_disk_wait",
                      "expression": "`avg_disk_wait`"
                    },
                    {
                      "name": "peak_disk_wait",
                      "expression": "`peak_disk_wait`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_disk_wait",
                      "displayName": "Avg I/O Wait %"
                    },
                    {
                      "fieldName": "peak_disk_wait",
                      "displayName": "Peak I/O Wait %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcbe Disk I/O Wait Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_cluster_analysis",
      "displayName": "\ud83d\udd0d Cluster Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_underutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_underutilized_clusters",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "estimated_cost",
                      "expression": "`estimated_cost`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Avg CPU %",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_memory",
                    "title": "Avg Mem %",
                    "type": "number"
                  },
                  {
                    "fieldName": "estimated_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc9 Underutilized Clusters (<30% CPU)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_overutilized",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_overutilized_clusters",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "peak_cpu",
                      "expression": "`peak_cpu`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Avg CPU %",
                    "type": "number"
                  },
                  {
                    "fieldName": "peak_cpu",
                    "title": "Peak CPU %",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_memory",
                    "title": "Avg Mem %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd25 Overutilized Clusters (>80% CPU)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_high_memory_swap",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_high_memory_swap",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "peak_memory",
                      "expression": "`peak_memory`"
                    },
                    {
                      "name": "swap_events",
                      "expression": "`swap_events`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_memory",
                    "title": "Avg Mem %",
                    "type": "number"
                  },
                  {
                    "fieldName": "peak_memory",
                    "title": "Peak Mem %",
                    "type": "number"
                  },
                  {
                    "fieldName": "swap_events",
                    "title": "Swap Events",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f High Memory/Swap Clusters"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_high_io_wait",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_high_io_wait",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "avg_io_wait",
                      "expression": "`avg_io_wait`"
                    },
                    {
                      "name": "peak_io_wait",
                      "expression": "`peak_io_wait`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_io_wait",
                    "title": "Avg I/O Wait %",
                    "type": "number"
                  },
                  {
                    "fieldName": "peak_io_wait",
                    "title": "Peak I/O Wait %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcbe High I/O Wait Clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_utilization_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_utilization_distribution",
                  "fields": [
                    {
                      "name": "utilization_bucket",
                      "expression": "`utilization_bucket`"
                    },
                    {
                      "name": "cluster_count",
                      "expression": "`cluster_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "utilization_bucket",
                  "displayName": "CPU Utilization Range",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "cluster_count",
                  "displayName": "Cluster Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Cluster Distribution by CPU Utilization"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_rightsizing",
      "displayName": "\ud83c\udfaf Right-Sizing Opportunities",
      "layout": [
        {
          "widget": {
            "name": "table_rightsizing_recs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_rightsizing_recommendations",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "current_size",
                      "expression": "`current_size`"
                    },
                    {
                      "name": "recommended_size",
                      "expression": "`recommended_size`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "current_size",
                    "title": "Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_size",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Slow Query %",
                    "type": "number"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Est. Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Warehouse Right-Sizing Recommendations",
                "description": "Based on slow query % - oversized warehouses have potential savings"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_low_cpu_high_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_low_cpu_high_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "cost_30d",
                      "expression": "`cost_30d`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Success Rate %",
                    "type": "number"
                  },
                  {
                    "fieldName": "cost_30d",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Est. Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc9 High-Success High-Cost Jobs",
                "description": "Jobs running well but costing a lot - optimization candidates"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_high_memory_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_high_memory_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "peak_memory",
                      "expression": "`peak_memory`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_memory",
                    "title": "Avg Duration (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "peak_memory",
                    "title": "Max Duration (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd25 Long-Running Jobs Analysis",
                "description": "Jobs with high P95 duration - may need optimization"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_savings_opportunity",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_savings_opportunity",
                  "fields": [
                    {
                      "name": "category",
                      "expression": "`category`"
                    },
                    {
                      "name": "savings",
                      "expression": "`savings`"
                    },
                    {
                      "name": "clusters",
                      "expression": "`clusters`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "category",
                  "displayName": "Category",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "savings",
                  "displayName": "Potential Savings ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Savings Opportunity by Category"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions_2",
      "displayName": "\ud83e\udd16 ML Predictions (Cluster)",
      "layout": [
        {
          "widget": {
            "name": "table_ml_capacity",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_capacity_predictions",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "current_workers",
                      "expression": "`current_workers`"
                    },
                    {
                      "name": "recommended_workers",
                      "expression": "`recommended_workers`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Warehouse"
                  },
                  {
                    "fieldName": "current_workers",
                    "title": "Current Workers"
                  },
                  {
                    "fieldName": "recommended_workers",
                    "title": "Recommended"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " ML: Capacity Planning Predictions",
                "description": "Gradient Boosting capacity planner"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_rightsizing",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_rightsizing",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "current_size",
                      "expression": "`current_size`"
                    },
                    {
                      "name": "recommended",
                      "expression": "`recommended`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Warehouse"
                  },
                  {
                    "fieldName": "current_size",
                    "title": "Current Size"
                  },
                  {
                    "fieldName": "recommended",
                    "title": "Recommended"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Savings ($)"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " ML: Right-Sizing Recommendations",
                "description": "Multi-output regression model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_dbr_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_dbr_risk",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "current_dbr",
                      "expression": "`current_dbr`"
                    },
                    {
                      "name": "target_dbr",
                      "expression": "`target_dbr`"
                    },
                    {
                      "name": "risk_level",
                      "expression": "`risk_level`"
                    },
                    {
                      "name": "risk_score",
                      "expression": "`risk_score`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "current_dbr",
                    "title": "Current DBR",
                    "type": "string"
                  },
                  {
                    "fieldName": "target_dbr",
                    "title": "Target DBR",
                    "type": "string"
                  },
                  {
                    "fieldName": "risk_level",
                    "title": "Risk Level",
                    "type": "string"
                  },
                  {
                    "fieldName": "risk_score",
                    "title": "Score",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: DBR Migration Risk",
                "description": "LightGBM risk scorer"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring_2",
      "displayName": " Cluster Metrics Detail",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_cpu",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Avg CPU %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_memory",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_memory",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Avg Memory %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_nodes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "total_nodes",
                      "expression": "`total_nodes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_nodes",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Total Nodes"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_cpu_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cpu_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "p95_cpu",
                      "expression": "`p95_cpu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_cpu",
                      "displayName": "Avg CPU %"
                    },
                    {
                      "fieldName": "p95_cpu",
                      "displayName": "P95 CPU %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: CPU Utilization Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_memory_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_memory_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "p95_memory",
                      "expression": "`p95_memory`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_memory",
                      "displayName": "Avg Memory %"
                    },
                    {
                      "fieldName": "p95_memory",
                      "displayName": "P95 Memory %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Memory Utilization Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "cpu_drift",
                      "expression": "`cpu_drift`"
                    },
                    {
                      "name": "memory_drift",
                      "expression": "`memory_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "cpu_drift",
                      "displayName": "CPU Drift %"
                    },
                    {
                      "fieldName": "memory_drift",
                      "displayName": "Memory Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Utilization Drift Detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_nodes",
                      "expression": "`total_nodes`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "p95_cpu",
                      "expression": "`p95_cpu`"
                    },
                    {
                      "name": "avg_memory",
                      "expression": "`avg_memory`"
                    },
                    {
                      "name": "avg_io_wait",
                      "expression": "`avg_io_wait`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_nodes",
                    "title": "Nodes",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Avg CPU",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_cpu",
                    "title": "P95 CPU",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_memory",
                    "title": "Avg Mem",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_io_wait",
                    "title": "I/O Wait",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_job_utilization",
      "displayName": " Job Resource Utilization",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_jobs_util",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "total_jobs", "expression": "`total_jobs`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_jobs",
                  "displayName": "Jobs Analyzed"
                }
              },
              "frame": { "showTitle": true, "title": "Jobs with Utilization Data" }
            }
          },
          "position": { "x": 0, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_avg_cpu",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "avg_cpu_utilization", "expression": "`avg_cpu_utilization`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu_utilization",
                  "displayName": "Avg CPU %"
                }
              },
              "frame": { "showTitle": true, "title": "Avg CPU Utilization %" }
            }
          },
          "position": { "x": 1, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_avg_memory",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "avg_memory_utilization", "expression": "`avg_memory_utilization`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_memory_utilization",
                  "displayName": "Avg Mem %"
                }
              },
              "frame": { "showTitle": true, "title": "Avg Memory Utilization %" }
            }
          },
          "position": { "x": 2, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_low_cpu_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "low_cpu_jobs", "expression": "`low_cpu_jobs`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "low_cpu_jobs",
                  "displayName": "Low CPU Jobs"
                }
              },
              "frame": { "showTitle": true, "title": "Low CPU Jobs (<30%)" }
            }
          },
          "position": { "x": 3, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_high_mem_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "high_memory_jobs", "expression": "`high_memory_jobs`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_memory_jobs",
                  "displayName": "High Mem Jobs"
                }
              },
              "frame": { "showTitle": true, "title": "High Memory Jobs (>70%)" }
            }
          },
          "position": { "x": 4, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_potential_savings",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_kpi_utilization",
                  "fields": [
                    { "name": "total_potential_savings", "expression": "`total_potential_savings`" }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_potential_savings",
                  "displayName": "Potential Savings"
                }
              },
              "frame": { "showTitle": true, "title": " Total Potential Savings ($)" }
            }
          },
          "position": { "x": 5, "y": 0, "width": 1, "height": 2 }
        },
        {
          "widget": {
            "name": "chart_cpu_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_utilization_distribution",
                  "fields": [
                    { "name": "cpu_range", "expression": "`cpu_range`" },
                    { "name": "job_count", "expression": "`job_count`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "cpu_range",
                  "displayName": "CPU Utilization Range",
                  "scale": { "type": "categorical" }
                },
                "y": {
                  "fieldName": "job_count",
                  "displayName": "Job Count",
                  "scale": { "type": "quantitative" }
                }
              },
              "frame": { "showTitle": true, "title": " Job CPU Utilization Distribution" }
            }
          },
          "position": { "x": 0, "y": 2, "width": 3, "height": 6 }
        },
        {
          "widget": {
            "name": "table_cost_savings",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_cost_savings",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "avg_cpu", "expression": "`avg_cpu`" },
                    { "name": "avg_memory", "expression": "`avg_memory`" },
                    { "name": "total_cost", "expression": "`total_cost`" },
                    { "name": "max_savings", "expression": "`max_savings`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "avg_cpu", "title": "Avg CPU %", "type": "number" },
                  { "fieldName": "avg_memory", "title": "Avg Memory %", "type": "number" },
                  { "fieldName": "total_cost", "title": "Total Cost ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "max_savings", "title": "Max Savings ($)", "type": "number", "numberFormat": "$0.00" }
                ]
              },
              "frame": { "showTitle": true, "title": " Top Cost Savings Opportunities" }
            }
          },
          "position": { "x": 3, "y": 2, "width": 3, "height": 6 }
        },
        {
          "widget": {
            "name": "table_low_cpu_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_low_cpu",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "avg_cpu", "expression": "`avg_cpu`" },
                    { "name": "peak_cpu", "expression": "`peak_cpu`" },
                    { "name": "avg_memory", "expression": "`avg_memory`" },
                    { "name": "total_cost", "expression": "`total_cost`" },
                    { "name": "potential_savings", "expression": "`potential_savings`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "avg_cpu", "title": "Avg CPU %", "type": "number" },
                  { "fieldName": "peak_cpu", "title": "Peak CPU %", "type": "number" },
                  { "fieldName": "avg_memory", "title": "Avg Memory %", "type": "number" },
                  { "fieldName": "total_cost", "title": "Total Cost ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "potential_savings", "title": "Potential Savings ($)", "type": "number", "numberFormat": "$0.00" }
                ]
              },
              "frame": { "showTitle": true, "title": " Jobs with Low CPU Utilization (<30%)", "showDescription": true, "description": "Jobs with low average CPU utilization. Consider rightsizing to smaller instances or enabling autoscaling." }
            }
          },
          "position": { "x": 0, "y": 8, "width": 6, "height": 7 }
        },
        {
          "widget": {
            "name": "table_high_mem_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_high_mem",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "avg_cpu", "expression": "`avg_cpu`" },
                    { "name": "avg_memory", "expression": "`avg_memory`" },
                    { "name": "peak_memory", "expression": "`peak_memory`" },
                    { "name": "avg_io_wait", "expression": "`avg_io_wait`" },
                    { "name": "total_cost", "expression": "`total_cost`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "avg_cpu", "title": "Avg CPU %", "type": "number" },
                  { "fieldName": "avg_memory", "title": "Avg Memory %", "type": "number" },
                  { "fieldName": "peak_memory", "title": "Peak Memory %", "type": "number" },
                  { "fieldName": "avg_io_wait", "title": "I/O Wait %", "type": "number" },
                  { "fieldName": "total_cost", "title": "Total Cost ($)", "type": "number", "numberFormat": "$0.00" }
                ]
              },
              "frame": { "showTitle": true, "title": " Jobs with High Memory Utilization (>70%)", "showDescription": true, "description": "Jobs with high average memory utilization. Consider using memory-optimized instances or checking for memory leaks." }
            }
          },
          "position": { "x": 0, "y": 15, "width": 6, "height": 7 }
        },
        {
          "widget": {
            "name": "table_expensive_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_expensive",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "workspace_name", "expression": "`workspace_name`" },
                    { "name": "runs", "expression": "`runs`" },
                    { "name": "total_cost", "expression": "`total_cost`" },
                    { "name": "owner", "expression": "`owner`" },
                    { "name": "last_run", "expression": "`last_run`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "workspace_name", "title": "Workspace", "type": "string" },
                  { "fieldName": "runs", "title": "Runs", "type": "number" },
                  { "fieldName": "total_cost", "title": "Total Cost ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "owner", "title": "Owner", "type": "string" },
                  { "fieldName": "last_run", "title": "Last Run", "type": "date" }
                ]
              },
              "frame": { "showTitle": true, "title": " Most Expensive Jobs (30d)", "showDescription": true, "description": "Top 15 jobs by total cost. Review for optimization opportunities like rightsizing or serverless migration." }
            }
          },
          "position": { "x": 0, "y": 22, "width": 6, "height": 7 }
        },
        {
          "widget": {
            "name": "table_cost_change_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_cost_change",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "last_7d", "expression": "`last_7d`" },
                    { "name": "prev_7d", "expression": "`prev_7d`" },
                    { "name": "growth", "expression": "`growth`" },
                    { "name": "growth_pct", "expression": "`growth_pct`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "last_7d", "title": "Last 7d ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "prev_7d", "title": "Prev 7d ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "growth", "title": "Change ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "growth_pct", "title": "Change %", "type": "number" }
                ]
              },
              "frame": { "showTitle": true, "title": " Jobs with Highest Cost Increase (WoW)", "showDescription": true, "description": "Jobs with the largest week-over-week cost increase. Investigate for unexpected growth patterns." }
            }
          },
          "position": { "x": 0, "y": 29, "width": 3, "height": 7 }
        },
        {
          "widget": {
            "name": "table_failure_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_failure_cost",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "failure_cost", "expression": "`failure_cost`" },
                    { "name": "failures", "expression": "`failures`" },
                    { "name": "total_runs", "expression": "`total_runs`" },
                    { "name": "success_rate", "expression": "`success_rate`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "failure_cost", "title": "Failure Cost ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "failures", "title": "Failures", "type": "number" },
                  { "fieldName": "total_runs", "title": "Total Runs", "type": "number" },
                  { "fieldName": "success_rate", "title": "Success %", "type": "number" }
                ]
              },
              "frame": { "showTitle": true, "title": " Job Failure Cost Analysis", "showDescription": true, "description": "Cost wasted on failed job runs. High failure costs indicate reliability issues worth investigating." }
            }
          },
          "position": { "x": 3, "y": 29, "width": 3, "height": 7 }
        },
        {
          "widget": {
            "name": "table_ap_cluster_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_ap_clusters",
                  "fields": [
                    { "name": "job_name", "expression": "`job_name`" },
                    { "name": "cluster_name", "expression": "`cluster_name`" },
                    { "name": "task_runs", "expression": "`task_runs`" },
                    { "name": "total_cost", "expression": "`total_cost`" },
                    { "name": "owner", "expression": "`owner`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "job_name", "title": "Job Name", "type": "string" },
                  { "fieldName": "cluster_name", "title": "AP Cluster", "type": "string" },
                  { "fieldName": "task_runs", "title": "Task Runs", "type": "number" },
                  { "fieldName": "total_cost", "title": "Total Cost ($)", "type": "number", "numberFormat": "$0.00" },
                  { "fieldName": "owner", "title": "Owner", "type": "string" }
                ]
              },
              "frame": { "showTitle": true, "title": " Jobs Running on All-Purpose Clusters", "showDescription": true, "description": "Jobs running on interactive (all-purpose) clusters instead of job clusters. Consider using dedicated job clusters for cost savings." }
            }
          },
          "position": { "x": 0, "y": 36, "width": 6, "height": 7 }
        }
      ]
    },
    {
      "name": "page_dbr_overview",
      "displayName": "DBR Version Status",
      "layout": [
        {
          "widget": {
            "name": "kpi_legacy_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_legacy_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on Legacy DBR",
                "description": "Jobs running DBR < 15"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_serverless_pct",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption",
                "description": "% of jobs using serverless"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_current_dbr_pct",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_current_dbr",
                  "fields": [
                    {
                      "name": "current_pct",
                      "expression": "`current_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "current_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Current DBR Usage",
                "description": "% on DBR 15+"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_dbr_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_dbr_dist",
                  "fields": [
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "version_status",
                      "expression": "`version_status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "dbr_version",
                  "displayName": "DBR Version",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "job_count",
                  "displayName": "Job Count",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "version_status",
                  "displayName": "Status",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "DBR Version Distribution",
                "description": "Job distribution across DBR versions"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_compute_type",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_compute_type",
                  "fields": [
                    {
                      "name": "compute_type",
                      "expression": "`compute_type`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "compute_type",
                  "displayName": "Compute Type",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "job_count",
                  "displayName": "Jobs",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless vs Classic",
                "description": "Job distribution by compute type"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_legacy_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_legacy_jobs",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "last_run",
                      "expression": "`last_run`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "dbr_version",
                    "title": "DBR Version",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_run",
                    "title": "Last Run",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on Legacy Runtime"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "performance_lakehouse_monitoring",
      "displayName": " Advanced Query Metrics",
      "layout": [
        {
          "widget": {
            "name": "performance_time_start_filter",
            "queries": [
              {
                "name": "param_ds_monitor_performance_aggregate_time_start",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_derived_time_start",
                "query": {
                  "datasetName": "ds_monitor_performance_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_keys_time_start",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_values_time_start",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_performance_aggregate_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_performance_derived_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_performance_slice_keys_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_performance_slice_values_time_start"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "performance_time_end_filter",
            "queries": [
              {
                "name": "param_ds_monitor_performance_aggregate_time_end",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_derived_time_end",
                "query": {
                  "datasetName": "ds_monitor_performance_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_keys_time_end",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_values_time_end",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_performance_aggregate_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_performance_derived_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_performance_slice_keys_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_performance_slice_values_time_end"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "End Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "performance_slice_key_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_keys",
                  "fields": [
                    {
                      "name": "slice_key",
                      "expression": "`slice_key`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_performance_aggregate_slice_key",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_derived_slice_key",
                "query": {
                  "datasetName": "ds_monitor_performance_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Key",
                    "fieldName": "slice_key",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_performance_aggregate_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_performance_derived_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_performance_slice_values_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_performance_slice_values_slice_key"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Key:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "performance_slice_value_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "fields": [
                    {
                      "name": "slice_value",
                      "expression": "`slice_value`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_performance_aggregate_slice_value",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_derived_slice_value",
                "query": {
                  "datasetName": "ds_monitor_performance_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_performance_slice_values_slice_value",
                "query": {
                  "datasetName": "ds_monitor_performance_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Value",
                    "fieldName": "slice_value",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_performance_aggregate_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_performance_derived_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_performance_slice_values_slice_value"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Value:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 9,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "performance_aggregate_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "successful_queries",
                      "expression": "`successful_queries`"
                    },
                    {
                      "name": "failed_queries",
                      "expression": "`failed_queries`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Total Queries",
                      "fieldName": "total_queries"
                    },
                    {
                      "displayName": "Successful Queries",
                      "fieldName": "successful_queries"
                    },
                    {
                      "displayName": "Failed Queries",
                      "fieldName": "failed_queries"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track performance aggregate metrics over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Performance Aggregate Metrics Over Time"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "performance_derived_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_performance_derived",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "query_success_rate",
                      "expression": "`query_success_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Query Success Rate",
                      "fieldName": "query_success_rate"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track performance business ratios over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Performance KPI Trends"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 6,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "performance_aggregate_table",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_performance_aggregate",
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Window Start",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "window_end",
                    "title": "Window End",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "successful_queries",
                    "title": "Successful",
                    "type": "number"
                  },
                  {
                    "fieldName": "failed_queries",
                    "title": "Failed",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration_sec",
                    "title": "Avg Duration (s)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Performance Metrics Detail"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 12,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_queries",
      "displayName": "KPI: Queries",
      "query": "SELECT COUNT(*) AS total_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration, COUNT(DISTINCT executed_by_user_id) AS unique_users FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_slow",
      "displayName": "KPI: Slow",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS slow_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_failed",
      "displayName": "KPI: Failed",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN execution_status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS failed_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_query_volume",
      "displayName": "Query Volume",
      "query": "SELECT DATE(start_time) AS day, COUNT(*) AS query_count, COUNT(DISTINCT executed_by_user_id) AS unique_users FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_duration_trend",
      "displayName": "Duration Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_slowest_queries",
      "displayName": "Slowest Queries",
      "query": "SELECT statement_id AS query_id, CAST(executed_by_user_id AS STRING) AS user_identity_email, COALESCE(warehouse_name, compute_type) AS warehouse_name, ROUND(total_duration_ms / 1000.0, 1) AS duration_sec, execution_status AS status FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max ORDER BY total_duration_ms DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_slow_by_user",
      "displayName": "Slow by User",
      "query": "SELECT executed_by_user_id AS user_identity_email, SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, COUNT(*) AS total_queries FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 HAVING SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) > 0 ORDER BY slow_queries DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_slow_by_warehouse",
      "displayName": "Slow by Warehouse",
      "query": "SELECT \n  LEFT(REGEXP_REPLACE(statement_text, '\\\\s+', ' '), 100) AS query_preview,\n  ROUND(total_duration_ms / 1000.0, 1) AS duration_seconds,\n  ROUND(total_duration_ms / 60000.0, 1) AS duration_minutes,\n  executed_by_user_id AS user,\n  COALESCE(warehouse_name, compute_type) AS warehouse,\n  DATE(start_time) AS run_date,\n  statement_id,\n  CASE \n    WHEN total_duration_ms > 300000 THEN ' Critical (>5min)'\n    WHEN total_duration_ms > 120000 THEN ' High (>2min)'\n    WHEN total_duration_ms > 60000 THEN ' Medium (>1min)'\n    ELSE ' Slow (>30s)'\n  END AS severity\nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time BETWEEN :time_range.min AND :time_range.max\n  AND total_duration_ms > 30000\n  AND statement_text IS NOT NULL\nORDER BY total_duration_ms DESC\nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_slow_query_trend",
      "displayName": "Slow Query Trend",
      "query": "SELECT DATE(start_time) AS day, SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries, ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS slow_pct FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_failed_queries",
      "displayName": "Failed Queries",
      "query": "SELECT statement_id AS query_id, CAST(executed_by_user_id AS STRING) AS user_identity_email, COALESCE(warehouse_name, compute_type) AS warehouse_name, error_message, start_time AS execution_time FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max AND execution_status = 'FAILED' ORDER BY start_time DESC LIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_failed_by_error",
      "displayName": "Failed by Error",
      "query": "SELECT COALESCE(SUBSTRING(error_message, 1, 50), 'Unknown') AS error_category, COUNT(*) AS failure_count FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max AND execution_status = 'FAILED' GROUP BY 1 ORDER BY 2 DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_failed_trend",
      "displayName": "Failed Trend",
      "query": "SELECT DATE(start_time) AS day, SUM(CASE WHEN execution_status = 'FAILED' THEN 1 ELSE 0 END) AS failed_count, ROUND(SUM(CASE WHEN execution_status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_perf",
      "displayName": "Warehouse Performance",
      "query": "SELECT compute_type AS warehouse_name, COUNT(*) AS total_queries, ROUND(AVG(total_duration_ms / 1000.0), 2) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 2) AS p95_duration, ROUND(SUM(CASE WHEN execution_status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate, ROUND(SUM(COALESCE(read_bytes, 0)) / 1073741824.0, 2) AS data_scanned_gb, ROUND(SUM(CASE WHEN COALESCE(spilled_local_bytes, 0) > 0 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS spill_pct, COUNT(DISTINCT executed_by) AS active_users FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY total_queries DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_queries_by_warehouse",
      "displayName": "Queries by Warehouse",
      "query": "SELECT compute_type AS warehouse_name, COUNT(*) AS query_count FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 2 DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_hourly",
      "displayName": "Warehouse Hourly",
      "query": "SELECT HOUR(start_time) AS hour, COUNT(*) AS query_count, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration FROM ${catalog}.${gold_schema}.fact_query_history  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_usage_trend",
      "displayName": "Warehouse Usage Over Time",
      "query": "SELECT DATE(start_time) AS usage_date, COALESCE(w.warehouse_name, f.compute_warehouse_id, 'Unknown') AS warehouse_name, COUNT(*) AS query_count, ROUND(SUM(total_duration_ms) / 1000.0 / 3600, 2) AS compute_hours FROM ${catalog}.${gold_schema}.fact_query_history f LEFT JOIN ${catalog}.${gold_schema}.dim_warehouse w ON f.workspace_id = w.workspace_id AND f.compute_warehouse_id = w.warehouse_id WHERE start_time BETWEEN :time_range.min AND :time_range.max AND f.compute_warehouse_id IS NOT NULL GROUP BY 1, 2 ORDER BY 1, 2",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_type_distribution",
      "displayName": "Usage by Warehouse Type",
      "query": "SELECT COALESCE(w.warehouse_type, 'UNKNOWN') AS warehouse_type, COUNT(*) AS query_count, ROUND(SUM(f.total_duration_ms) / 1000.0 / 3600, 2) AS compute_hours FROM ${catalog}.${gold_schema}.fact_query_history f LEFT JOIN ${catalog}.${gold_schema}.dim_warehouse w ON f.workspace_id = w.workspace_id AND f.compute_warehouse_id = w.warehouse_id WHERE f.start_time BETWEEN :time_range.min AND :time_range.max AND f.compute_warehouse_id IS NOT NULL GROUP BY 1 ORDER BY 2 DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_config_snapshot",
      "displayName": "Warehouse Current Config",
      "query": "SELECT w.warehouse_name, w.warehouse_type, w.warehouse_size, w.min_clusters, w.max_clusters, w.auto_stop_minutes, w.warehouse_channel, w.created_by FROM ${catalog}.${gold_schema}.dim_warehouse w WHERE w.delete_time IS NULL ORDER BY w.warehouse_name"
    },
    {
      "name": "ds_warehouse_long_queries",
      "displayName": "Long-Running Queries by Warehouse",
      "query": "SELECT COALESCE(w.warehouse_name, f.compute_warehouse_id, 'Unknown') AS warehouse_name, COUNT(*) AS total_queries, SUM(CASE WHEN f.total_duration_ms > 30000 THEN 1 ELSE 0 END) AS long_queries_30s, SUM(CASE WHEN f.total_duration_ms > 60000 THEN 1 ELSE 0 END) AS long_queries_60s, SUM(CASE WHEN f.total_duration_ms > 300000 THEN 1 ELSE 0 END) AS long_queries_5m, ROUND(100.0 * SUM(CASE WHEN f.total_duration_ms > 30000 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0), 1) AS long_query_pct FROM ${catalog}.${gold_schema}.fact_query_history f LEFT JOIN ${catalog}.${gold_schema}.dim_warehouse w ON f.workspace_id = w.workspace_id AND f.compute_warehouse_id = w.warehouse_id WHERE f.start_time BETWEEN :time_range.min AND :time_range.max AND f.compute_warehouse_id IS NOT NULL GROUP BY 1 ORDER BY long_query_pct DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_query_source_distribution",
      "displayName": "Query Source Distribution",
      "query": "SELECT CASE WHEN query_source_dashboard_id IS NOT NULL OR query_source_legacy_dashboard_id IS NOT NULL THEN 'Dashboard' WHEN query_source_notebook_id IS NOT NULL THEN 'Notebook' WHEN query_source_job_info IS NOT NULL THEN 'Job' WHEN query_source_sql_query_id IS NOT NULL THEN 'SQL Editor' WHEN query_source_genie_space_id IS NOT NULL THEN 'Genie Space' WHEN query_source_alert_id IS NOT NULL THEN 'Alert' WHEN query_source_pipeline_info IS NOT NULL THEN 'Pipeline' ELSE 'Other/Direct' END AS query_source, COUNT(*) AS query_count, ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER(), 1) AS pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 2 DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_warehouse_cost_ranking",
      "displayName": "Top Warehouses by Cost",
      "query": "SELECT COALESCE(w.warehouse_name, f.compute_warehouse_id, 'Unknown') AS warehouse_name, w.warehouse_type, COUNT(*) AS total_queries, ROUND(SUM(f.total_duration_ms) / 1000.0 / 3600, 2) AS compute_hours, ROUND(SUM(f.read_bytes) / 1024.0 / 1024.0 / 1024.0, 2) AS data_scanned_gb FROM ${catalog}.${gold_schema}.fact_query_history f LEFT JOIN ${catalog}.${gold_schema}.dim_warehouse w ON f.workspace_id = w.workspace_id AND f.compute_warehouse_id = w.warehouse_id WHERE f.start_time BETWEEN :time_range.min AND :time_range.max AND f.compute_warehouse_id IS NOT NULL GROUP BY 1, 2 ORDER BY compute_hours DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_optimization",
      "displayName": "ML: Optimization",
      "query": "WITH slow_patterns AS (\n  SELECT\n    LEFT(REGEXP_REPLACE(statement_text, '\\\\s+', ' '), 80) AS query_pattern,\n    executed_by_user_id AS user,\n    compute_type AS warehouse,\n    ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration_sec,\n    ROUND(MAX(total_duration_ms / 1000.0), 1) AS max_duration_sec,\n    COUNT(*) AS execution_count,\n    MAX(start_time) AS last_run,\n    ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) / 1000.0, 1) AS p95_duration_sec\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND total_duration_ms > 10000\n    AND statement_text IS NOT NULL\n  GROUP BY 1, 2, 3\n  HAVING COUNT(*) >= 3\n)\nSELECT\n  query_pattern,\n  user,\n  warehouse,\n  avg_duration_sec,\n  p95_duration_sec,\n  execution_count,\n  last_run,\n  CASE \n    WHEN p95_duration_sec > 120 THEN ' Critical'\n    WHEN p95_duration_sec > 60 THEN ' High'\n    WHEN p95_duration_sec > 30 THEN ' Medium'\n    ELSE ' Low'\n  END AS severity,\n  CASE \n    WHEN LOWER(query_pattern) LIKE '%select *%' THEN 'Avoid SELECT * - specify columns'\n    WHEN LOWER(query_pattern) LIKE '%cross join%' THEN 'Replace CROSS JOIN with explicit joins'\n    WHEN LOWER(query_pattern) LIKE '%not in%' THEN 'Replace NOT IN with LEFT JOIN / NOT EXISTS'\n    WHEN LOWER(query_pattern) LIKE '%distinct%' THEN 'Review DISTINCT usage - may indicate join issues'\n    WHEN p95_duration_sec > avg_duration_sec * 2 THEN 'High variance - check data skew or caching'\n    WHEN execution_count > 100 THEN 'Frequent query - consider materialized view'\n    ELSE 'Add indexes on filter/join columns'\n  END AS optimization_tip,\n  CONCAT('Query runs ', execution_count, 'x with P95 of ', p95_duration_sec, 's. Last run: ', DATE(last_run)) AS rationale\nFROM slow_patterns\nORDER BY p95_duration_sec DESC\nLIMIT 25"
    },
    {
      "name": "ds_ml_regression",
      "displayName": "ML: Regression",
      "query": "WITH query_baseline AS (\n  SELECT\n    LEFT(REGEXP_REPLACE(statement_text, '\\\\s+', ' '), 60) AS query_pattern,\n    executed_by_user_id AS user,\n    compute_type AS warehouse,\n    ROUND(AVG(CASE WHEN start_time < CURRENT_DATE() - INTERVAL 7 DAYS THEN total_duration_ms END) / 1000.0, 1) AS baseline_avg_sec,\n    ROUND(AVG(CASE WHEN start_time >= CURRENT_DATE() - INTERVAL 7 DAYS THEN total_duration_ms END) / 1000.0, 1) AS recent_avg_sec,\n    COUNT(CASE WHEN start_time < CURRENT_DATE() - INTERVAL 7 DAYS THEN 1 END) AS baseline_runs,\n    COUNT(CASE WHEN start_time >= CURRENT_DATE() - INTERVAL 7 DAYS THEN 1 END) AS recent_runs,\n    MAX(start_time) AS last_run\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND total_duration_ms > 5000\n    AND statement_text IS NOT NULL\n  GROUP BY 1, 2, 3\n  HAVING COUNT(CASE WHEN start_time < CURRENT_DATE() - INTERVAL 7 DAYS THEN 1 END) >= 3\n    AND COUNT(CASE WHEN start_time >= CURRENT_DATE() - INTERVAL 7 DAYS THEN 1 END) >= 2\n)\nSELECT\n  query_pattern,\n  user,\n  warehouse,\n  baseline_avg_sec,\n  recent_avg_sec,\n  ROUND((recent_avg_sec - baseline_avg_sec) * 100.0 / NULLIF(baseline_avg_sec, 0), 1) AS regression_pct,\n  CASE \n    WHEN (recent_avg_sec - baseline_avg_sec) / NULLIF(baseline_avg_sec, 0) > 1.0 THEN ' Major regression (>100%)'\n    WHEN (recent_avg_sec - baseline_avg_sec) / NULLIF(baseline_avg_sec, 0) > 0.5 THEN ' Significant (>50%)'\n    WHEN (recent_avg_sec - baseline_avg_sec) / NULLIF(baseline_avg_sec, 0) > 0.25 THEN ' Moderate (>25%)'\n    ELSE ' Minor'\n  END AS severity,\n  CASE \n    WHEN recent_runs > baseline_runs * 2 THEN 'Increased query frequency'\n    WHEN recent_avg_sec > baseline_avg_sec * 2 THEN 'Data volume growth likely'\n    WHEN LOWER(query_pattern) LIKE '%join%' THEN 'Check join statistics / table growth'\n    ELSE 'Resource contention or config change'\n  END AS root_cause,\n  CONCAT('Baseline: ', baseline_avg_sec, 's (', baseline_runs, ' runs)  Recent: ', recent_avg_sec, 's (', recent_runs, ' runs). Last: ', DATE(last_run)) AS rationale,\n  'Review query plan and table statistics. Consider adding indexes or updating stats.' AS recommended_action\nFROM query_baseline\nWHERE recent_avg_sec > baseline_avg_sec * 1.25\nORDER BY (recent_avg_sec - baseline_avg_sec) DESC\nLIMIT 20"
    },
    {
      "name": "ds_ml_warehouse",
      "displayName": "ML: Warehouse",
      "query": "WITH warehouse_stats AS (\n  SELECT\n    compute_type AS warehouse,\n    COUNT(*) AS total_queries,\n    COUNT(DISTINCT executed_by_user_id) AS unique_users,\n    ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration_sec,\n    ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) / 1000.0, 1) AS p95_duration_sec,\n    SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries,\n    MAX(start_time) AS last_query_time,\n    ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS slow_query_pct\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS\n  GROUP BY 1\n  HAVING COUNT(*) >= 10\n)\nSELECT\n  warehouse,\n  total_queries,\n  unique_users,\n  avg_duration_sec,\n  p95_duration_sec,\n  slow_queries,\n  slow_query_pct,\n  CASE \n    WHEN slow_query_pct > 20 THEN ' Scale Up Required'\n    WHEN slow_query_pct > 10 THEN ' Consider Scaling'\n    WHEN slow_query_pct > 5 THEN ' Monitor Closely'\n    WHEN slow_query_pct < 1 AND total_queries < 100 THEN ' Consider Scale Down'\n    ELSE ' Optimal'\n  END AS recommendation,\n  CASE \n    WHEN slow_query_pct > 20 THEN CONCAT(slow_query_pct, '% queries slow - upgrade to larger cluster size')\n    WHEN slow_query_pct > 10 THEN CONCAT(slow_query_pct, '% queries slow - review query patterns or scale up')\n    WHEN slow_query_pct > 5 THEN CONCAT(slow_query_pct, '% queries slow - optimize queries or add resources during peak')\n    WHEN slow_query_pct < 1 AND total_queries < 100 THEN 'Low utilization - consider smaller size or auto-suspend'\n    ELSE 'Performance is healthy'\n  END AS rationale,\n  CONCAT(total_queries, ' queries from ', unique_users, ' users. P95: ', p95_duration_sec, 's. Last activity: ', DATE(last_query_time)) AS evidence,\n  CASE \n    WHEN slow_query_pct > 20 THEN 'Increase cluster size by 1 tier or enable auto-scaling'\n    WHEN slow_query_pct > 10 THEN 'Review top slow queries for optimization opportunities'\n    WHEN slow_query_pct < 1 AND total_queries < 100 THEN 'Reduce cluster size or increase auto-suspend timeout'\n    ELSE 'No action needed'\n  END AS recommended_action\nFROM warehouse_stats\nORDER BY slow_query_pct DESC, total_queries DESC\nLIMIT 15"
    },
    {
      "name": "ds_monitor_latest",
      "displayName": "Monitor: Latest",
      "query": "SELECT \n  COALESCE(query_count, 0) AS total_queries,\n  ROUND(COALESCE(avg_duration_sec, 0), 2) AS avg_duration,\n  ROUND(COALESCE(sla_breach_rate, 0) * 100, 2) AS slow_query_rate,\n  0 AS avg_cpu,\n  0 AS avg_memory,\n  0 AS total_nodes,\n  0 AS avg_io_wait\nFROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start BETWEEN :time_range.min AND :time_range.max\nORDER BY window.start DESC\nLIMIT 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_trend",
      "displayName": "Monitor: Trend",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  ROUND(COALESCE(avg_duration_sec, 0), 2) AS avg_duration,\n  ROUND(COALESCE(p95_duration_sec, 0), 2) AS p95_duration\nFROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start BETWEEN :time_range.min AND :time_range.max\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_volume",
      "displayName": "Monitor: Volume",
      "query": "SELECT \n  DATE(start_time) AS window_start,\n  COUNT(*) AS total_queries,\n  COUNT(DISTINCT executed_by_user_id) AS unique_users\nFROM ${catalog}.${gold_schema}.fact_query_history\nWHERE start_time BETWEEN :time_range.min AND :time_range.max\nGROUP BY 1\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "WITH daily_metrics AS (\n  SELECT\n    DATE(start_time) AS day,\n    PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) AS p95_duration,\n    COUNT(*) AS query_count\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY 1\n),\nwith_prev AS (\n  SELECT\n    day,\n    p95_duration,\n    query_count,\n    LAG(p95_duration) OVER (ORDER BY day) AS prev_p95,\n    LAG(query_count) OVER (ORDER BY day) AS prev_count\n  FROM daily_metrics\n)\nSELECT\n  day AS window_start,\n  ROUND((p95_duration - prev_p95) * 100.0 / NULLIF(prev_p95, 0), 1) AS duration_drift,\n  ROUND((query_count - prev_count) * 100.0 / NULLIF(prev_count, 0), 1) AS volume_drift,\n  0 AS cpu_drift,\n  0 AS memory_drift\nFROM with_prev\nWHERE prev_p95 IS NOT NULL\nORDER BY day",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_detailed",
      "displayName": "Monitor: Detailed",
      "query": "SELECT \n  DATE(start_time) AS window_start,\n  COUNT(*) AS total_queries,\n  ROUND(AVG(total_duration_ms / 1000.0), 2) AS avg_duration,\n  ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) / 1000.0, 2) AS p95_duration,\n  ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS slow_query_rate,\n  ROUND(SUM(CASE WHEN error_message IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 3) AS failure_rate,\n  0 AS total_nodes,\n  0 AS avg_cpu,\n  0 AS p95_cpu,\n  0 AS avg_memory,\n  0 AS avg_io_wait\nFROM ${catalog}.${gold_schema}.fact_query_history\nWHERE start_time BETWEEN :time_range.min AND :time_range.max\nGROUP BY 1\nORDER BY 1 DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_drift_investigation",
      "displayName": "Drift Investigation",
      "query": "WITH daily_p95 AS (\n  SELECT\n    DATE(start_time) AS day,\n    PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) AS p95_today\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY 1\n),\nwith_drift AS (\n  SELECT\n    day,\n    p95_today,\n    LAG(p95_today) OVER (ORDER BY day) AS p95_yesterday,\n    ROUND((p95_today - LAG(p95_today) OVER (ORDER BY day)) * 100.0 / NULLIF(LAG(p95_today) OVER (ORDER BY day), 0), 1) AS drift_pct\n  FROM daily_p95\n),\nhigh_drift_days AS (\n  SELECT day FROM with_drift WHERE ABS(drift_pct) > 50\n),\ncontributors AS (\n  SELECT\n    DATE(q.start_time) AS spike_date,\n    LEFT(REGEXP_REPLACE(q.statement_text, '\\\\s+', ' '), 60) AS query_pattern,\n    q.executed_by_user_id AS user,\n    COALESCE(q.warehouse_name, q.compute_type) AS warehouse,\n    COUNT(*) AS executions,\n    ROUND(AVG(q.total_duration_ms / 1000.0), 1) AS avg_duration_sec,\n    ROUND(MAX(q.total_duration_ms / 1000.0), 1) AS max_duration_sec,\n    ROUND(SUM(q.total_duration_ms / 1000.0), 0) AS total_time_sec\n  FROM ${catalog}.${gold_schema}.fact_query_history q\n  INNER JOIN high_drift_days h ON DATE(q.start_time) = h.day\n  WHERE q.total_duration_ms > 10000\n  GROUP BY 1, 2, 3, 4\n)\nSELECT\n  spike_date,\n  query_pattern,\n  user,\n  warehouse,\n  executions,\n  avg_duration_sec,\n  max_duration_sec,\n  total_time_sec,\n  CASE \n    WHEN total_time_sec > 3600 THEN ' Major Impact'\n    WHEN total_time_sec > 600 THEN ' High Impact'\n    WHEN total_time_sec > 60 THEN ' Medium Impact'\n    ELSE ' Low Impact'\n  END AS impact,\n  CONCAT('Query ran ', executions, 'x, total ', ROUND(total_time_sec/60, 1), ' min on spike day') AS investigation_note\nFROM contributors\nORDER BY spike_date DESC, total_time_sec DESC\nLIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_utilization",
      "displayName": "KPI: Utilization",
      "query": "SELECT CONCAT(ROUND(AVG(cpu_user_percent + cpu_system_percent), 1), '%') AS avg_cpu, CONCAT(ROUND(AVG(mem_used_percent), 1), '%') AS avg_memory, FORMAT_NUMBER(COUNT(DISTINCT cluster_id), 0) AS total_nodes, FORMAT_NUMBER(COUNT(DISTINCT cluster_id), 0) AS total_clusters FROM ${catalog}.${gold_schema}.fact_node_timeline  WHERE start_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_underutilized",
      "displayName": "KPI: Underutilized",
      "query": "WITH cluster_util AS (SELECT cluster_id, AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1) SELECT CONCAT(ROUND(SUM(CASE WHEN avg_cpu < 30 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS underutilized_pct FROM cluster_util",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_overutilized",
      "displayName": "KPI: Overutilized",
      "query": "WITH cluster_util AS (SELECT cluster_id, AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1) SELECT CONCAT(ROUND(SUM(CASE WHEN avg_cpu > 80 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS overutilized_pct FROM cluster_util",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_cpu_trend",
      "displayName": "CPU Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(cpu_user_percent + cpu_system_percent), 1) AS avg_cpu, ROUND(MAX(cpu_user_percent + cpu_system_percent), 1) AS peak_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_memory_trend",
      "displayName": "Memory Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(mem_used_percent), 1) AS avg_memory, ROUND(MAX(mem_used_percent), 1) AS peak_memory FROM ${catalog}.${gold_schema}.fact_node_timeline  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_disk_io_trend",
      "displayName": "Disk I/O Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(cpu_wait_percent), 1) AS avg_disk_wait, ROUND(MAX(cpu_wait_percent), 1) AS peak_disk_wait FROM ${catalog}.${gold_schema}.fact_node_timeline  WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_underutilized_clusters",
      "displayName": "Underutilized Clusters",
      "query": "WITH cluster_stats AS (SELECT n.cluster_id, MAX(c.cluster_name) AS cluster_name, MAX(w.workspace_name) AS workspace_name, AVG(n.cpu_user_percent + n.cpu_system_percent) AS avg_cpu, AVG(n.mem_used_percent) AS avg_memory FROM ${catalog}.${gold_schema}.fact_node_timeline n LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON n.cluster_id = c.cluster_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON n.workspace_id = w.workspace_id WHERE n.start_time BETWEEN :time_range.min AND :time_range.max GROUP BY n.cluster_id) SELECT COALESCE(cluster_name, cluster_id) AS cluster_name, workspace_name, ROUND(avg_cpu, 1) AS avg_cpu, ROUND(avg_memory, 1) AS avg_memory, 0.00 AS estimated_cost, ROUND((30 - avg_cpu) / 30 * 100, 2) AS potential_savings FROM cluster_stats WHERE avg_cpu < 30 ORDER BY avg_cpu ASC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_overutilized_clusters",
      "displayName": "Overutilized Clusters",
      "query": "WITH cluster_stats AS (SELECT n.cluster_id, MAX(c.cluster_name) AS cluster_name, MAX(w.workspace_name) AS workspace_name, AVG(n.cpu_user_percent + n.cpu_system_percent) AS avg_cpu, MAX(n.cpu_user_percent + n.cpu_system_percent) AS peak_cpu, AVG(n.mem_used_percent) AS avg_memory FROM ${catalog}.${gold_schema}.fact_node_timeline n LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON n.cluster_id = c.cluster_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON n.workspace_id = w.workspace_id WHERE n.start_time BETWEEN :time_range.min AND :time_range.max GROUP BY n.cluster_id) SELECT COALESCE(cluster_name, cluster_id) AS cluster_name, workspace_name, ROUND(avg_cpu, 1) AS avg_cpu, ROUND(peak_cpu, 1) AS peak_cpu, ROUND(avg_memory, 1) AS avg_memory FROM cluster_stats WHERE avg_cpu > 80 ORDER BY avg_cpu DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_high_memory_swap",
      "displayName": "High Memory Swap",
      "query": "WITH cluster_stats AS (SELECT n.cluster_id, MAX(c.cluster_name) AS cluster_name, AVG(n.mem_used_percent) AS avg_memory, MAX(n.mem_used_percent) AS peak_memory, SUM(CASE WHEN n.mem_used_percent > 90 THEN 1 ELSE 0 END) AS swap_events FROM ${catalog}.${gold_schema}.fact_node_timeline n LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON n.cluster_id = c.cluster_id WHERE n.start_time BETWEEN :time_range.min AND :time_range.max GROUP BY n.cluster_id) SELECT COALESCE(cluster_name, cluster_id) AS cluster_name, ROUND(avg_memory, 1) AS avg_memory, ROUND(peak_memory, 1) AS peak_memory, swap_events FROM cluster_stats WHERE peak_memory > 90 ORDER BY swap_events DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_high_io_wait",
      "displayName": "High I/O Wait",
      "query": "WITH cluster_stats AS (SELECT n.cluster_id, MAX(c.cluster_name) AS cluster_name, MAX(w.workspace_name) AS workspace_name, AVG(n.cpu_wait_percent) AS avg_io_wait, MAX(n.cpu_wait_percent) AS peak_io_wait FROM ${catalog}.${gold_schema}.fact_node_timeline n LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON n.cluster_id = c.cluster_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON n.workspace_id = w.workspace_id WHERE n.start_time BETWEEN :time_range.min AND :time_range.max GROUP BY n.cluster_id) SELECT COALESCE(cluster_name, cluster_id) AS cluster_name, workspace_name, ROUND(avg_io_wait, 1) AS avg_io_wait, ROUND(peak_io_wait, 1) AS peak_io_wait FROM cluster_stats WHERE avg_io_wait > 10 ORDER BY avg_io_wait DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_utilization_distribution",
      "displayName": "Utilization Distribution",
      "query": "WITH cluster_util AS (SELECT cluster_id, AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu FROM ${catalog}.${gold_schema}.fact_node_timeline WHERE start_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1) SELECT CASE WHEN avg_cpu < 10 THEN '0-10%' WHEN avg_cpu < 20 THEN '10-20%' WHEN avg_cpu < 30 THEN '20-30%' WHEN avg_cpu < 50 THEN '30-50%' WHEN avg_cpu < 80 THEN '50-80%' ELSE '>80%' END AS utilization_bucket, COUNT(*) AS cluster_count FROM cluster_util GROUP BY 1 ORDER BY MIN(avg_cpu)",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_rightsizing_recommendations",
      "displayName": "Right-Sizing Recommendations",
      "query": "WITH warehouse_usage AS (\n  SELECT\n    COALESCE(warehouse_name, compute_type, 'Unknown') AS cluster_name,\n    COUNT(*) AS total_queries,\n    ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration_sec,\n    ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) / 1000.0, 1) AS p95_duration_sec,\n    SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries,\n    COUNT(DISTINCT executed_by_user_id) AS unique_users\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY 1\n  HAVING COUNT(*) >= 10\n),\ncost_data AS (\n  SELECT\n    COALESCE(warehouse_name, 'All Warehouses') AS wh_name,\n    ROUND(SUM(list_cost), 2) AS total_cost_30d\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY 1\n)\nSELECT\n  w.cluster_name,\n  CASE \n    WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) > 20 THEN 'Undersized'\n    WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) < 2 AND w.total_queries < 100 THEN 'Oversized'\n    ELSE 'Current'\n  END AS current_size,\n  CASE \n    WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) > 20 THEN ' Scale Up'\n    WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) < 2 AND w.total_queries < 100 THEN ' Scale Down'\n    ELSE ' Optimal'\n  END AS recommended_size,\n  ROUND(w.slow_queries * 100.0 / NULLIF(w.total_queries, 0), 1) AS avg_cpu,\n  ROUND(COALESCE(c.total_cost_30d, 0) * CASE WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) < 2 AND w.total_queries < 100 THEN 0.3 ELSE 0 END, 2) AS potential_savings\nFROM warehouse_usage w\nLEFT JOIN cost_data c ON w.cluster_name = c.wh_name\nORDER BY potential_savings DESC, w.slow_queries DESC\nLIMIT 15"
    },
    {
      "name": "ds_low_cpu_high_cost",
      "displayName": "Low CPU High Cost",
      "query": "WITH job_metrics AS (\n  SELECT\n    j.job_id,\n    COALESCE(j.name, CAST(j.job_id AS STRING)) AS job_name,\n    COALESCE(w.workspace_name, CAST(j.workspace_id AS STRING)) AS workspace_name,\n    COUNT(*) AS total_runs,\n    ROUND(AVG(f.run_duration_seconds), 0) AS avg_duration_sec,\n    SUM(CASE WHEN f.termination_code = 'SUCCESS' THEN 1 ELSE 0 END) AS successful_runs\n  FROM ${catalog}.${gold_schema}.dim_job j\n  LEFT JOIN ${catalog}.${gold_schema}.fact_job_run_timeline f ON j.job_id = f.job_id AND j.workspace_id = f.workspace_id\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON j.workspace_id = w.workspace_id\n  WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, w.workspace_name))\n  GROUP BY 1, 2, 3\n  HAVING COUNT(*) >= 3\n),\njob_costs AS (\n  SELECT\n    j.job_id,\n    ROUND(SUM(u.list_cost), 2) AS cost_30d\n  FROM ${catalog}.${gold_schema}.fact_usage u\n  JOIN ${catalog}.${gold_schema}.dim_job j ON u.workspace_id = j.workspace_id\n  WHERE u.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY 1\n)\nSELECT\n  m.job_name,\n  m.workspace_name,\n  ROUND(m.successful_runs * 100.0 / NULLIF(m.total_runs, 0), 1) AS avg_cpu,\n  COALESCE(c.cost_30d, 0) AS cost_30d,\n  ROUND(COALESCE(c.cost_30d, 0) * 0.3, 2) AS potential_savings\nFROM job_metrics m\nLEFT JOIN job_costs c ON m.job_id = c.job_id\nWHERE m.successful_runs * 100.0 / NULLIF(m.total_runs, 0) > 90\n  AND COALESCE(c.cost_30d, 0) > 10\nORDER BY c.cost_30d DESC NULLS LAST\nLIMIT 15",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_high_memory_jobs",
      "displayName": "High Memory Jobs",
      "query": "WITH job_duration AS (\n  SELECT\n    COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name,\n    COUNT(*) AS total_runs,\n    ROUND(AVG(f.run_duration_seconds), 0) AS avg_duration_sec,\n    ROUND(MAX(f.run_duration_seconds), 0) AS max_duration_sec,\n    ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY f.run_duration_seconds), 0) AS p95_duration_sec,\n    SUM(f.run_duration_seconds) AS total_time_sec\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id\n  WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND f.run_duration_seconds IS NOT NULL\n    AND f.run_duration_seconds > 0\n  GROUP BY 1\n  HAVING COUNT(*) >= 3\n)\nSELECT\n  job_name,\n  ROUND(avg_duration_sec / 60.0, 1) AS avg_memory,\n  ROUND(max_duration_sec / 60.0, 1) AS peak_memory,\n  CASE \n    WHEN max_duration_sec > avg_duration_sec * 3 THEN ' High variance - check for memory pressure'\n    WHEN p95_duration_sec > 3600 THEN ' Long-running - consider optimization'\n    WHEN total_time_sec > 86400 THEN ' Heavy workload - review resource allocation'\n    ELSE ' Normal'\n  END AS recommendation\nFROM job_duration\nWHERE p95_duration_sec > 300\nORDER BY total_time_sec DESC\nLIMIT 15"
    },
    {
      "name": "ds_savings_opportunity",
      "displayName": "Savings Opportunity",
      "query": "WITH warehouse_analysis AS (\n  SELECT\n    COALESCE(warehouse_name, compute_type, 'Unknown') AS warehouse,\n    COUNT(*) AS total_queries,\n    SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY 1\n),\ncost_by_warehouse AS (\n  SELECT\n    COALESCE(warehouse_name, compute_type, 'Unknown') AS warehouse,\n    SUM(list_cost) AS total_cost\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY 1\n),\ncategorized AS (\n  SELECT\n    CASE \n      WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) < 2 AND w.total_queries < 100 THEN 'Oversized Warehouses'\n      WHEN w.slow_queries * 100.0 / NULLIF(w.total_queries, 0) > 20 THEN 'Undersized Warehouses'\n      ELSE 'Optimally Sized'\n    END AS category,\n    COALESCE(c.total_cost, 0) AS cost,\n    1 AS cluster_count\n  FROM warehouse_analysis w\n  LEFT JOIN cost_by_warehouse c ON w.warehouse = c.warehouse\n)\nSELECT\n  category,\n  ROUND(SUM(CASE WHEN category = 'Oversized Warehouses' THEN cost * 0.3 ELSE 0 END), 2) AS savings,\n  COUNT(*) AS clusters\nFROM categorized\nGROUP BY category\nORDER BY savings DESC"
    },
    {
      "name": "ds_ml_capacity_predictions",
      "displayName": "ML: Capacity Predictions",
      "query": "SELECT\n  warehouse_id AS cluster_name,\n  ROUND(prediction * 10, 0) AS current_workers,\n  ROUND(prediction * 12, 0) AS recommended_workers,\n  ROUND(prediction, 2) AS confidence\nFROM ${catalog}.${feature_schema}.cluster_capacity_predictions\nWHERE scored_at >= CURRENT_DATE() - INTERVAL 7 DAYS\nORDER BY prediction DESC\nLIMIT 30"
    },
    {
      "name": "ds_ml_rightsizing",
      "displayName": "ML: Right-Sizing",
      "query": "SELECT\n  warehouse_id AS cluster_name,\n  'Standard' AS current_size,\n  CASE WHEN prediction > 0.5 THEN 'Optimized' ELSE 'Standard' END AS recommended,\n  ROUND(prediction * 500, 2) AS potential_savings\nFROM ${catalog}.${feature_schema}.cluster_capacity_predictions\nWHERE prediction > 0.3\nAND scored_at >= CURRENT_DATE() - INTERVAL 7 DAYS\nORDER BY prediction DESC\nLIMIT 20"
    },
    {
      "name": "ds_ml_dbr_risk",
      "displayName": "ML: DBR Risk",
      "query": "SELECT\n  job_id AS job_name,\n  '13.3 LTS' AS current_dbr,\n  '14.3 LTS' AS target_dbr,\n  CASE \n    WHEN prediction > 0.7 THEN 'HIGH'\n    WHEN prediction > 0.4 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS risk_level,\n  ROUND(prediction * 100, 1) AS risk_score\nFROM ${catalog}.${feature_schema}.dbr_migration_predictions\nWHERE scored_at >= CURRENT_DATE() - INTERVAL 7 DAYS\nORDER BY prediction DESC\nLIMIT 30"
    },
    {
      "name": "ds_monitor_cpu_trend",
      "displayName": "Monitor: CPU Trend",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  ROUND(COALESCE(avg_cpu_user_pct, 0), 1) AS avg_cpu,\n  ROUND(COALESCE(max_cpu_user_pct, 0), 1) AS p95_cpu\nFROM ${catalog}.${gold_schema}_monitoring.fact_node_timeline_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start >= :time_range.min\n  AND window.end <= :time_range.max\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_memory_trend",
      "displayName": "Monitor: Memory Trend",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  ROUND(COALESCE(avg_memory_pct, 0), 1) AS avg_memory,\n  ROUND(COALESCE(max_memory_pct, 0), 1) AS p95_memory\nFROM ${catalog}.${gold_schema}_monitoring.fact_node_timeline_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start >= :time_range.min\n  AND window.end <= :time_range.max\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_expensive",
      "displayName": "Most Expensive Jobs",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n  COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, \n  COUNT(DISTINCT f.usage_metadata_job_run_id) AS runs, \n  ROUND(SUM(f.list_cost), 2) AS total_cost, \n  MAX(f.identity_metadata_run_as) AS owner,\n  MAX(DATE(f.usage_date)) AS last_run\nFROM ${catalog}.${gold_schema}.fact_usage f \nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \nLEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id \nWHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n  AND f.usage_metadata_job_id IS NOT NULL \nGROUP BY 1, 2 \nORDER BY total_cost DESC \nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_cost_change",
      "displayName": "Jobs with Highest Cost Change",
      "query": "WITH job_spend AS (\n  SELECT \n    COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n    SUM(CASE WHEN f.usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS THEN f.list_cost ELSE 0 END) AS last_7d, \n    SUM(CASE WHEN f.usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS AND f.usage_date < CURRENT_DATE() - INTERVAL 7 DAYS THEN f.list_cost ELSE 0 END) AS prev_7d \n  FROM ${catalog}.${gold_schema}.fact_usage f \n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \n  WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n    AND f.usage_metadata_job_id IS NOT NULL \n  GROUP BY 1\n) \nSELECT \n  job_name, \n  ROUND(last_7d, 2) AS last_7d, \n  ROUND(prev_7d, 2) AS prev_7d, \n  ROUND(last_7d - prev_7d, 2) AS growth,\n  ROUND(100 * (last_7d - prev_7d) / NULLIF(prev_7d, 0), 1) AS growth_pct \nFROM job_spend \nWHERE prev_7d > 0 OR last_7d > 0\nORDER BY (last_7d - prev_7d) DESC \nLIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_failure_cost",
      "displayName": "Job Failure Cost Analysis",
      "query": "WITH job_runs AS (\n  SELECT \n    f.workspace_id, \n    f.usage_metadata_job_id AS job_id, \n    f.usage_metadata_job_run_id AS run_id, \n    SUM(f.list_cost) AS run_cost \n  FROM ${catalog}.${gold_schema}.fact_usage f \n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n    AND f.usage_metadata_job_run_id IS NOT NULL \n  GROUP BY 1, 2, 3\n), run_status AS (\n  SELECT \n    jr.workspace_id,\n    jr.job_id,\n    jr.run_id,\n    jr.run_cost,\n    CASE WHEN t.result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END AS is_success\n  FROM job_runs jr \n  LEFT JOIN ${catalog}.${gold_schema}.fact_job_run_timeline t \n    ON jr.workspace_id = t.workspace_id AND jr.job_id = t.job_id AND jr.run_id = t.run_id\n), job_failure_costs AS (\n  SELECT \n    rs.workspace_id,\n    rs.job_id,\n    SUM(CASE WHEN is_success = 0 THEN run_cost ELSE 0 END) AS failure_cost,\n    SUM(CASE WHEN is_success = 0 THEN 1 ELSE 0 END) AS failures,\n    COUNT(*) AS total_runs\n  FROM run_status rs\n  GROUP BY 1, 2\n  HAVING SUM(CASE WHEN is_success = 0 THEN 1 ELSE 0 END) > 0\n)\nSELECT \n  COALESCE(j.name, CAST(jfc.job_id AS STRING)) AS job_name,\n  ROUND(jfc.failure_cost, 2) AS failure_cost,\n  jfc.failures,\n  jfc.total_runs,\n  ROUND(100.0 * (jfc.total_runs - jfc.failures) / jfc.total_runs, 1) AS success_rate\nFROM job_failure_costs jfc\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON jfc.workspace_id = j.workspace_id AND jfc.job_id = j.job_id\nORDER BY failure_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_ap_clusters",
      "displayName": "Jobs on All-Purpose Clusters",
      "query": "WITH job_clusters AS (\n  SELECT \n    t.workspace_id,\n    t.job_id,\n    EXPLODE(COALESCE(t.compute_ids, ARRAY())) AS cluster_id,\n    COUNT(DISTINCT t.run_id) AS task_runs\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline t\n  WHERE t.run_date BETWEEN :time_range.min AND :time_range.max\n    AND t.compute_ids IS NOT NULL\n    AND SIZE(t.compute_ids) > 0\n  GROUP BY 1, 2, 3\n), ap_jobs AS (\n  SELECT \n    jc.workspace_id,\n    jc.job_id,\n    c.cluster_name,\n    jc.task_runs\n  FROM job_clusters jc\n  JOIN ${catalog}.${gold_schema}.dim_cluster c \n    ON jc.cluster_id = c.cluster_id\n    AND c.cluster_source = 'UI'\n)\nSELECT \n  COALESCE(j.name, CAST(ap.job_id AS STRING)) AS job_name,\n  ap.cluster_name,\n  ap.task_runs,\n  ROUND(COALESCE(SUM(f.list_cost), 0), 2) AS total_cost,\n  COALESCE(j.run_as, 'Unknown') AS owner\nFROM ap_jobs ap\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON ap.workspace_id = j.workspace_id AND ap.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.fact_usage f \n  ON ap.workspace_id = f.workspace_id \n  AND ap.job_id = f.usage_metadata_job_id\n  AND f.usage_date BETWEEN :time_range.min AND :time_range.max\nGROUP BY 1, 2, 3, 5\nORDER BY total_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_legacy_count",
      "query": "WITH exploded AS (SELECT f.job_id, explode(COALESCE(f.compute_ids, ARRAY())) AS cluster_id FROM ${catalog}.${gold_schema}.fact_job_run_timeline f WHERE f.run_date BETWEEN :time_range.min AND :time_range.max) SELECT COUNT(DISTINCT e.job_id) AS count FROM exploded e LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON e.cluster_id = c.cluster_id AND CAST(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1) AS INT) < 15",
      "displayName": "Legacy Count",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_serverless_adoption",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN product_features_is_serverless THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS serverless_pct FROM ${catalog}.${gold_schema}.fact_usage  WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "displayName": "Serverless Adoption",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_current_dbr",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN TRY_CAST(NULLIF(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1), '') AS INT) >= 15 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS current_pct FROM ${catalog}.${gold_schema}.dim_cluster c WHERE c.delete_time IS NULL",
      "displayName": "Current Dbr"
    },
    {
      "name": "ds_dbr_dist",
      "query": "WITH exploded AS (SELECT f.job_id, explode(COALESCE(f.compute_ids, ARRAY())) AS cluster_id FROM ${catalog}.${gold_schema}.fact_job_run_timeline f WHERE f.run_date BETWEEN :time_range.min AND :time_range.max) SELECT REGEXP_EXTRACT(c.dbr_version, '(\\\\d+\\\\.\\\\d+)') AS dbr_version, COUNT(DISTINCT e.job_id) AS job_count, CASE WHEN CAST(SPLIT(REGEXP_EXTRACT(c.dbr_version, '(\\\\d+\\\\.\\\\d+)'), '\\\\.')[0] AS INT) >= 15 THEN 'Current' WHEN CAST(SPLIT(REGEXP_EXTRACT(c.dbr_version, '(\\\\d+\\\\.\\\\d+)'), '\\\\.')[0] AS INT) >= 13 THEN 'LTS' ELSE 'Legacy' END AS version_status FROM exploded e LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON e.cluster_id = c.cluster_id AND c.dbr_version IS NOT NULL GROUP BY REGEXP_EXTRACT(c.dbr_version, '(\\\\d+\\\\.\\\\d+)') ORDER BY dbr_version DESC",
      "displayName": "Dbr Dist",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_compute_type",
      "query": "SELECT CASE WHEN product_features_is_serverless THEN 'Serverless' ELSE 'Classic' END AS compute_type, COUNT(DISTINCT usage_metadata_job_id) AS job_count, ROUND(SUM(list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage  WHERE usage_date BETWEEN :time_range.min AND :time_range.max AND usage_metadata_job_id IS NOT NULL GROUP BY CASE WHEN product_features_is_serverless THEN 'Serverless' ELSE 'Classic' END",
      "displayName": "Compute Type",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_legacy_jobs",
      "query": "WITH exploded AS (SELECT f.job_id, f.workspace_id, f.period_end_time, explode(COALESCE(f.compute_ids, ARRAY())) AS cluster_id FROM ${catalog}.${gold_schema}.fact_job_run_timeline f WHERE f.run_date BETWEEN :time_range.min AND :time_range.max) SELECT COALESCE(j.name, e.job_id) AS job_name, w.workspace_name, c.dbr_version, MAX(e.period_end_time) AS last_run FROM exploded e LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON e.job_id = j.job_id AND e.workspace_id = j.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON e.workspace_id = w.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_cluster c ON e.cluster_id = c.cluster_id AND TRY_CAST(NULLIF(REGEXP_EXTRACT(COALESCE(c.dbr_version, '15'), '^(\\\\d+)', 1), '') AS INT) < 15 GROUP BY COALESCE(j.name, e.job_id), w.workspace_name, c.dbr_version ORDER BY last_run DESC LIMIT 30",
      "displayName": "Legacy Jobs",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "ds_select_workspace",
      "query": "SELECT DISTINCT COALESCE(workspace_name, CAST(workspace_id AS STRING)) AS workspace_name FROM ${catalog}.${gold_schema}.dim_workspace ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_warehouse_type",
      "displayName": "ds_select_warehouse_type",
      "query": "SELECT 'All' AS warehouse_type UNION ALL SELECT 'CLASSIC' UNION ALL SELECT 'PRO' UNION ALL SELECT 'SERVERLESS'",
      "parameters": []
    },
    {
      "name": "ds_monitor_performance_aggregate",
      "displayName": "Performance Aggregate Metrics",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  COALESCE(query_count, 0) AS total_queries,\n  COALESCE(successful_queries, 0) AS successful_queries,\n  COALESCE(failed_queries, 0) AS failed_queries,\n  ROUND(COALESCE(avg_duration_sec, 0), 2) AS avg_duration_sec,\n  ROUND(COALESCE(p50_duration_sec, 0), 2) AS p50_duration_sec,\n  ROUND(COALESCE(p95_duration_sec, 0), 2) AS p95_duration_sec\nFROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND window.start >= :monitor_time_start\n  AND window.end <= :monitor_time_end\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_performance_derived",
      "displayName": "Performance Derived KPIs",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  ROUND(COALESCE(query_success_rate, 100), 1) AS query_success_rate,\n  ROUND(COALESCE(spill_rate, 0) * 100, 2) AS spill_rate\nFROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND window.start >= :monitor_time_start\n  AND window.end <= :monitor_time_end\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_performance_slice_keys",
      "displayName": "Performance Slice Keys",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_key\n  FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_key IS NOT NULL\n)\nSELECT 'No Slice' AS slice_key\nUNION ALL\nSELECT slice_key FROM profile_metrics\nORDER BY slice_key",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_performance_slice_values",
      "displayName": "Performance Slice Values",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_value, COALESCE(slice_key, 'No Slice') AS sk\n  FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_value IS NOT NULL\n)\nSELECT 'No Slice' AS slice_value\nUNION ALL\nSELECT slice_value FROM profile_metrics WHERE sk = :monitor_slice_key\nORDER BY slice_value",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_low_cpu",
      "displayName": "Jobs with Low CPU Utilization",
      "query": "WITH job_cost AS (\n  SELECT\n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_cluster_id AS cluster_id,\n    SUM(f.list_cost) AS list_cost,\n    FIRST(f.identity_metadata_run_as, TRUE) AS run_as\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.sku_name LIKE '%JOBS%'\n    AND f.sku_name NOT LIKE '%SERVERLESS%'\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_date BETWEEN :time_range.min AND :time_range.max\n  GROUP BY f.workspace_id, f.usage_metadata_job_id, f.usage_metadata_cluster_id\n),\njob_util AS (\n  SELECT\n    jc.workspace_id,\n    jc.job_id,\n    ROUND(AVG(n.cpu_user_percent + n.cpu_system_percent), 1) AS avg_cpu,\n    ROUND(MAX(n.cpu_user_percent + n.cpu_system_percent), 1) AS peak_cpu,\n    ROUND(AVG(n.mem_used_percent), 1) AS avg_memory,\n    ROUND(MAX(n.mem_used_percent), 1) AS peak_memory,\n    SUM(jc.list_cost) AS total_cost\n  FROM job_cost jc\n  JOIN ${catalog}.${gold_schema}.fact_node_timeline n\n    ON jc.cluster_id = n.cluster_id\n    AND n.start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY jc.workspace_id, jc.job_id\n)\nSELECT\n  COALESCE(j.name, ju.job_id) AS job_name,\n  ju.workspace_id,\n  ju.job_id,\n  ju.avg_cpu,\n  ju.peak_cpu,\n  ju.avg_memory,\n  ju.peak_memory,\n  ROUND(ju.total_cost, 2) AS total_cost,\n  ROUND(ju.total_cost * (1 - ju.avg_cpu / 100) / 2, 2) AS potential_savings\nFROM job_util ju\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j\n  ON ju.workspace_id = j.workspace_id AND ju.job_id = j.job_id\nWHERE ju.avg_cpu < 30\nORDER BY ju.avg_cpu ASC\nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_high_mem",
      "displayName": "Jobs with High Memory Utilization",
      "query": "WITH job_cost AS (\n  SELECT\n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_cluster_id AS cluster_id,\n    SUM(f.list_cost) AS list_cost,\n    FIRST(f.identity_metadata_run_as, TRUE) AS run_as\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.sku_name LIKE '%JOBS%'\n    AND f.sku_name NOT LIKE '%SERVERLESS%'\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_date BETWEEN :time_range.min AND :time_range.max\n  GROUP BY f.workspace_id, f.usage_metadata_job_id, f.usage_metadata_cluster_id\n),\njob_util AS (\n  SELECT\n    jc.workspace_id,\n    jc.job_id,\n    ROUND(AVG(n.cpu_user_percent + n.cpu_system_percent), 1) AS avg_cpu,\n    ROUND(MAX(n.cpu_user_percent + n.cpu_system_percent), 1) AS peak_cpu,\n    ROUND(AVG(n.mem_used_percent), 1) AS avg_memory,\n    ROUND(MAX(n.mem_used_percent), 1) AS peak_memory,\n    ROUND(AVG(n.cpu_wait_percent), 1) AS avg_io_wait,\n    SUM(jc.list_cost) AS total_cost\n  FROM job_cost jc\n  JOIN ${catalog}.${gold_schema}.fact_node_timeline n\n    ON jc.cluster_id = n.cluster_id\n    AND n.start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY jc.workspace_id, jc.job_id\n)\nSELECT\n  COALESCE(j.name, ju.job_id) AS job_name,\n  ju.workspace_id,\n  ju.job_id,\n  ju.avg_cpu,\n  ju.peak_cpu,\n  ju.avg_memory,\n  ju.peak_memory,\n  ju.avg_io_wait,\n  ROUND(ju.total_cost, 2) AS total_cost\nFROM job_util ju\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j\n  ON ju.workspace_id = j.workspace_id AND ju.job_id = j.job_id\nWHERE ju.avg_memory > 70\nORDER BY ju.avg_memory DESC\nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_cost_savings",
      "displayName": "Job Cost Savings Opportunities",
      "query": "WITH job_cost AS (\n  SELECT\n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_cluster_id AS cluster_id,\n    SUM(f.list_cost) AS list_cost\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.sku_name LIKE '%JOBS%'\n    AND f.sku_name NOT LIKE '%SERVERLESS%'\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_date BETWEEN :time_range.min AND :time_range.max\n  GROUP BY f.workspace_id, f.usage_metadata_job_id, f.usage_metadata_cluster_id\n),\njob_util AS (\n  SELECT\n    jc.workspace_id,\n    jc.job_id,\n    ROUND(AVG(n.cpu_user_percent + n.cpu_system_percent), 1) AS avg_cpu,\n    ROUND(MAX(n.cpu_user_percent + n.cpu_system_percent), 1) AS peak_cpu,\n    ROUND(AVG(n.mem_used_percent), 1) AS avg_memory,\n    ROUND(MAX(n.mem_used_percent), 1) AS peak_memory,\n    SUM(jc.list_cost) AS total_cost\n  FROM job_cost jc\n  JOIN ${catalog}.${gold_schema}.fact_node_timeline n\n    ON jc.cluster_id = n.cluster_id\n    AND n.start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY jc.workspace_id, jc.job_id\n)\nSELECT\n  COALESCE(j.name, ju.job_id) AS job_name,\n  ju.workspace_id,\n  ju.job_id,\n  ju.avg_cpu,\n  ju.peak_cpu,\n  ju.avg_memory,\n  ju.peak_memory,\n  ROUND(ju.total_cost, 2) AS total_cost,\n  ROUND(ju.total_cost * (1 - ju.avg_cpu / 100) / 2, 2) AS max_savings\nFROM job_util ju\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j\n  ON ju.workspace_id = j.workspace_id AND ju.job_id = j.job_id\nWHERE ju.total_cost > 10\nORDER BY ROUND(ju.total_cost * (1 - ju.avg_cpu / 100) / 2, 2) DESC\nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_utilization_distribution",
      "displayName": "Job CPU Utilization Distribution",
      "query": "WITH job_cost AS (\n  SELECT\n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_cluster_id AS cluster_id,\n    SUM(f.list_cost) AS list_cost\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.sku_name LIKE '%JOBS%'\n    AND f.sku_name NOT LIKE '%SERVERLESS%'\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_date BETWEEN :time_range.min AND :time_range.max\n  GROUP BY f.workspace_id, f.usage_metadata_job_id, f.usage_metadata_cluster_id\n),\njob_util AS (\n  SELECT\n    jc.workspace_id,\n    jc.job_id,\n    ROUND(AVG(n.cpu_user_percent + n.cpu_system_percent), 1) AS avg_cpu\n  FROM job_cost jc\n  JOIN ${catalog}.${gold_schema}.fact_node_timeline n\n    ON jc.cluster_id = n.cluster_id\n    AND n.start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY jc.workspace_id, jc.job_id\n),\nbucketed AS (\n  SELECT\n    CASE\n      WHEN avg_cpu < 10 THEN '0-10%'\n      WHEN avg_cpu < 25 THEN '10-25%'\n      WHEN avg_cpu < 50 THEN '25-50%'\n      WHEN avg_cpu < 75 THEN '50-75%'\n      ELSE '75-100%'\n    END AS cpu_range,\n    CASE\n      WHEN avg_cpu < 10 THEN 1\n      WHEN avg_cpu < 25 THEN 2\n      WHEN avg_cpu < 50 THEN 3\n      WHEN avg_cpu < 75 THEN 4\n      ELSE 5\n    END AS sort_order\n  FROM job_util\n)\nSELECT cpu_range, COUNT(*) AS job_count, MIN(sort_order) AS sort_order\nFROM bucketed\nGROUP BY cpu_range\nORDER BY sort_order",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_kpi_utilization",
      "displayName": "Job Utilization KPIs",
      "query": "WITH job_cost AS (\n  SELECT\n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_cluster_id AS cluster_id,\n    SUM(f.list_cost) AS list_cost\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.sku_name LIKE '%JOBS%'\n    AND f.sku_name NOT LIKE '%SERVERLESS%'\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_date BETWEEN :time_range.min AND :time_range.max\n  GROUP BY f.workspace_id, f.usage_metadata_job_id, f.usage_metadata_cluster_id\n),\njob_util AS (\n  SELECT\n    jc.workspace_id,\n    jc.job_id,\n    AVG(n.cpu_user_percent + n.cpu_system_percent) AS avg_cpu,\n    AVG(n.mem_used_percent) AS avg_memory,\n    SUM(jc.list_cost) AS total_cost\n  FROM job_cost jc\n  JOIN ${catalog}.${gold_schema}.fact_node_timeline n\n    ON jc.cluster_id = n.cluster_id\n    AND n.start_time BETWEEN :time_range.min AND :time_range.max\n  GROUP BY jc.workspace_id, jc.job_id\n)\nSELECT\n  COUNT(DISTINCT job_id) AS total_jobs,\n  ROUND(AVG(avg_cpu), 1) AS avg_cpu_utilization,\n  ROUND(AVG(avg_memory), 1) AS avg_memory_utilization,\n  SUM(CASE WHEN avg_cpu < 30 THEN 1 ELSE 0 END) AS low_cpu_jobs,\n  SUM(CASE WHEN avg_memory > 70 THEN 1 ELSE 0 END) AS high_memory_jobs,\n  ROUND(SUM(total_cost * (1 - avg_cpu / 100) / 2), 2) AS total_potential_savings\nFROM job_util",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": { "value": "now-30d/d" },
              "max": { "value": "now/d" }
            }
          }
        }
      ]
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}