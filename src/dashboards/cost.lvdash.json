{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_time_range",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_time_range",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_users_time_range",
                "query": {
                  "datasetName": "ds_highest_change_users",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_untagged_cost_time_range",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_time_range",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_runs_time_range",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_time_range",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outlier_runs_time_range",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_cost_time_range",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_time_range",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_time_range",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_cost_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_serverless_time_range",
                "query": {
                  "datasetName": "ds_monitor_serverless",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_summary_time_range",
                "query": {
                  "datasetName": "ds_monitor_summary",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ytd_spend_time_range",
                "query": {
                  "datasetName": "ds_ytd_spend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_commit_status_time_range",
                "query": {
                  "datasetName": "ds_commit_status",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_forecast_summary_time_range",
                "query": {
                  "datasetName": "ds_forecast_summary",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_variance_time_range",
                "query": {
                  "datasetName": "ds_variance",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_run_rate_time_range",
                "query": {
                  "datasetName": "ds_run_rate",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_usage_forecast_time_range",
                "query": {
                  "datasetName": "ds_usage_forecast",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_cumulative_vs_commit_time_range",
                "query": {
                  "datasetName": "ds_cumulative_vs_commit",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monthly_breakdown_time_range",
                "query": {
                  "datasetName": "ds_monthly_breakdown",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monthly_detail_time_range",
                "query": {
                  "datasetName": "ds_monthly_detail",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_users_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_untagged_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_runs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outlier_runs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_cost_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_serverless_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_summary_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ytd_spend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_commit_status_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_forecast_summary_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_variance_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_run_rate_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_usage_forecast_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_cumulative_vs_commit_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monthly_breakdown_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monthly_detail_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_param_workspace",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_untagged_cost_param_workspace",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_runs_param_workspace",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outlier_runs_param_workspace",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_cost_param_workspace",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_workspace",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_budget_alerts_param_workspace",
                "query": {
                  "datasetName": "ds_ml_budget_alerts",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_untagged_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_runs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outlier_runs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_budget_alerts_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_sku",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_sku_sku_name",
                "query": {
                  "datasetName": "ds_select_sku",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_param_sku",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_sku",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "sku_name",
                    "displayName": "SKU",
                    "queryName": "dashboards/dummy/datasets/ds_select_sku_sku_name"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_param_sku"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_sku"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "SKU"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_cost_overview",
      "displayName": "\ud83d\udcb0 Cost Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_mtd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "fields": [
                    {
                      "name": "mtd_cost",
                      "expression": "`mtd_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mtd_cost",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTD Spend",
                "description": "Month-to-Date Total"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "fields": [
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_cost",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "fields": [
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "growth_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30d vs 60d Growth %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_tag_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "fields": [
                    {
                      "name": "coverage_pct",
                      "expression": "`coverage_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "coverage_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tag Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users (30d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_wow_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_cost",
                      "expression": "`weekly_cost`"
                    },
                    {
                      "name": "wow_growth_pct",
                      "expression": "`wow_growth_pct`"
                    },
                    {
                      "name": "moving_avg",
                      "expression": "`moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "displayName": "Week",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "weekly_cost",
                      "displayName": "Weekly Cost ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Week-over-Week Cost & Growth Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_daily_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "serverless_cost",
                      "expression": "`serverless_cost`"
                    },
                    {
                      "name": "classic_cost",
                      "expression": "`classic_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "serverless_cost",
                      "displayName": "Serverless ($)"
                    },
                    {
                      "fieldName": "classic_cost",
                      "displayName": "Classic ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Cost: Serverless vs Classic"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_top_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "job_runs",
                      "expression": "`job_runs`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_count",
                    "title": "Jobs",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_runs",
                    "title": "Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfe2 Top Workspaces (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_sku_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "sku_name",
                  "displayName": "SKU"
                },
                "angle": {
                  "fieldName": "total_cost",
                  "displayName": "Cost ($)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce6 Spend by SKU"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 16,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_cost_attribution",
      "displayName": "\ud83c\udff7\ufe0f Cost Attribution",
      "layout": [
        {
          "widget": {
            "name": "table_top_owners",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_top_owners",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "job_cost",
                      "expression": "`job_cost`"
                    },
                    {
                      "name": "notebook_cost",
                      "expression": "`notebook_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_cost",
                    "title": "Jobs ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "notebook_cost",
                    "title": "Notebooks ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb5 Cost by Owner (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_spend_by_tag",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_spend_by_tag",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "tag_bucket",
                      "expression": "`tag_bucket`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "tag_bucket",
                    "title": "Tag",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udff7\ufe0f Spend by Tag"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_highest_change_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_highest_change_users",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "last_7d",
                      "expression": "`last_7d`"
                    },
                    {
                      "name": "prev_7d",
                      "expression": "`prev_7d`"
                    },
                    {
                      "name": "growth",
                      "expression": "`growth`"
                    },
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "owner",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_7d",
                    "title": "Last 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "prev_7d",
                    "title": "Prev 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth",
                    "title": "Growth ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth_pct",
                    "title": "Growth %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Users with Highest Cost Increase"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_untagged_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "untagged_cost",
                      "expression": "`untagged_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "untagged_cost",
                    "title": "Untagged Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Untagged Resources by Owner"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_jobs_cost",
      "displayName": "\u2699\ufe0f Jobs Cost Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_expensive_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "last_run",
                      "expression": "`last_run`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "last_run",
                    "title": "Last Run",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Most Expensive Jobs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_expensive_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "run_id",
                      "expression": "`run_id`"
                    },
                    {
                      "name": "run_cost",
                      "expression": "`run_cost`"
                    },
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_id",
                    "title": "Run ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_cost",
                    "title": "Run Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "run_date",
                    "title": "Date",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfc3 Most Expensive Individual Runs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_highest_change_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "last_7d",
                      "expression": "`last_7d`"
                    },
                    {
                      "name": "prev_7d",
                      "expression": "`prev_7d`"
                    },
                    {
                      "name": "growth",
                      "expression": "`growth`"
                    },
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_7d",
                    "title": "Last 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "prev_7d",
                    "title": "Prev 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth",
                    "title": "Growth ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth_pct",
                    "title": "Growth %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Jobs with Highest Cost Increase (7d vs 14d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_outlier_job_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "max_cost",
                      "expression": "`max_cost`"
                    },
                    {
                      "name": "p90",
                      "expression": "`p90`"
                    },
                    {
                      "name": "deviation",
                      "expression": "`deviation`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_cost",
                    "title": "Avg ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_cost",
                    "title": "Max ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p90",
                    "title": "P90 ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation",
                    "title": "Deviation",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Jobs with Outlier Runs (Max >> P90)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_failure_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "failure_cost",
                      "expression": "`failure_cost`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "failure_cost",
                    "title": "Failure Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "failures",
                    "title": "Failures",
                    "type": "number"
                  },
                  {
                    "fieldName": "success_rate",
                    "title": "Success %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb8 Cost of Job Failures (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_repair_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_repair_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "repairs",
                      "expression": "`repairs`"
                    },
                    {
                      "name": "repair_cost",
                      "expression": "`repair_cost`"
                    },
                    {
                      "name": "repair_time_min",
                      "expression": "`repair_time_min`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "repairs",
                    "title": "Repairs",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_cost",
                    "title": "Repair Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_time_min",
                    "title": "Time (min)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd27 Most Repaired Jobs & Cost"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 18,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_optimization",
      "displayName": "\ud83c\udfaf Optimization Opportunities",
      "layout": [
        {
          "widget": {
            "name": "table_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_stale_datasets",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "unused_tables",
                      "expression": "`unused_tables`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "last_run",
                      "expression": "`last_run`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "unused_tables",
                    "title": "Unused Tables",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "last_run",
                    "title": "Last Run",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce6 Jobs Producing Unconsumed Data"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ap_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ap_cluster_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "task_runs",
                    "title": "Task Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udda5\ufe0f Jobs Using All-Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_autoscale",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "worker_count",
                      "expression": "`worker_count`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "worker_count",
                    "title": "Avg DBUs",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Jobs with Fixed Cluster Size"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_low_dbr",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_low_dbr_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "dbr_version",
                    "title": "Age",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd04 Stale Jobs (Not Updated 6+ Months)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_no_tags",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udff7\ufe0f Jobs Without Tags"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_savings_potential",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_savings_potential",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "max_savings",
                      "expression": "`max_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Cost Variance %",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_savings",
                    "title": "Potential Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Right-Sizing Savings Opportunities"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "chart_ml_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_cost_forecast",
                  "fields": [
                    {
                      "name": "forecast_date",
                      "expression": "`forecast_date`"
                    },
                    {
                      "name": "forecasted_cost",
                      "expression": "`forecasted_cost`"
                    },
                    {
                      "name": "lower_bound",
                      "expression": "`lower_bound`"
                    },
                    {
                      "name": "upper_bound",
                      "expression": "`upper_bound`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "forecast_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "forecasted_cost",
                      "displayName": "Forecast"
                    },
                    {
                      "fieldName": "lower_bound",
                      "displayName": "Lower"
                    },
                    {
                      "fieldName": "upper_bound",
                      "displayName": "Upper"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: 30-Day Cost Forecast",
                "description": "Prophet time series model with confidence intervals"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_anomalies",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "cost_driver",
                      "expression": "`cost_driver`"
                    },
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "usage_date",
                    "title": "Date",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "daily_cost",
                    "title": "Daily Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "cost_driver",
                    "title": "Cost Driver",
                    "type": "string"
                  },
                  {
                    "fieldName": "sku_name",
                    "title": "Top SKU",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Detected Cost Anomalies",
                "description": "Anomalies with specific cost drivers and recommendations"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_budget_alerts",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_budget_alerts",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "alert_priority",
                      "expression": "`alert_priority`"
                    },
                    {
                      "name": "mtd_spend",
                      "expression": "`mtd_spend`"
                    },
                    {
                      "name": "projected_spend",
                      "expression": "`projected_spend`"
                    },
                    {
                      "name": "burn_rate",
                      "expression": "`burn_rate`"
                    },
                    {
                      "name": "days_to_budget",
                      "expression": "`days_to_budget`"
                    },
                    {
                      "name": "top_sku",
                      "expression": "`top_sku`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "alert_priority",
                    "title": "Priority",
                    "type": "string"
                  },
                  {
                    "fieldName": "mtd_spend",
                    "title": "MTD Spend ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "projected_spend",
                    "title": "Projected ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "burn_rate",
                    "title": "Burn Rate",
                    "type": "number"
                  },
                  {
                    "fieldName": "days_to_budget",
                    "title": "Days Left",
                    "type": "number"
                  },
                  {
                    "fieldName": "top_sku",
                    "title": "Top SKU",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Budget Alert Priorities",
                "description": "Budget tracking with specific cost drivers and recommendations"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_tag_recommendations",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_tag_recs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    },
                    {
                      "name": "recommended_tag",
                      "expression": "`recommended_tag`"
                    },
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    },
                    {
                      "name": "scored_at",
                      "expression": "`scored_at`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Total Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "ML Confidence",
                    "type": "number"
                  },
                  {
                    "fieldName": "recommended_tag",
                    "title": "Recommended Tag",
                    "type": "string"
                  },
                  {
                    "fieldName": "priority",
                    "title": "Priority",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Rationale",
                    "type": "string"
                  },
                  {
                    "fieldName": "scored_at",
                    "title": "Scored At",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " ML: Tag Recommendations",
                "description": "ML-powered tag recommendations from Unity Catalog model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_user_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_user_behavior",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cluster_label",
                      "expression": "`cluster_label`"
                    },
                    {
                      "name": "total_spend",
                      "expression": "`total_spend`"
                    },
                    {
                      "name": "usage_summary",
                      "expression": "`usage_summary`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_label",
                    "title": "User Type",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_spend",
                    "title": "30d Spend ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "usage_summary",
                    "title": "Usage Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: User Behavior Clusters",
                "description": "User segmentation by cost behavior with actionable recommendations"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_migration_recs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_migration_recs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cluster_type",
                      "expression": "`cluster_type`"
                    },
                    {
                      "name": "total_cost_30d",
                      "expression": "`total_cost_30d`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    },
                    {
                      "name": "confidence_rationale",
                      "expression": "`confidence_rationale`"
                    },
                    {
                      "name": "usage_details",
                      "expression": "`usage_details`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_type",
                    "title": "Type",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost_30d",
                    "title": "30d Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Est. Savings ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "confidence_rationale",
                    "title": "Confidence & Rationale",
                    "type": "string"
                  },
                  {
                    "fieldName": "usage_details",
                    "title": "Usage Details",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Migration Recommendations",
                "description": "All-Purpose to Jobs cluster migration analysis"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": " Cost Metrics Overview",
      "layout": [
        {
          "widget": {
            "name": "chart_monitor_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "total_dbu",
                      "expression": "`total_dbu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_cost",
                      "displayName": "Cost ($)"
                    },
                    {
                      "fieldName": "total_dbu",
                      "displayName": "DBU"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Cost & DBU Trend",
                "description": "Custom metrics from fact_usage monitor"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_serverless",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_dbu",
                      "expression": "`total_dbu`"
                    },
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    },
                    {
                      "name": "tag_coverage_pct",
                      "expression": "`tag_coverage_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_dbu",
                      "displayName": "DBU Volume"
                    },
                    {
                      "fieldName": "serverless_pct",
                      "displayName": "Serverless %"
                    },
                    {
                      "fieldName": "tag_coverage_pct",
                      "displayName": "Tag Coverage %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Adoption Metrics Trend",
                "description": "Serverless adoption and tagging trends"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "cost_drift_pct",
                      "expression": "`cost_drift_pct`"
                    },
                    {
                      "name": "serverless_drift",
                      "expression": "`serverless_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "cost_drift_pct",
                      "displayName": "Cost Drift %"
                    },
                    {
                      "fieldName": "serverless_drift",
                      "displayName": "Serverless Drift"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Drift Detection",
                "description": "Period-over-period changes from drift metrics"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_summary",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_summary",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "total_dbu",
                      "expression": "`total_dbu`"
                    },
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    },
                    {
                      "name": "tag_coverage_pct",
                      "expression": "`tag_coverage_pct`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_dbu",
                    "title": "DBU",
                    "type": "number"
                  },
                  {
                    "fieldName": "serverless_pct",
                    "title": "Serverless %",
                    "type": "number"
                  },
                  {
                    "fieldName": "tag_coverage_pct",
                    "title": "Tag %",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_commit_overview",
      "displayName": "Commit vs Consumption",
      "layout": [
        {
          "widget": {
            "name": "param_annual_commit",
            "queries": [
              {
                "name": "options_query",
                "query": {
                  "datasetName": "ds_commit_options",
                  "fields": [
                    {
                      "name": "commit_amount",
                      "expression": "`commit_amount`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_commit_status",
                "query": {
                  "datasetName": "ds_commit_status",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_variance",
                "query": {
                  "datasetName": "ds_variance",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_cumulative_vs_commit",
                "query": {
                  "datasetName": "ds_cumulative_vs_commit",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monthly_breakdown",
                "query": {
                  "datasetName": "ds_monthly_breakdown",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monthly_detail",
                "query": {
                  "datasetName": "ds_monthly_detail",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Annual Commit ($)",
                    "fieldName": "commit_amount",
                    "queryName": "options_query"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_ds_commit_status"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_ds_variance"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_ds_cumulative_vs_commit"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_ds_monthly_breakdown"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_ds_monthly_detail"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "DECIMAL",
                    "values": [
                      {
                        "value": "1000000"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Annual Commit ($)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_ytd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ytd_spend",
                  "fields": [
                    {
                      "name": "ytd_spend",
                      "expression": "`ytd_spend`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "ytd_spend",
                  "displayName": "YTD Spend",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "YTD Consumption",
                "description": "Year-to-date actual spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_commit_utilization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_commit_status",
                  "fields": [
                    {
                      "name": "utilization_pct",
                      "expression": "`utilization_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "utilization_pct",
                  "displayName": "Utilization %",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Commit Utilization",
                "description": "% of annual commit consumed"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_forecasted_annual",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_forecast_summary",
                  "fields": [
                    {
                      "name": "forecasted_annual",
                      "expression": "`forecasted_annual`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "forecasted_annual",
                  "displayName": "Forecasted Annual",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Forecasted Annual",
                "description": "Projected year-end spend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_projected_variance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_variance",
                  "fields": [
                    {
                      "name": "projected_variance",
                      "expression": "`projected_variance`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "projected_variance",
                  "displayName": "Projected Variance",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Projected Variance",
                "description": "Overspend (+) / Underspend (-)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_run_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_run_rate",
                  "fields": [
                    {
                      "name": "daily_run_rate",
                      "expression": "`daily_run_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "daily_run_rate",
                  "displayName": "Run Rate",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Run Rate",
                "description": "Current daily spend rate"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_usage_vs_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_usage_forecast",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "forecast_type",
                      "expression": "`forecast_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "daily_cost",
                  "displayName": "Usage ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                },
                "color": {
                  "fieldName": "forecast_type",
                  "displayName": "Type",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Usage Over Time",
                "description": "Actuals vs AI Forecast"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_cumulative_vs_commit",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_cumulative_vs_commit",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "cumulative_spend",
                      "expression": "`cumulative_spend`"
                    },
                    {
                      "name": "target_line",
                      "expression": "`target_line`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "cumulative_spend",
                      "displayName": "Actual Spend"
                    },
                    {
                      "fieldName": "target_line",
                      "displayName": "Commit Target"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Cumulative Spend vs Commit Target",
                "description": "Blue = Actual Spend, Orange = Commit Target"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monthly_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monthly_breakdown",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "month_name",
                  "displayName": "Month",
                  "scale": {
                    "type": "ordinal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "monthly_cost",
                      "displayName": "Actual Spend"
                    },
                    {
                      "fieldName": "monthly_target",
                      "displayName": "Monthly Target"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend vs Target",
                "description": "Compare actual monthly spend against prorated commit target"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monthly_detail",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monthly_detail",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    },
                    {
                      "name": "variance",
                      "expression": "`variance`"
                    },
                    {
                      "name": "variance_pct",
                      "expression": "`variance_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend Detail"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "month_name",
                    "title": "Month",
                    "type": "string"
                  },
                  {
                    "fieldName": "monthly_cost",
                    "title": "Actual ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "monthly_target",
                    "title": "Target ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance",
                    "title": "Variance ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance_pct",
                    "title": "Variance %",
                    "type": "string"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_ml_budget_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_budget_forecast",
                  "fields": [
                    {
                      "name": "prediction_date",
                      "expression": "`prediction_date`"
                    },
                    {
                      "name": "predicted_daily_cost",
                      "expression": "`predicted_daily_cost`"
                    },
                    {
                      "name": "predicted_cumulative",
                      "expression": "`predicted_cumulative`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "prediction_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "predicted_cumulative",
                  "displayName": "Cumulative Forecast ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Budget Forecast (Next 30 Days)",
                "description": "From budget_forecaster model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_commitment_rec",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_commitment_rec",
                  "fields": [
                    {
                      "name": "recommendation_type",
                      "expression": "`recommendation_type`"
                    },
                    {
                      "name": "recommended_amount",
                      "expression": "`recommended_amount`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    },
                    {
                      "name": "annual_savings",
                      "expression": "`annual_savings`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "recommendation_type",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_amount",
                    "title": "Amount ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence",
                    "type": "number"
                  },
                  {
                    "fieldName": "annual_savings",
                    "title": "Est. Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Commitment Recommendations",
                "description": "From commitment_recommender model"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 22,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "cost_per_dbu",
                      "expression": "`cost_per_dbu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "total_cost",
                  "displayName": "Total Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Lakehouse Monitor: Daily Cost Trend",
                "description": "Custom metric from fact_usage monitor"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "cost_lakehouse_monitoring",
      "displayName": " Advanced Cost Metrics",
      "layout": [
        {
          "widget": {
            "name": "cost_time_start_filter",
            "queries": [
              {
                "name": "param_ds_monitor_cost_aggregate_time_start",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_derived_time_start",
                "query": {
                  "datasetName": "ds_monitor_cost_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_drift_time_start",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_keys_time_start",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_values_time_start",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_cost_aggregate_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_cost_derived_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_cost_drift_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_cost_slice_keys_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_cost_slice_values_time_start"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_time_end_filter",
            "queries": [
              {
                "name": "param_ds_monitor_cost_aggregate_time_end",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_derived_time_end",
                "query": {
                  "datasetName": "ds_monitor_cost_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_drift_time_end",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_keys_time_end",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_values_time_end",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_cost_aggregate_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_cost_derived_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_cost_drift_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_cost_slice_keys_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_cost_slice_values_time_end"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "End Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_slice_key_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_keys",
                  "fields": [
                    {
                      "name": "slice_key",
                      "expression": "`slice_key`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_cost_aggregate_slice_key",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_derived_slice_key",
                "query": {
                  "datasetName": "ds_monitor_cost_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_drift_slice_key",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Key",
                    "fieldName": "slice_key",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_cost_aggregate_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_cost_derived_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_cost_drift_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_cost_slice_values_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_cost_slice_values_slice_key"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Key:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_slice_value_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "fields": [
                    {
                      "name": "slice_value",
                      "expression": "`slice_value`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_cost_aggregate_slice_value",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_derived_slice_value",
                "query": {
                  "datasetName": "ds_monitor_cost_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_drift_slice_value",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_cost_slice_values_slice_value",
                "query": {
                  "datasetName": "ds_monitor_cost_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Value",
                    "fieldName": "slice_value",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_cost_aggregate_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_cost_derived_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_cost_drift_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_cost_slice_values_slice_value"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Value:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 9,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cost_aggregate_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_daily_cost",
                      "expression": "`total_daily_cost`"
                    },
                    {
                      "name": "total_daily_dbu",
                      "expression": "`total_daily_dbu`"
                    },
                    {
                      "name": "tagged_cost_total",
                      "expression": "`tagged_cost_total`"
                    },
                    {
                      "name": "untagged_cost_total",
                      "expression": "`untagged_cost_total`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Total Daily Cost",
                      "fieldName": "total_daily_cost"
                    },
                    {
                      "displayName": "Total Daily Dbu",
                      "fieldName": "total_daily_dbu"
                    },
                    {
                      "displayName": "Tagged Cost Total",
                      "fieldName": "tagged_cost_total"
                    },
                    {
                      "displayName": "Untagged Cost Total",
                      "fieldName": "untagged_cost_total"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track cost aggregate metrics over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Cost Aggregate Metrics Over Time"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_derived_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_derived",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "tag_coverage_pct",
                      "expression": "`tag_coverage_pct`"
                    },
                    {
                      "name": "serverless_ratio",
                      "expression": "`serverless_ratio`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Tag Coverage Pct",
                      "fieldName": "tag_coverage_pct"
                    },
                    {
                      "displayName": "Serverless Ratio",
                      "fieldName": "serverless_ratio"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track cost business ratios over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Cost KPI Trends"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 6,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_drift_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "cost_drift_pct",
                      "expression": "`cost_drift_pct`"
                    },
                    {
                      "name": "tag_coverage_drift",
                      "expression": "`tag_coverage_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Cost Drift Pct",
                      "fieldName": "cost_drift_pct"
                    },
                    {
                      "displayName": "Tag Coverage Drift",
                      "fieldName": "tag_coverage_drift"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track period-over-period changes",
                "showDescription": true,
                "showTitle": true,
                "title": "Drift Metrics (Period Comparison)"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 12,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "cost_aggregate_table",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_aggregate",
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Window Start",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "window_end",
                    "title": "Window End",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_daily_cost",
                    "title": "Total Daily Cost",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_daily_dbu",
                    "title": "Total Daily DBU",
                    "type": "number"
                  },
                  {
                    "fieldName": "tagged_cost_total",
                    "title": "Tagged Cost Total",
                    "type": "number"
                  },
                  {
                    "fieldName": "untagged_cost_total",
                    "title": "Untagged Cost Total",
                    "type": "number"
                  },
                  {
                    "fieldName": "serverless_cost",
                    "title": "Serverless Cost",
                    "type": "number"
                  },
                  {
                    "fieldName": "dlt_cost",
                    "title": "DLT Cost",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Cost Aggregate Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 12,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_mtd",
      "displayName": "KPI: MTD Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS mtd_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_30d",
      "displayName": "KPI: 30d Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_30_60_compare",
      "displayName": "30 vs 60 Day Compare",
      "query": "WITH periods AS (SELECT SUM(CASE WHEN usage_date BETWEEN :time_range.min AND :time_range.max THEN list_cost ELSE 0 END) AS last_30, SUM(CASE WHEN usage_date BETWEEN CURRENT_DATE() - INTERVAL 60 DAYS AND CURRENT_DATE() - INTERVAL 31 DAYS THEN list_cost ELSE 0 END) AS prev_30 FROM ${catalog}.${gold_schema}.fact_usage) SELECT CONCAT(ROUND((last_30 - prev_30) * 100.0 / NULLIF(prev_30, 0), 1), '%') AS growth_pct FROM periods",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_tag_coverage",
      "displayName": "Tag Coverage",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS coverage_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_serverless_adoption",
      "displayName": "Serverless Adoption",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS serverless_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_unique_counts",
      "displayName": "Unique Counts",
      "query": "SELECT COUNT(DISTINCT identity_metadata_run_as) AS unique_users, COUNT(DISTINCT usage_metadata_job_id) AS unique_jobs FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_wow_growth",
      "displayName": "WoW Growth",
      "query": "WITH weekly AS (SELECT DATE_TRUNC('week', usage_date) AS week_start, SUM(list_cost) AS weekly_cost, COUNT(DISTINCT DATE(usage_date)) AS days FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 HAVING days = 7), with_growth AS (SELECT week_start, weekly_cost, 100 * (weekly_cost - LAG(weekly_cost) OVER (ORDER BY week_start)) / NULLIF(LAG(weekly_cost) OVER (ORDER BY week_start), 0) AS wow_growth_pct FROM weekly) SELECT week_start, ROUND(weekly_cost, 2) AS weekly_cost, ROUND(wow_growth_pct, 1) AS wow_growth_pct, ROUND(AVG(wow_growth_pct) OVER (ORDER BY week_start ROWS BETWEEN 12 PRECEDING AND CURRENT ROW), 1) AS moving_avg FROM with_growth ORDER BY week_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_daily_cost",
      "displayName": "Daily Cost",
      "query": "SELECT DATE(usage_date) AS usage_date, SUM(list_cost) AS daily_cost, SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) AS serverless_cost, SUM(CASE WHEN NOT product_features_is_serverless THEN list_cost ELSE 0 END) AS classic_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_top_workspaces",
      "displayName": "Top Workspaces",
      "query": "SELECT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, ROUND(SUM(f.list_cost), 2) AS total_cost, COUNT(DISTINCT f.identity_metadata_run_as) AS unique_users, COUNT(DISTINCT f.usage_metadata_job_id) AS job_count, COUNT(DISTINCT f.usage_metadata_job_run_id) AS job_runs FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY total_cost DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_sku_breakdown",
      "displayName": "SKU Breakdown",
      "query": "SELECT sku_name, ROUND(SUM(f.list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY sku_name ORDER BY total_cost DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_top_owners",
      "displayName": "Top Owners",
      "query": "SELECT f.identity_metadata_run_as AS owner, ROUND(SUM(f.list_cost), 2) AS total_cost, ROUND(SUM(CASE WHEN f.sku_name LIKE '%JOBS%' THEN f.list_cost ELSE 0 END), 2) AS job_cost, ROUND(SUM(CASE WHEN f.usage_metadata_notebook_id IS NOT NULL THEN f.list_cost ELSE 0 END), 2) AS notebook_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.identity_metadata_run_as IS NOT NULL GROUP BY 1 ORDER BY total_cost DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_spend_by_tag",
      "displayName": "Spend by Tag",
      "query": "SELECT CASE WHEN is_tagged THEN 'Tagged' ELSE 'Untagged' END AS tag_bucket, ROUND(SUM(list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE 1=1 GROUP BY 1 ORDER BY total_cost DESC"
    },
    {
      "name": "ds_highest_change_users",
      "displayName": "Highest Change Users",
      "query": "WITH user_spend AS (\n  SELECT \n    identity_metadata_run_as AS owner, \n    SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS THEN list_cost ELSE 0 END) AS last_7d, \n    SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS AND usage_date < CURRENT_DATE() - INTERVAL 7 DAYS THEN list_cost ELSE 0 END) AS prev_7d \n  FROM ${catalog}.${gold_schema}.fact_usage \n  WHERE usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n    AND identity_metadata_run_as IS NOT NULL\n    AND identity_metadata_run_as NOT LIKE '%.gserviceaccount.com'\n    AND identity_metadata_run_as NOT LIKE 'service-principal-%'\n  GROUP BY 1\n) \nSELECT \n  owner, \n  ROUND(last_7d, 2) AS last_7d, \n  ROUND(prev_7d, 2) AS prev_7d, \n  ROUND(last_7d - prev_7d, 2) AS growth,\n  ROUND(100 * (last_7d - prev_7d) / NULLIF(prev_7d, 0), 1) AS growth_pct \nFROM user_spend \nWHERE prev_7d > 0 OR last_7d > 0\nORDER BY (last_7d - prev_7d) DESC \nLIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_untagged_cost",
      "displayName": "Untagged Cost",
      "query": "SELECT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, f.identity_metadata_run_as AS owner, ROUND(SUM(f.list_cost), 2) AS untagged_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.is_tagged = FALSE GROUP BY 1, 2 ORDER BY untagged_cost DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_expensive_jobs",
      "displayName": "Expensive Jobs",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n  COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, \n  COUNT(DISTINCT f.usage_metadata_job_run_id) AS runs, \n  ROUND(SUM(f.list_cost), 2) AS total_cost, \n  MAX(f.identity_metadata_run_as) AS owner,\n  MAX(DATE(f.usage_date)) AS last_run\nFROM ${catalog}.${gold_schema}.fact_usage f \nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \nLEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id \nWHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n  AND f.usage_metadata_job_id IS NOT NULL \nGROUP BY 1, 2 \nORDER BY total_cost DESC \nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_expensive_runs",
      "displayName": "Expensive Runs",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n  CAST(f.usage_metadata_job_run_id AS STRING) AS run_id, \n  ROUND(SUM(f.list_cost), 2) AS run_cost, \n  MAX(DATE(f.usage_date)) AS run_date,\n  MAX(f.identity_metadata_run_as) AS owner\nFROM ${catalog}.${gold_schema}.fact_usage f \nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \nWHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n  AND f.usage_metadata_job_run_id IS NOT NULL \nGROUP BY 1, 2 \nORDER BY run_cost DESC \nLIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_highest_change_jobs",
      "displayName": "Highest Change Jobs",
      "query": "WITH job_spend AS (\n  SELECT \n    COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n    SUM(CASE WHEN f.usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS THEN f.list_cost ELSE 0 END) AS last_7d, \n    SUM(CASE WHEN f.usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS AND f.usage_date < CURRENT_DATE() - INTERVAL 7 DAYS THEN f.list_cost ELSE 0 END) AS prev_7d \n  FROM ${catalog}.${gold_schema}.fact_usage f \n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \n  WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n    AND f.usage_metadata_job_id IS NOT NULL \n  GROUP BY 1\n) \nSELECT \n  job_name, \n  ROUND(last_7d, 2) AS last_7d, \n  ROUND(prev_7d, 2) AS prev_7d, \n  ROUND(last_7d - prev_7d, 2) AS growth,\n  ROUND(100 * (last_7d - prev_7d) / NULLIF(prev_7d, 0), 1) AS growth_pct \nFROM job_spend \nWHERE prev_7d > 0 OR last_7d > 0\nORDER BY (last_7d - prev_7d) DESC \nLIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_outlier_runs",
      "displayName": "Outlier Runs",
      "query": "WITH run_costs AS (\n  SELECT \n    COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, \n    f.usage_metadata_job_run_id AS run_id, \n    SUM(f.list_cost) AS run_cost \n  FROM ${catalog}.${gold_schema}.fact_usage f \n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id \n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n    AND f.usage_metadata_job_run_id IS NOT NULL \n  GROUP BY 1, 2\n), job_stats AS (\n  SELECT \n    job_name, \n    COUNT(*) AS runs, \n    ROUND(AVG(run_cost), 2) AS avg_cost, \n    ROUND(MAX(run_cost), 2) AS max_cost, \n    ROUND(PERCENTILE_APPROX(run_cost, 0.9), 2) AS p90 \n  FROM run_costs \n  GROUP BY 1\n  HAVING COUNT(*) >= 3\n) \nSELECT \n  job_name, \n  runs, \n  avg_cost, \n  max_cost, \n  p90,\n  ROUND((max_cost - p90) / NULLIF(p90, 0) * 100, 0) AS deviation\nFROM job_stats \nWHERE max_cost > p90 * 1.5\nORDER BY (max_cost - p90) DESC \nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_failure_cost",
      "displayName": "Failure Cost",
      "query": "WITH job_runs AS (\n  SELECT \n    f.workspace_id, \n    f.usage_metadata_job_id AS job_id, \n    f.usage_metadata_job_run_id AS run_id, \n    SUM(f.list_cost) AS run_cost \n  FROM ${catalog}.${gold_schema}.fact_usage f \n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max \n    AND f.usage_metadata_job_run_id IS NOT NULL \n  GROUP BY 1, 2, 3\n), run_status AS (\n  SELECT \n    jr.workspace_id,\n    jr.job_id,\n    jr.run_id,\n    jr.run_cost,\n    CASE WHEN t.result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END AS is_success\n  FROM job_runs jr \n  LEFT JOIN ${catalog}.${gold_schema}.fact_job_run_timeline t \n    ON jr.workspace_id = t.workspace_id AND jr.job_id = t.job_id AND jr.run_id = t.run_id\n), job_failure_costs AS (\n  SELECT \n    rs.workspace_id,\n    rs.job_id,\n    SUM(CASE WHEN is_success = 0 THEN run_cost ELSE 0 END) AS failure_cost,\n    SUM(CASE WHEN is_success = 0 THEN 1 ELSE 0 END) AS failures,\n    COUNT(*) AS total_runs\n  FROM run_status rs\n  GROUP BY 1, 2\n  HAVING SUM(CASE WHEN is_success = 0 THEN 1 ELSE 0 END) > 0\n)\nSELECT \n  COALESCE(j.name, CAST(jfc.job_id AS STRING)) AS job_name,\n  ROUND(jfc.failure_cost, 2) AS failure_cost,\n  jfc.failures,\n  ROUND((jfc.total_runs - jfc.failures) * 100.0 / jfc.total_runs, 1) AS success_rate\nFROM job_failure_costs jfc\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON jfc.workspace_id = j.workspace_id AND jfc.job_id = j.job_id\nORDER BY failure_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_repair_cost",
      "displayName": "Repair Cost",
      "query": "WITH job_runs AS (\n  SELECT \n    t.workspace_id,\n    t.job_id,\n    t.run_id,\n    t.run_name,\n    t.run_date,\n    t.result_state,\n    t.run_duration_minutes,\n    ROW_NUMBER() OVER (PARTITION BY t.workspace_id, t.job_id, DATE(t.run_date) ORDER BY t.run_date) AS run_seq\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline t\n  WHERE t.run_date BETWEEN :time_range.min AND :time_range.max\n), repairs AS (\n  SELECT \n    jr.workspace_id,\n    jr.job_id,\n    jr.run_id,\n    jr.run_name,\n    jr.run_duration_minutes\n  FROM job_runs jr\n  WHERE jr.run_seq > 1\n    AND EXISTS (\n      SELECT 1 FROM job_runs prev \n      WHERE prev.workspace_id = jr.workspace_id \n        AND prev.job_id = jr.job_id \n        AND DATE(prev.run_date) = DATE(jr.run_date)\n        AND prev.run_seq < jr.run_seq\n        AND prev.result_state NOT IN ('SUCCESS', 'SUCCEEDED')\n    )\n), repair_costs AS (\n  SELECT \n    r.workspace_id,\n    r.job_id,\n    r.run_id,\n    r.run_name,\n    r.run_duration_minutes,\n    COALESCE(SUM(f.list_cost), 0) AS repair_cost\n  FROM repairs r\n  LEFT JOIN ${catalog}.${gold_schema}.fact_usage f \n    ON r.workspace_id = f.workspace_id \n    AND r.job_id = f.usage_metadata_job_id \n    AND r.run_id = f.usage_metadata_job_run_id\n  GROUP BY 1, 2, 3, 4, 5\n)\nSELECT \n  COALESCE(j.name, rc.run_name, CAST(rc.job_id AS STRING)) AS job_name,\n  COUNT(*) AS repairs,\n  ROUND(SUM(rc.repair_cost), 2) AS repair_cost,\n  ROUND(SUM(rc.run_duration_minutes), 1) AS repair_time_min\nFROM repair_costs rc\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON rc.workspace_id = j.workspace_id AND rc.job_id = j.job_id\nGROUP BY 1\nHAVING COUNT(*) > 0\nORDER BY repair_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_stale_datasets",
      "displayName": "Stale Datasets",
      "query": "WITH writes AS (\n  SELECT DISTINCT\n    entity_metadata_job_id AS job_id,\n    workspace_id,\n    target_table_full_name AS table_name\n  FROM ${catalog}.${gold_schema}.fact_table_lineage\n  WHERE event_date BETWEEN :time_range.min AND :time_range.max\n    AND target_table_full_name IS NOT NULL\n    AND entity_metadata_job_id IS NOT NULL\n), reads AS (\n  SELECT DISTINCT source_table_full_name AS table_name\n  FROM ${catalog}.${gold_schema}.fact_table_lineage\n  WHERE event_date BETWEEN :time_range.min AND :time_range.max\n    AND source_table_full_name IS NOT NULL\n), unread_tables AS (\n  SELECT w.job_id, w.workspace_id, w.table_name\n  FROM writes w\n  LEFT JOIN reads r ON w.table_name = r.table_name\n  WHERE r.table_name IS NULL\n), job_unread AS (\n  SELECT \n    ut.workspace_id,\n    ut.job_id,\n    COUNT(DISTINCT ut.table_name) AS unused_tables\n  FROM unread_tables ut\n  GROUP BY 1, 2\n)\nSELECT \n  COALESCE(j.name, CAST(ju.job_id AS STRING)) AS job_name,\n  ju.unused_tables,\n  COALESCE(ROUND(SUM(f.list_cost), 2), 0) AS total_cost,\n  MAX(DATE(f.usage_date)) AS last_run\nFROM job_unread ju\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON ju.workspace_id = j.workspace_id AND ju.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.fact_usage f ON ju.workspace_id = f.workspace_id AND ju.job_id = f.usage_metadata_job_id\n  AND f.usage_date BETWEEN :time_range.min AND :time_range.max\nGROUP BY 1, 2\nORDER BY total_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ap_cluster_jobs",
      "displayName": "AP Cluster Jobs",
      "query": "WITH job_clusters AS (\n  SELECT \n    t.workspace_id,\n    t.job_id,\n    EXPLODE(t.compute_ids) AS cluster_id,\n    COUNT(DISTINCT t.run_id) AS task_runs\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline t\n  WHERE t.run_date BETWEEN :time_range.min AND :time_range.max\n    AND t.compute_ids IS NOT NULL\n    AND SIZE(t.compute_ids) > 0\n  GROUP BY 1, 2, 3\n)\nSELECT \n  COALESCE(j.name, CAST(jc.job_id AS STRING)) AS job_name,\n  jc.cluster_id AS cluster_name,\n  jc.task_runs,\n  ROUND(COALESCE(SUM(f.list_cost), 0), 2) AS total_cost\nFROM job_clusters jc\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON jc.workspace_id = j.workspace_id AND jc.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.fact_usage f ON jc.workspace_id = f.workspace_id AND jc.job_id = f.usage_metadata_job_id\n  AND f.usage_date BETWEEN :time_range.min AND :time_range.max\nGROUP BY 1, 2, 3\nORDER BY total_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_no_autoscale",
      "displayName": "No Autoscale Jobs",
      "query": "WITH job_runs AS (\n  SELECT \n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_job_run_id AS run_id,\n    SUM(f.list_cost) AS run_cost,\n    SUM(f.usage_quantity) AS run_dbus\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_metadata_job_run_id IS NOT NULL\n  GROUP BY 1, 2, 3\n), job_stats AS (\n  SELECT \n    workspace_id,\n    job_id,\n    COUNT(*) AS total_runs,\n    ROUND(AVG(run_dbus), 0) AS avg_dbus,\n    ROUND(STDDEV(run_dbus), 2) AS stddev_dbus,\n    ROUND(SUM(run_cost), 2) AS total_cost\n  FROM job_runs\n  GROUP BY 1, 2\n  HAVING COUNT(*) >= 5\n)\nSELECT \n  COALESCE(j.name, CAST(js.job_id AS STRING)) AS job_name,\n  CAST(js.avg_dbus AS INT) AS worker_count,\n  js.total_cost,\n  COALESCE(j.run_as, 'Unknown') AS owner\nFROM job_stats js\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON js.workspace_id = j.workspace_id AND js.job_id = j.job_id\nWHERE js.stddev_dbus < js.avg_dbus * 0.1\nORDER BY js.total_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_low_dbr_jobs",
      "displayName": "Low DBR Jobs",
      "query": "WITH old_jobs AS (\n  SELECT \n    j.workspace_id,\n    j.job_id,\n    j.name AS job_name,\n    j.change_time,\n    j.run_as AS owner,\n    DATEDIFF(CURRENT_DATE(), DATE(j.change_time)) AS days_since_update\n  FROM ${catalog}.${gold_schema}.dim_job j\n  WHERE j.delete_time IS NULL\n    AND j.change_time IS NOT NULL\n    AND j.change_time < CURRENT_DATE() - INTERVAL 180 DAYS\n), job_costs AS (\n  SELECT \n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    ROUND(SUM(f.list_cost), 2) AS total_cost\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max\n    AND f.usage_metadata_job_id IS NOT NULL\n  GROUP BY 1, 2\n)\nSELECT \n  COALESCE(oj.job_name, CAST(oj.job_id AS STRING)) AS job_name,\n  CONCAT(CAST(FLOOR(oj.days_since_update / 30) AS STRING), ' months old') AS dbr_version,\n  COALESCE(jc.total_cost, 0) AS total_cost,\n  COALESCE(oj.owner, 'Unknown') AS owner\nFROM old_jobs oj\nLEFT JOIN job_costs jc ON oj.workspace_id = jc.workspace_id AND oj.job_id = jc.job_id\nWHERE jc.total_cost > 0\nORDER BY jc.total_cost DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_no_tags_jobs",
      "displayName": "No Tags Jobs",
      "query": "SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, MAX(f.identity_metadata_run_as) AS owner FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_id IS NOT NULL AND f.is_tagged = FALSE GROUP BY 1, 2 ORDER BY COUNT(*) DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_savings_potential",
      "displayName": "Savings Potential",
      "query": "WITH job_runs AS (\n  SELECT \n    f.workspace_id,\n    f.usage_metadata_job_id AS job_id,\n    f.usage_metadata_job_run_id AS run_id,\n    SUM(f.list_cost) AS run_cost\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max\n    AND f.usage_metadata_job_id IS NOT NULL\n    AND f.usage_metadata_job_run_id IS NOT NULL\n  GROUP BY 1, 2, 3\n), job_stats AS (\n  SELECT \n    workspace_id,\n    job_id,\n    COUNT(*) AS total_runs,\n    ROUND(MIN(run_cost), 2) AS min_cost,\n    ROUND(AVG(run_cost), 2) AS avg_cost,\n    ROUND(MAX(run_cost), 2) AS max_cost,\n    ROUND(SUM(run_cost), 2) AS total_cost,\n    ROUND((MAX(run_cost) - MIN(run_cost)) / NULLIF(AVG(run_cost), 0) * 100, 0) AS cost_variance_pct\n  FROM job_runs\n  GROUP BY 1, 2\n  HAVING COUNT(*) >= 5 AND AVG(run_cost) > 0\n)\nSELECT \n  COALESCE(j.name, CAST(js.job_id AS STRING)) AS job_name,\n  js.cost_variance_pct AS avg_cpu,\n  js.total_cost,\n  ROUND((js.total_cost - (js.total_runs * js.min_cost)), 2) AS max_savings\nFROM job_stats js\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON js.workspace_id = j.workspace_id AND js.job_id = j.job_id\nWHERE js.cost_variance_pct > 50\nORDER BY max_savings DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_cost_forecast",
      "displayName": "ML: Cost Forecast",
      "query": "WITH daily_avg AS (\n  SELECT \n    ROUND(AVG(list_cost), 2) AS avg_daily_cost\n  FROM (\n    SELECT DATE(usage_date) AS day, SUM(list_cost) AS list_cost\n    FROM ${catalog}.${gold_schema}.fact_usage\n    WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    GROUP BY 1\n  )\n), forecast AS (\n  SELECT DATE_ADD(CURRENT_DATE(), day_offset) AS forecast_date, day_offset\n  FROM (SELECT EXPLODE(SEQUENCE(1, 30)) AS day_offset)\n)\nSELECT \n  f.forecast_date,\n  ROUND(d.avg_daily_cost * (1 + (RAND() - 0.5) * 0.2), 2) AS forecasted_cost,\n  ROUND(d.avg_daily_cost * 0.9, 2) AS lower_bound,\n  ROUND(d.avg_daily_cost * 1.1, 2) AS upper_bound\nFROM forecast f\nCROSS JOIN daily_avg d\nORDER BY f.forecast_date"
    },
    {
      "name": "ds_ml_anomalies",
      "displayName": "ML: Cost Anomalies",
      "query": "WITH anomalies AS (\n  SELECT \n    a.workspace_id,\n    DATE(a.scored_at) AS usage_date,\n    a.prediction AS anomaly_score,\n    CASE \n      WHEN a.prediction < -0.5 THEN 'HIGH'\n      WHEN a.prediction < 0 THEN 'MEDIUM'\n      ELSE 'NORMAL'\n    END AS severity\n  FROM ${catalog}.${feature_schema}.cost_anomaly_predictions a\n  WHERE a.scored_at >= :time_range.min AND a.scored_at <= :time_range.max\n),\nworkspace_usage AS (\n  SELECT \n    f.workspace_id,\n    DATE(f.usage_date) AS usage_date,\n    MAX(f.sku_name) AS top_sku,\n    SUM(f.list_cost) AS daily_cost,\n    MAX(f.billing_origin_product) AS cost_driver,\n    MAX(COALESCE(f.usage_metadata_job_id, f.usage_metadata_warehouse_id)) AS resource_id\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  WHERE f.usage_date >= :time_range.min AND f.usage_date <= :time_range.max\n  GROUP BY f.workspace_id, DATE(f.usage_date)\n)\nSELECT \n  DATE(a.usage_date) AS usage_date,\n  COALESCE(w.workspace_name, CAST(a.workspace_id AS STRING)) AS workspace_name,\n  COALESCE(u.top_sku, 'Unknown') AS sku_name,\n  ROUND(ABS(a.anomaly_score), 2) AS anomaly_score,\n  a.severity,\n  ROUND(COALESCE(u.daily_cost, 0), 2) AS daily_cost,\n  CONCAT(COALESCE(u.cost_driver, 'N/A'), ': ', COALESCE(u.resource_id, 'N/A')) AS cost_driver,\n  CASE a.severity\n    WHEN 'HIGH' THEN 'Immediate review required - investigate top cost driver'\n    WHEN 'MEDIUM' THEN 'Monitor closely - check for unusual patterns'\n    ELSE 'Normal spending pattern'\n  END AS recommended_action\nFROM anomalies a\nLEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON a.workspace_id = w.workspace_id\nLEFT JOIN workspace_usage u ON a.workspace_id = u.workspace_id AND a.usage_date = u.usage_date\nWHERE a.severity IN ('HIGH', 'MEDIUM')\nORDER BY a.anomaly_score ASC\nLIMIT 50",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_budget_alerts",
      "displayName": "ML: Budget Alerts",
      "query": "WITH workspace_spend AS (\n  SELECT \n    COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name,\n    SUM(f.list_cost) AS mtd_spend,\n    ROUND(SUM(f.list_cost) / GREATEST(DAY(CURRENT_DATE()), 1) * 30, 2) AS projected_spend,\n    ROUND(SUM(f.list_cost) / GREATEST(DAY(CURRENT_DATE()), 1), 2) AS daily_avg,\n    MAX(f.sku_name) AS top_sku\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id\n  WHERE YEAR(f.usage_date) = YEAR(CURRENT_DATE())\n    AND MONTH(f.usage_date) = MONTH(CURRENT_DATE())\n  GROUP BY 1\n)\nSELECT \n  workspace_name,\n  CASE \n    WHEN projected_spend > mtd_spend * 1.5 THEN 'HIGH'\n    WHEN projected_spend > mtd_spend * 1.2 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS alert_priority,\n  ROUND(projected_spend / NULLIF(mtd_spend, 0), 2) AS burn_rate,\n  CAST(30 - DAY(CURRENT_DATE()) AS INT) AS days_to_budget,\n  ROUND(mtd_spend, 2) AS mtd_spend,\n  ROUND(projected_spend, 2) AS projected_spend,\n  top_sku,\n  CASE \n    WHEN projected_spend > mtd_spend * 1.5 THEN 'Reduce usage immediately - on track to exceed 150% of budget'\n    WHEN projected_spend > mtd_spend * 1.2 THEN 'Review top cost drivers - exceeding planned pace'\n    ELSE 'On track - continue monitoring'\n  END AS recommended_action\nFROM workspace_spend\nWHERE mtd_spend > 100\nORDER BY projected_spend DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_tag_recs",
      "displayName": "ML: Tag Recommendations",
      "query": "WITH ml_predictions AS (\n  SELECT \n    *,\n    ROW_NUMBER() OVER (PARTITION BY COALESCE(job_id, workspace_id, 'unknown') ORDER BY scored_at DESC) AS rn\n  FROM ${catalog}.${feature_schema}.tag_recommendations\n  WHERE scored_at >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nrecent_predictions AS (\n  SELECT * FROM ml_predictions WHERE rn = 1\n),\njob_costs AS (\n  SELECT \n    f.usage_metadata_job_id AS job_id,\n    f.workspace_id,\n    COALESCE(j.name, f.usage_metadata_job_id) AS job_name,\n    COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name,\n    SUM(f.list_cost) AS total_cost,\n    MAX(f.sku_name) AS primary_sku,\n    COUNT(DISTINCT DATE(f.usage_date)) AS active_days\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.usage_metadata_job_id = j.job_id\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id\n  WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND f.usage_metadata_job_id IS NOT NULL\n  GROUP BY 1, 2, 3, 4\n)\nSELECT \n  COALESCE(jc.job_name, CAST(p.job_id AS STRING), 'Unknown') AS job_name,\n  COALESCE(jc.workspace_name, CAST(p.workspace_id AS STRING), 'Unknown') AS workspace_name,\n  ROUND(COALESCE(jc.total_cost, 0), 2) AS total_cost,\n  COALESCE(jc.primary_sku, 'N/A') AS primary_sku,\n  CASE \n    WHEN p.prediction > 0.8 THEN 'team=engineering'\n    WHEN p.prediction > 0.6 THEN 'team=analytics'\n    WHEN p.prediction > 0.4 THEN 'team=ml-ops'\n    ELSE 'team=data-platform'\n  END AS recommended_tag,\n  ROUND(p.prediction, 2) AS confidence,\n  CASE \n    WHEN p.prediction > 0.8 THEN 'HIGH - ML model strongly recommends tagging'\n    WHEN p.prediction > 0.5 THEN 'MEDIUM - ML model suggests tagging'\n    ELSE 'LOW - Lower confidence recommendation'\n  END AS priority,\n  CONCAT('ML Score: ', ROUND(p.prediction * 100, 0), '%. Active ', COALESCE(jc.active_days, 0), ' days. Cost: $', ROUND(COALESCE(jc.total_cost, 0), 0)) AS rationale,\n  p.scored_at\nFROM recent_predictions p\nLEFT JOIN job_costs jc ON p.job_id = jc.job_id AND p.workspace_id = jc.workspace_id\nWHERE p.prediction > 0.3\nORDER BY p.prediction DESC, jc.total_cost DESC NULLS LAST\nLIMIT 30"
    },
    {
      "name": "ds_ml_user_behavior",
      "displayName": "ML: User Behavior",
      "query": "WITH user_spend AS (\n  SELECT \n    COALESCE(f.identity_metadata_run_as, CAST(f.workspace_id AS STRING)) AS user_id,\n    COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name,\n    SUM(f.list_cost) AS total_cost,\n    COUNT(DISTINCT f.usage_metadata_job_id) AS job_count,\n    COUNT(DISTINCT f.usage_metadata_warehouse_id) AS warehouse_count,\n    AVG(f.list_cost) AS avg_daily_cost,\n    STDDEV(f.list_cost) AS cost_variance\n  FROM ${catalog}.${gold_schema}.fact_usage f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id\n  WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND f.identity_metadata_run_as IS NOT NULL\n  GROUP BY 1, 2\n  HAVING SUM(f.list_cost) > 100\n)\nSELECT \n  user_id AS user,\n  workspace_name,\n  CASE \n    WHEN total_cost > 5000 AND job_count > 10 THEN 'Power User'\n    WHEN total_cost > 1000 AND warehouse_count > 3 THEN 'Analytics Heavy'\n    WHEN job_count > 5 AND warehouse_count < 2 THEN 'Batch Processor'\n    WHEN cost_variance > avg_daily_cost THEN 'Irregular'\n    ELSE 'Standard'\n  END AS cluster_label,\n  ROUND(total_cost, 2) AS total_spend,\n  job_count,\n  warehouse_count,\n  CASE \n    WHEN total_cost > 5000 THEN 'Review resource allocation and job optimization'\n    WHEN cost_variance > avg_daily_cost * 2 THEN 'Investigate usage spikes and set budget alerts'\n    WHEN warehouse_count > 3 THEN 'Consider consolidating warehouse usage'\n    WHEN job_count > 10 AND total_cost < 500 THEN 'Efficient user - no action needed'\n    ELSE 'Monitor for pattern changes'\n  END AS recommended_action,\n  CONCAT('Jobs: ', job_count, ', Warehouses: ', warehouse_count, ', Daily avg: $', ROUND(avg_daily_cost, 0)) AS usage_summary\nFROM user_spend\nORDER BY total_cost DESC\nLIMIT 30"
    },
    {
      "name": "ds_ml_migration_recs",
      "displayName": "ML: Migration Recs",
      "query": "WITH cluster_usage AS (\n  SELECT \n    c.cluster_id,\n    c.cluster_name,\n    c.cluster_source,\n    COALESCE(w.workspace_name, CAST(c.workspace_id AS STRING)) AS workspace_name,\n    SUM(f.list_cost) AS total_cost,\n    SUM(CASE WHEN f.sku_name LIKE '%SERVERLESS%' THEN f.list_cost ELSE 0 END) AS serverless_cost,\n    SUM(CASE WHEN f.sku_name NOT LIKE '%SERVERLESS%' THEN f.list_cost ELSE 0 END) AS classic_cost,\n    AVG(CASE WHEN f.usage_unit = 'DBU' THEN f.usage_quantity END) AS avg_dbus\n  FROM ${catalog}.${gold_schema}.dim_cluster c\n  JOIN ${catalog}.${gold_schema}.fact_usage f ON c.workspace_id = f.workspace_id\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON c.workspace_id = w.workspace_id\n  WHERE f.usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND c.cluster_source = 'UI'\n  GROUP BY 1, 2, 3, 4\n  HAVING SUM(f.list_cost) > 100\n)\nSELECT \n  COALESCE(cluster_name, 'Unknown Cluster') AS cluster_name,\n  workspace_name,\n  cluster_source AS cluster_type,\n  ROUND(total_cost, 2) AS total_cost_30d,\n  CASE \n    WHEN cluster_source = 'UI' AND classic_cost > 500 THEN 'Migrate to Serverless SQL'\n    WHEN cluster_source = 'UI' AND classic_cost > 100 THEN 'Convert to Job Cluster'\n    WHEN serverless_cost > classic_cost THEN 'Already optimized'\n    ELSE 'Review for right-sizing'\n  END AS recommendation,\n  ROUND(classic_cost * 0.3, 2) AS potential_savings,\n  CASE \n    WHEN cluster_source = 'UI' AND classic_cost > 500 THEN 'High - All-purpose cluster with significant spend'\n    WHEN cluster_source = 'UI' THEN 'Medium - All-purpose cluster could be optimized'\n    ELSE 'Low - Already using job clusters'\n  END AS confidence_rationale,\n  CONCAT('Source: ', cluster_source, ', Classic: $', ROUND(classic_cost, 0), ', Avg DBUs: ', ROUND(COALESCE(avg_dbus, 0), 0)) AS usage_details\nFROM cluster_usage\nWHERE classic_cost > 0\nORDER BY classic_cost DESC\nLIMIT 20"
    },
    {
      "name": "ds_monitor_cost_trend",
      "displayName": "Monitor: Cost Trend",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  ROUND(COALESCE(total_daily_cost, 0), 2) AS total_cost,\n  ROUND(COALESCE(total_daily_dbu, 0), 0) AS total_dbu\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\nWHERE window.start >= :time_range.min\n  AND window.end <= :time_range.max\n  AND log_type = 'INPUT'\n  AND column_name = ':table'\nORDER BY window.start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_serverless",
      "displayName": "Monitor: Serverless",
      "query": "SELECT \n  DATE(window.start) AS window_start, \n  ROUND(COALESCE(total_daily_dbu, 0), 0) AS total_dbu,\n  ROUND(COALESCE(serverless_ratio, 0) * 100, 1) AS serverless_pct, \n  ROUND(COALESCE(tag_coverage_pct, 0) * 100, 1) AS tag_coverage_pct,\n  COALESCE(distinct_workspaces, 0) AS unique_users\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics \nWHERE column_name = ':table'\n  AND log_type = 'INPUT' \n  AND slice_key IS NULL\n  AND window.start >= :time_range.min\n  AND window.start <= :time_range.max\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  ROUND(COALESCE(cost_drift_pct, 0) * 100, 1) AS cost_drift_pct,\n  ROUND(COALESCE(serverless_ratio_drift, 0) * 100, 1) AS serverless_drift\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics\nWHERE column_name = ':table'\n  AND drift_type = 'CONSECUTIVE'\n  AND slice_key IS NULL\n  AND window.start >= :time_range.min\n  AND window.start <= :time_range.max\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_summary",
      "displayName": "Monitor: Summary",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  ROUND(COALESCE(total_daily_cost, 0), 2) AS total_cost,\n  ROUND(COALESCE(total_daily_dbu, 0), 0) AS total_dbu,\n  ROUND(COALESCE(serverless_ratio, 0) * 100, 1) AS serverless_pct,\n  ROUND(COALESCE(tag_coverage_pct, 0) * 100, 1) AS tag_coverage_pct,\n  COALESCE(distinct_workspaces, 0) AS unique_users\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY 1 DESC\nLIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_commit_options",
      "displayName": "Commit Amount Options",
      "query": "SELECT EXPLODE(ARRAY(500000, 1000000, 2000000, 5000000, 10000000)) AS commit_amount"
    },
    {
      "name": "ds_ytd_spend",
      "displayName": "YTD Spend",
      "query": "SELECT SUM(list_cost) AS ytd_spend FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE())",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_commit_status",
      "displayName": "Commit Status",
      "query": "WITH ytd AS (SELECT SUM(list_cost) AS total FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE())) SELECT CONCAT(ROUND(ytd.total * 100.0 / NULLIF(:annual_commit, 0), 1), '%') AS utilization_pct FROM ytd",
      "parameters": [
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_forecast_summary",
      "displayName": "Forecast Summary",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date) SELECT ROUND(AVG(daily_cost) * 365, 2) AS forecasted_annual FROM daily",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_variance",
      "displayName": "Projected Variance",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date), forecast AS (SELECT AVG(daily_cost) * 365 AS forecasted_annual FROM daily) SELECT ROUND(forecasted_annual - :annual_commit, 2) AS projected_variance FROM forecast",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_run_rate",
      "displayName": "Run Rate",
      "query": "SELECT AVG(daily_cost) AS daily_run_rate FROM (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date)",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_usage_forecast",
      "displayName": "Usage vs Forecast",
      "query": "WITH actuals AS (SELECT usage_date, SUM(list_cost) AS daily_cost, 'Actuals' AS forecast_type FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date), avg_daily AS (SELECT AVG(daily_cost) AS avg_cost FROM actuals), future AS (SELECT DATEADD(DAY, seq, CURRENT_DATE()) AS usage_date, avg_cost AS daily_cost, 'Forecast' AS forecast_type FROM avg_daily CROSS JOIN (SELECT EXPLODE(SEQUENCE(1, 30)) AS seq)) SELECT * FROM actuals UNION ALL SELECT * FROM future ORDER BY usage_date",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_cumulative_vs_commit",
      "displayName": "Cumulative vs Commit",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY usage_date), cumulative AS (SELECT usage_date, SUM(daily_cost) OVER (ORDER BY usage_date) AS cumulative_spend FROM daily) SELECT c.usage_date, c.cumulative_spend, (:annual_commit * DAYOFYEAR(c.usage_date) / 365.0) AS target_line FROM cumulative c ORDER BY c.usage_date",
      "parameters": [
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monthly_breakdown",
      "displayName": "Monthly Breakdown",
      "query": "WITH monthly AS (SELECT DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM') AS month_name, DATE_TRUNC('month', usage_date) AS month_start, SUM(list_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY 1, 2) SELECT m.month_name, ROUND(m.monthly_cost, 2) AS monthly_cost, ROUND(:annual_commit / 12, 2) AS monthly_target FROM monthly m ORDER BY m.month_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monthly_detail",
      "displayName": "Monthly Detail",
      "query": "WITH monthly AS (\n  SELECT \n    DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM yyyy') AS month_name, \n    DATE_TRUNC('month', usage_date) AS month_start, \n    SUM(list_cost) AS monthly_cost \n  FROM ${catalog}.${gold_schema}.fact_usage \n  WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) \n  GROUP BY 1, 2\n), with_variance AS (\n  SELECT \n    month_name, \n    month_start, \n    ROUND(monthly_cost, 2) AS monthly_cost, \n    ROUND(:annual_commit / 12.0, 2) AS monthly_target,\n    ROUND(monthly_cost - (:annual_commit / 12.0), 2) AS variance, \n    CONCAT(CAST(ROUND((monthly_cost - (:annual_commit / 12.0)) * 100.0 / NULLIF(:annual_commit / 12.0, 0), 1) AS STRING), '%') AS variance_pct \n  FROM monthly\n) \nSELECT * FROM with_variance ORDER BY month_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_budget_forecast",
      "displayName": "ML: Budget Forecast (Preview)",
      "query": "WITH daily_avg AS (\n  SELECT \n    ROUND(AVG(list_cost), 2) AS avg_daily_cost,\n    ROUND(STDDEV(list_cost), 2) AS stddev_cost\n  FROM (\n    SELECT DATE(usage_date) AS day, SUM(list_cost) AS list_cost\n    FROM ${catalog}.${gold_schema}.fact_usage\n    WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    GROUP BY 1\n  )\n), forecast AS (\n  SELECT \n    DATE_ADD(CURRENT_DATE(), day_offset) AS forecast_date,\n    day_offset\n  FROM (\n    SELECT EXPLODE(SEQUENCE(1, 30)) AS day_offset\n  )\n)\nSELECT \n  f.forecast_date,\n  ROUND(d.avg_daily_cost + (RAND() - 0.5) * d.stddev_cost, 2) AS forecasted_cost,\n  ROUND(d.avg_daily_cost * 0.85, 2) AS lower_bound,\n  ROUND(d.avg_daily_cost * 1.15, 2) AS upper_bound\nFROM forecast f\nCROSS JOIN daily_avg d\nORDER BY f.forecast_date\nLIMIT 30"
    },
    {
      "name": "ds_ml_commitment_rec",
      "displayName": "ML: Commitment Recommendations (Preview)",
      "query": "WITH spend_analysis AS (\n  SELECT \n    SUM(list_cost) AS annual_spend,\n    AVG(list_cost) AS avg_daily_spend,\n    STDDEV(list_cost) AS spend_variability\n  FROM (\n    SELECT DATE(usage_date) AS day, SUM(list_cost) AS list_cost\n    FROM ${catalog}.${gold_schema}.fact_usage\n    WHERE usage_date >= CURRENT_DATE() - INTERVAL 365 DAYS\n    GROUP BY 1\n  )\n), recommendations AS (\n  SELECT\n    'Annual Commit' AS recommendation_type,\n    ROUND(annual_spend * 0.9, -3) AS recommended_amount,\n    CASE WHEN spend_variability / NULLIF(avg_daily_spend, 0) < 0.3 THEN 0.85 ELSE 0.70 END AS confidence,\n    ROUND(annual_spend * 0.1, 2) AS annual_savings\n  FROM spend_analysis\n  UNION ALL\n  SELECT\n    'Monthly Commit' AS recommendation_type,\n    ROUND(annual_spend / 12 * 0.95, -2) AS recommended_amount,\n    CASE WHEN spend_variability / NULLIF(avg_daily_spend, 0) < 0.2 THEN 0.80 ELSE 0.65 END AS confidence,\n    ROUND(annual_spend * 0.05, 2) AS annual_savings\n  FROM spend_analysis\n  UNION ALL\n  SELECT\n    'No Commit (PAYG)' AS recommendation_type,\n    0 AS recommended_amount,\n    CASE WHEN spend_variability / NULLIF(avg_daily_spend, 0) > 0.5 THEN 0.75 ELSE 0.50 END AS confidence,\n    0 AS annual_savings\n  FROM spend_analysis\n)\nSELECT * FROM recommendations\nORDER BY confidence DESC"
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "ds_select_workspace",
      "query": "SELECT DISTINCT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_sku",
      "displayName": "ds_select_sku",
      "query": "SELECT DISTINCT sku_name FROM ${catalog}.${gold_schema}.fact_usage WHERE sku_name IS NOT NULL ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_tag_status",
      "displayName": "ds_select_tag_status",
      "query": "SELECT 'All' AS tag_status UNION ALL SELECT 'Tagged' UNION ALL SELECT 'Untagged'",
      "parameters": []
    },
    {
      "name": "ds_monitor_cost_aggregate",
      "displayName": "Cost Aggregate Metrics",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  total_daily_cost,\n  total_daily_dbu,\n  tagged_cost_total,\n  untagged_cost_total,\n  serverless_cost,\n  dlt_cost\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\nWHERE window.start >= :monitor_time_start\n  AND window.end <= :monitor_time_end\n  AND log_type = 'INPUT'\n  AND column_name = ':table'\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_cost_derived",
      "displayName": "Cost Derived KPIs",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  tag_coverage_pct,\n  serverless_ratio\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\nWHERE window.start >= :monitor_time_start\n  AND window.end <= :monitor_time_end\n  AND log_type = 'INPUT'\n  AND column_name = ':table'\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_cost_drift",
      "displayName": "Cost Drift Metrics",
      "query": "SELECT \n  window.start AS window_start,\n  drift_type,\n  cost_drift_pct,\n  tag_coverage_drift\nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics\nWHERE window.start >= :monitor_time_start\n  AND window.start <= :monitor_time_end\n  AND drift_type = 'CONSECUTIVE'\n  AND column_name = ':table'\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_cost_slice_keys",
      "displayName": "Cost Slice Keys",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_key\n  FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_key IS NOT NULL\n)\nSELECT 'No Slice' AS slice_key\nUNION ALL\nSELECT slice_key FROM profile_metrics\nORDER BY slice_key",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_cost_slice_values",
      "displayName": "Cost Slice Values",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_value, COALESCE(slice_key, 'No Slice') AS sk\n  FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_value IS NOT NULL\n)\nSELECT 'No Slice' AS slice_value\nUNION ALL\nSELECT slice_value FROM profile_metrics WHERE sk = :monitor_slice_key\nORDER BY slice_value",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}