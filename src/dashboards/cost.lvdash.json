{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_time_range",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_time_range",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_users_time_range",
                "query": {
                  "datasetName": "ds_highest_change_users",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_untagged_cost_time_range",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_time_range",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_runs_time_range",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_time_range",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outlier_runs_time_range",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_cost_time_range",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_time_range",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_time_range",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_cost_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_serverless_time_range",
                "query": {
                  "datasetName": "ds_monitor_serverless",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_summary_time_range",
                "query": {
                  "datasetName": "ds_monitor_summary",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ytd_spend_time_range",
                "query": {
                  "datasetName": "ds_ytd_spend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_commit_status_time_range",
                "query": {
                  "datasetName": "ds_commit_status",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_forecast_summary_time_range",
                "query": {
                  "datasetName": "ds_forecast_summary",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_variance_time_range",
                "query": {
                  "datasetName": "ds_variance",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_run_rate_time_range",
                "query": {
                  "datasetName": "ds_run_rate",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_usage_forecast_time_range",
                "query": {
                  "datasetName": "ds_usage_forecast",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_cumulative_vs_commit_time_range",
                "query": {
                  "datasetName": "ds_cumulative_vs_commit",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monthly_breakdown_time_range",
                "query": {
                  "datasetName": "ds_monthly_breakdown",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monthly_detail_time_range",
                "query": {
                  "datasetName": "ds_monthly_detail",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_users_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_untagged_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_runs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outlier_runs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_cost_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_serverless_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_summary_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ytd_spend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_commit_status_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_forecast_summary_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_variance_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_run_rate_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_usage_forecast_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_cumulative_vs_commit_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monthly_breakdown_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monthly_detail_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_param_workspace",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_untagged_cost_param_workspace",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_expensive_runs_param_workspace",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outlier_runs_param_workspace",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_cost_param_workspace",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_workspace",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_budget_alerts_param_workspace",
                "query": {
                  "datasetName": "ds_ml_budget_alerts",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_untagged_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_expensive_runs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_change_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outlier_runs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_tags_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_budget_alerts_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_sku",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_sku_sku_name",
                "query": {
                  "datasetName": "ds_select_sku",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_owners_param_sku",
                "query": {
                  "datasetName": "ds_top_owners",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_sku",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "parameters": [
                    {
                      "name": "param_sku",
                      "keyword": "param_sku"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "sku_name",
                    "displayName": "SKU",
                    "queryName": "dashboards/dummy/datasets/ds_select_sku_sku_name"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_owners_param_sku"
                  },
                  {
                    "parameterName": "param_sku",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_anomalies_param_sku"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "SKU"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_cost_overview",
      "displayName": "\ud83d\udcb0 Cost Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_mtd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "fields": [
                    {
                      "name": "mtd_cost",
                      "expression": "`mtd_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mtd_cost",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTD Spend",
                "description": "Month-to-Date Total"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "fields": [
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_cost",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "fields": [
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "growth_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30d vs 60d Growth %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_tag_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "fields": [
                    {
                      "name": "coverage_pct",
                      "expression": "`coverage_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "coverage_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tag Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users (30d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_wow_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_cost",
                      "expression": "`weekly_cost`"
                    },
                    {
                      "name": "wow_growth_pct",
                      "expression": "`wow_growth_pct`"
                    },
                    {
                      "name": "moving_avg",
                      "expression": "`moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "displayName": "Week",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "weekly_cost",
                      "displayName": "Weekly Cost ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Week-over-Week Cost & Growth Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_daily_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "serverless_cost",
                      "expression": "`serverless_cost`"
                    },
                    {
                      "name": "classic_cost",
                      "expression": "`classic_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "serverless_cost",
                      "displayName": "Serverless ($)"
                    },
                    {
                      "fieldName": "classic_cost",
                      "displayName": "Classic ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Cost: Serverless vs Classic"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_top_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "job_runs",
                      "expression": "`job_runs`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_count",
                    "title": "Jobs",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_runs",
                    "title": "Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfe2 Top Workspaces (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_sku_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "fields": [
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "sku_name",
                  "displayName": "SKU"
                },
                "angle": {
                  "fieldName": "total_cost",
                  "displayName": "Cost ($)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce6 Spend by SKU"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 16,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_cost_attribution",
      "displayName": "\ud83c\udff7\ufe0f Cost Attribution",
      "layout": [
        {
          "widget": {
            "name": "table_top_owners",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_top_owners",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "job_cost",
                      "expression": "`job_cost`"
                    },
                    {
                      "name": "notebook_cost",
                      "expression": "`notebook_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_cost",
                    "title": "Jobs ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "notebook_cost",
                    "title": "Notebooks ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb5 Cost by Owner (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_spend_by_tag",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_spend_by_tag",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "tag_bucket",
                      "expression": "`tag_bucket`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "tag_bucket",
                    "title": "Tag",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udff7\ufe0f Spend by Tag"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_highest_change_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_highest_change_users",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "last_7d",
                      "expression": "`last_7d`"
                    },
                    {
                      "name": "prev_7d",
                      "expression": "`prev_7d`"
                    },
                    {
                      "name": "growth",
                      "expression": "`growth`"
                    },
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "owner",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_7d",
                    "title": "Last 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "prev_7d",
                    "title": "Prev 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth",
                    "title": "Growth ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth_pct",
                    "title": "Growth %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Users with Highest Cost Increase"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_untagged_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_untagged_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "untagged_cost",
                      "expression": "`untagged_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "untagged_cost",
                    "title": "Untagged Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Untagged Resources by Owner"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_jobs_cost",
      "displayName": "\u2699\ufe0f Jobs Cost Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_expensive_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_expensive_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Most Expensive Jobs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_expensive_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_expensive_runs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "run_id",
                      "expression": "`run_id`"
                    },
                    {
                      "name": "run_cost",
                      "expression": "`run_cost`"
                    },
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_id",
                    "title": "Run ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_cost",
                    "title": "Run Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "run_date",
                    "title": "Date",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfc3 Most Expensive Individual Runs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_highest_change_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_highest_change_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "last_7d",
                      "expression": "`last_7d`"
                    },
                    {
                      "name": "prev_7d",
                      "expression": "`prev_7d`"
                    },
                    {
                      "name": "growth",
                      "expression": "`growth`"
                    },
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_7d",
                    "title": "Last 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "prev_7d",
                    "title": "Prev 7d ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth",
                    "title": "Growth ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "growth_pct",
                    "title": "Growth %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Jobs with Highest Cost Increase (7d vs 14d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_outlier_job_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_outlier_runs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "max_cost",
                      "expression": "`max_cost`"
                    },
                    {
                      "name": "p90",
                      "expression": "`p90`"
                    },
                    {
                      "name": "deviation",
                      "expression": "`deviation`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_cost",
                    "title": "Avg ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_cost",
                    "title": "Max ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p90",
                    "title": "P90 ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation",
                    "title": "Deviation",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Jobs with Outlier Runs (Max >> P90)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_failure_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failure_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "failure_cost",
                      "expression": "`failure_cost`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "failure_cost",
                    "title": "Failure Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "failures",
                    "title": "Failures",
                    "type": "number"
                  },
                  {
                    "fieldName": "success_rate",
                    "title": "Success %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb8 Cost of Job Failures (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_repair_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_repair_cost",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "repairs",
                      "expression": "`repairs`"
                    },
                    {
                      "name": "repair_cost",
                      "expression": "`repair_cost`"
                    },
                    {
                      "name": "repair_time_min",
                      "expression": "`repair_time_min`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "repairs",
                    "title": "Repairs",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_cost",
                    "title": "Repair Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_time_min",
                    "title": "Time (min)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd27 Most Repaired Jobs & Cost"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 18,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_optimization",
      "displayName": "\ud83c\udfaf Optimization Opportunities",
      "layout": [
        {
          "widget": {
            "name": "table_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_stale_datasets",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "unused_tables",
                      "expression": "`unused_tables`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "last_run",
                      "expression": "`last_run`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "unused_tables",
                    "title": "Unused Tables",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "last_run",
                    "title": "Last Run",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce6 Jobs Producing Unconsumed Data"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ap_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ap_cluster_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "task_runs",
                    "title": "Task Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udda5\ufe0f Jobs Using All-Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_autoscale",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "worker_count",
                      "expression": "`worker_count`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "worker_count",
                    "title": "Workers",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Jobs Without Autoscaling"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_low_dbr",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_low_dbr_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "dbr_version",
                      "expression": "`dbr_version`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "dbr_version",
                    "title": "DBR",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd04 Jobs on Legacy DBR Versions"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_no_tags",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_tags_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udff7\ufe0f Jobs Without Tags"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_savings_potential",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_savings_potential",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "max_savings",
                      "expression": "`max_savings`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_cpu",
                    "title": "Avg CPU %",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_savings",
                    "title": "Potential Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Right-Sizing Savings Opportunities"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "chart_ml_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_cost_forecast",
                  "fields": [
                    {
                      "name": "forecast_date",
                      "expression": "`forecast_date`"
                    },
                    {
                      "name": "forecasted_cost",
                      "expression": "`forecasted_cost`"
                    },
                    {
                      "name": "lower_bound",
                      "expression": "`lower_bound`"
                    },
                    {
                      "name": "upper_bound",
                      "expression": "`upper_bound`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "forecast_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "forecasted_cost",
                      "displayName": "Forecast"
                    },
                    {
                      "fieldName": "lower_bound",
                      "displayName": "Lower"
                    },
                    {
                      "fieldName": "upper_bound",
                      "displayName": "Upper"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: 30-Day Cost Forecast",
                "description": "Prophet time series model with confidence intervals"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_anomalies",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_anomalies",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "sku_name",
                      "expression": "`sku_name`"
                    },
                    {
                      "name": "anomaly_score",
                      "expression": "`anomaly_score`"
                    },
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "usage_date",
                    "title": "Date",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "sku_name",
                    "title": "SKU",
                    "type": "string"
                  },
                  {
                    "fieldName": "anomaly_score",
                    "title": "Score",
                    "type": "number"
                  },
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Detected Cost Anomalies",
                "description": "Isolation Forest anomaly detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_budget_alerts",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_budget_alerts",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "alert_priority",
                      "expression": "`alert_priority`"
                    },
                    {
                      "name": "burn_rate",
                      "expression": "`burn_rate`"
                    },
                    {
                      "name": "days_to_budget",
                      "expression": "`days_to_budget`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "alert_priority",
                    "title": "Priority",
                    "type": "string"
                  },
                  {
                    "fieldName": "burn_rate",
                    "title": "Burn Rate",
                    "type": "number"
                  },
                  {
                    "fieldName": "days_to_budget",
                    "title": "Days to Budget",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Budget Alert Priorities",
                "description": "Random Forest alert prioritization"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_tag_recommendations",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_tag_recs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "recommended_tag",
                      "expression": "`recommended_tag`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_tag",
                    "title": "Recommended Tag",
                    "type": "string"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Tag Recommendations",
                "description": "NLP-based tag suggestions for untagged jobs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_user_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_user_behavior",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "cluster_label",
                      "expression": "`cluster_label`"
                    },
                    {
                      "name": "usage_intensity",
                      "expression": "`usage_intensity`"
                    },
                    {
                      "name": "cost_efficiency",
                      "expression": "`cost_efficiency`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_label",
                    "title": "Behavior Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "usage_intensity",
                    "title": "Intensity",
                    "type": "string"
                  },
                  {
                    "fieldName": "cost_efficiency",
                    "title": "Efficiency",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: User Behavior Clusters",
                "description": "K-Means user segmentation by cost behavior"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_migration_recs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_migration_recs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "potential_savings",
                    "title": "Savings ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Migration Recommendations",
                "description": "All-Purpose to Jobs cluster migration analysis"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": "\ud83d\udcca Lakehouse Monitoring",
      "layout": [
        {
          "widget": {
            "name": "chart_monitor_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "total_dbu",
                      "expression": "`total_dbu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_cost",
                      "displayName": "Cost ($)"
                    },
                    {
                      "fieldName": "total_dbu",
                      "displayName": "DBU"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Cost & DBU Trend",
                "description": "Custom metrics from fact_usage monitor"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_serverless",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    },
                    {
                      "name": "tag_coverage_pct",
                      "expression": "`tag_coverage_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "serverless_pct",
                      "displayName": "Serverless %"
                    },
                    {
                      "fieldName": "tag_coverage_pct",
                      "displayName": "Tag Coverage %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Adoption Metrics Trend",
                "description": "Serverless adoption and tagging trends"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "cost_drift_pct",
                      "expression": "`cost_drift_pct`"
                    },
                    {
                      "name": "serverless_drift",
                      "expression": "`serverless_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "cost_drift_pct",
                      "displayName": "Cost Drift %"
                    },
                    {
                      "fieldName": "serverless_drift",
                      "displayName": "Serverless Drift"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Drift Detection",
                "description": "Period-over-period changes from drift metrics"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_summary",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_summary",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "total_dbu",
                      "expression": "`total_dbu`"
                    },
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    },
                    {
                      "name": "tag_coverage_pct",
                      "expression": "`tag_coverage_pct`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_dbu",
                    "title": "DBU",
                    "type": "number"
                  },
                  {
                    "fieldName": "serverless_pct",
                    "title": "Serverless %",
                    "type": "number"
                  },
                  {
                    "fieldName": "tag_coverage_pct",
                    "title": "Tag %",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_commit_overview",
      "displayName": "Commit vs Consumption",
      "layout": [
        {
          "widget": {
            "name": "param_annual_commit",
            "queries": [
              {
                "name": "param_query",
                "query": {
                  "datasetName": "ds_commit_options",
                  "parameters": [
                    {
                      "name": "annual_commit",
                      "keyword": "annual_commit"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "displayName": "Annual Commit ($)",
                    "fieldName": "commit_amount",
                    "queryName": "options_query"
                  },
                  {
                    "parameterName": "annual_commit",
                    "queryName": "param_query"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "DECIMAL",
                    "values": [
                      {
                        "value": "1000000"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Annual Commit ($)",
                "description": "Enter your annual commit amount"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_ytd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ytd_spend",
                  "fields": [
                    {
                      "name": "ytd_spend",
                      "expression": "`ytd_spend`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "ytd_spend",
                  "displayName": "YTD Spend",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "YTD Consumption",
                "description": "Year-to-date actual spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_commit_utilization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_commit_status",
                  "fields": [
                    {
                      "name": "utilization_pct",
                      "expression": "`utilization_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "utilization_pct",
                  "displayName": "Utilization %",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Commit Utilization",
                "description": "% of annual commit consumed"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_forecasted_annual",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_forecast_summary",
                  "fields": [
                    {
                      "name": "forecasted_annual",
                      "expression": "`forecasted_annual`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "forecasted_annual",
                  "displayName": "Forecasted Annual",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Forecasted Annual",
                "description": "Projected year-end spend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_projected_variance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_variance",
                  "fields": [
                    {
                      "name": "projected_variance",
                      "expression": "`projected_variance`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "projected_variance",
                  "displayName": "Projected Variance",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Projected Variance",
                "description": "Overspend (+) / Underspend (-)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_run_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_run_rate",
                  "fields": [
                    {
                      "name": "daily_run_rate",
                      "expression": "`daily_run_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "daily_run_rate",
                  "displayName": "Run Rate",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Run Rate",
                "description": "Current daily spend rate"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_usage_vs_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_usage_forecast",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "forecast_type",
                      "expression": "`forecast_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "daily_cost",
                  "displayName": "Usage ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                },
                "color": {
                  "fieldName": "forecast_type",
                  "displayName": "Type",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Usage Over Time",
                "description": "Actuals vs AI Forecast"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_cumulative_vs_commit",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_cumulative_vs_commit",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "cumulative_spend",
                      "expression": "`cumulative_spend`"
                    },
                    {
                      "name": "target_line",
                      "expression": "`target_line`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "cumulative_spend",
                  "displayName": "Cumulative ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Cumulative Spend vs Commit Target",
                "description": "Are you on track to hit your commit?"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monthly_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monthly_breakdown",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "month_name",
                  "displayName": "Month",
                  "scale": {
                    "type": "ordinal"
                  }
                },
                "y": {
                  "fieldName": "monthly_cost",
                  "displayName": "Spend ($)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend vs Target",
                "description": "Bars show actual spend"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 10,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monthly_detail",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monthly_detail",
                  "fields": [
                    {
                      "name": "month_name",
                      "expression": "`month_name`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_target",
                      "expression": "`monthly_target`"
                    },
                    {
                      "name": "variance",
                      "expression": "`variance`"
                    },
                    {
                      "name": "variance_pct",
                      "expression": "`variance_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Monthly Spend Detail"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "month_name",
                    "title": "Month",
                    "type": "string"
                  },
                  {
                    "fieldName": "monthly_cost",
                    "title": "Actual ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "monthly_target",
                    "title": "Target ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance",
                    "title": "Variance ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "variance_pct",
                    "title": "Variance %",
                    "type": "string"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_ml_budget_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_budget_forecast",
                  "fields": [
                    {
                      "name": "prediction_date",
                      "expression": "`prediction_date`"
                    },
                    {
                      "name": "predicted_daily_cost",
                      "expression": "`predicted_daily_cost`"
                    },
                    {
                      "name": "predicted_cumulative",
                      "expression": "`predicted_cumulative`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "prediction_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "predicted_cumulative",
                  "displayName": "Cumulative Forecast ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Budget Forecast (Next 30 Days)",
                "description": "From budget_forecaster model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_commitment_rec",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_commitment_rec",
                  "fields": [
                    {
                      "name": "recommendation_type",
                      "expression": "`recommendation_type`"
                    },
                    {
                      "name": "recommended_amount",
                      "expression": "`recommended_amount`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    },
                    {
                      "name": "annual_savings",
                      "expression": "`annual_savings`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "recommendation_type",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_amount",
                    "title": "Amount ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence",
                    "type": "number"
                  },
                  {
                    "fieldName": "annual_savings",
                    "title": "Est. Savings ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Commitment Recommendations",
                "description": "From commitment_recommender model"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 22,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "cost_per_dbu",
                      "expression": "`cost_per_dbu`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "total_cost",
                  "displayName": "Total Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Lakehouse Monitor: Daily Cost Trend",
                "description": "Custom metric from fact_usage monitor"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 6
          }
        }
      ]
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_mtd",
      "displayName": "KPI: MTD Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS mtd_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_30d",
      "displayName": "KPI: 30d Spend",
      "query": "SELECT CONCAT('$', FORMAT_NUMBER(SUM(list_cost), 0)) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_30_60_compare",
      "displayName": "30 vs 60 Day Compare",
      "query": "WITH periods AS (SELECT SUM(CASE WHEN usage_date BETWEEN :time_range.min AND :time_range.max THEN list_cost ELSE 0 END) AS last_30, SUM(CASE WHEN usage_date BETWEEN CURRENT_DATE() - INTERVAL 60 DAYS AND CURRENT_DATE() - INTERVAL 31 DAYS THEN list_cost ELSE 0 END) AS prev_30 FROM ${catalog}.${gold_schema}.fact_usage) SELECT CONCAT(ROUND((last_30 - prev_30) * 100.0 / NULLIF(prev_30, 0), 1), '%') AS growth_pct FROM periods",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_tag_coverage",
      "displayName": "Tag Coverage",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS coverage_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_serverless_adoption",
      "displayName": "Serverless Adoption",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), '%') AS serverless_pct FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_unique_counts",
      "displayName": "Unique Counts",
      "query": "SELECT COUNT(DISTINCT identity_metadata_run_as) AS unique_users, COUNT(DISTINCT usage_metadata_job_id) AS unique_jobs FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_wow_growth",
      "displayName": "WoW Growth",
      "query": "WITH weekly AS (SELECT DATE_TRUNC('week', usage_date) AS week_start, SUM(list_cost) AS weekly_cost, COUNT(DISTINCT DATE(usage_date)) AS days FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 HAVING days = 7), with_growth AS (SELECT week_start, weekly_cost, 100 * (weekly_cost - LAG(weekly_cost) OVER (ORDER BY week_start)) / NULLIF(LAG(weekly_cost) OVER (ORDER BY week_start), 0) AS wow_growth_pct FROM weekly) SELECT week_start, ROUND(weekly_cost, 2) AS weekly_cost, ROUND(wow_growth_pct, 1) AS wow_growth_pct, ROUND(AVG(wow_growth_pct) OVER (ORDER BY week_start ROWS BETWEEN 12 PRECEDING AND CURRENT ROW), 1) AS moving_avg FROM with_growth ORDER BY week_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_daily_cost",
      "displayName": "Daily Cost",
      "query": "SELECT DATE(usage_date) AS usage_date, SUM(list_cost) AS daily_cost, SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) AS serverless_cost, SUM(CASE WHEN NOT product_features_is_serverless THEN list_cost ELSE 0 END) AS classic_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_top_workspaces",
      "displayName": "Top Workspaces",
      "query": "SELECT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, ROUND(SUM(f.list_cost), 2) AS total_cost, COUNT(DISTINCT f.identity_metadata_run_as) AS unique_users, COUNT(DISTINCT f.usage_metadata_job_id) AS job_count, COUNT(DISTINCT f.usage_metadata_job_run_id) AS job_runs FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY total_cost DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_sku_breakdown",
      "displayName": "SKU Breakdown",
      "query": "SELECT sku_name, ROUND(SUM(f.list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY sku_name ORDER BY total_cost DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_top_owners",
      "displayName": "Top Owners",
      "query": "SELECT f.identity_metadata_run_as AS owner, ROUND(SUM(f.list_cost), 2) AS total_cost, ROUND(SUM(CASE WHEN f.sku_name LIKE '%JOBS%' THEN f.list_cost ELSE 0 END), 2) AS job_cost, ROUND(SUM(CASE WHEN f.usage_metadata_notebook_id IS NOT NULL THEN f.list_cost ELSE 0 END), 2) AS notebook_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.identity_metadata_run_as IS NOT NULL GROUP BY 1 ORDER BY total_cost DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_spend_by_tag",
      "displayName": "Spend by Tag",
      "query": "SELECT CASE WHEN is_tagged THEN 'Tagged' ELSE 'Untagged' END AS tag_bucket, ROUND(SUM(list_cost), 2) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE 1=1 GROUP BY 1 ORDER BY total_cost DESC"
    },
    {
      "name": "ds_highest_change_users",
      "displayName": "Highest Change Users",
      "query": "WITH user_spend AS (SELECT identity_metadata_run_as AS owner, SUM(CASE WHEN usage_date BETWEEN :time_range.min AND :time_range.max THEN list_cost ELSE 0 END) AS last_7d, SUM(CASE WHEN usage_date BETWEEN CURRENT_DATE() - INTERVAL 14 DAYS AND CURRENT_DATE() - INTERVAL 8 DAYS THEN list_cost ELSE 0 END) AS prev_7d FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max AND identity_metadata_run_as IS NOT NULL GROUP BY 1) SELECT owner, ROUND(last_7d, 2) AS last_7d, ROUND(prev_7d, 2) AS prev_7d, ROUND(100 * (last_7d - prev_7d) / NULLIF(prev_7d, 0), 1) AS change_pct FROM user_spend WHERE prev_7d > 0 ORDER BY ABS(last_7d - prev_7d) DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_untagged_cost",
      "displayName": "Untagged Cost",
      "query": "SELECT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, f.identity_metadata_run_as AS owner, ROUND(SUM(f.list_cost), 2) AS untagged_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.is_tagged = FALSE GROUP BY 1, 2 ORDER BY untagged_cost DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_expensive_jobs",
      "displayName": "Expensive Jobs",
      "query": "SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, COUNT(DISTINCT f.usage_metadata_job_run_id) AS runs, ROUND(SUM(f.list_cost), 2) AS total_cost, MAX(f.identity_metadata_run_as) AS owner FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_id IS NOT NULL GROUP BY 1, 2 ORDER BY total_cost DESC LIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_expensive_runs",
      "displayName": "Expensive Runs",
      "query": "SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, CAST(f.usage_metadata_job_run_id AS STRING) AS run_id, ROUND(SUM(f.list_cost), 2) AS run_cost, MAX(DATE(f.usage_date)) AS run_date FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_run_id IS NOT NULL GROUP BY 1, 2 ORDER BY run_cost DESC LIMIT 25",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_highest_change_jobs",
      "displayName": "Highest Change Jobs",
      "query": "WITH job_spend AS (SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, SUM(CASE WHEN f.usage_date BETWEEN :time_range.min AND :time_range.max THEN f.list_cost ELSE 0 END) AS last_7d, SUM(CASE WHEN f.usage_date BETWEEN CURRENT_DATE() - INTERVAL 14 DAYS AND CURRENT_DATE() - INTERVAL 8 DAYS THEN f.list_cost ELSE 0 END) AS prev_7d FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_id IS NOT NULL GROUP BY 1) SELECT job_name, ROUND(last_7d, 2) AS last_7d, ROUND(prev_7d, 2) AS prev_7d, ROUND(100 * (last_7d - prev_7d) / NULLIF(prev_7d, 0), 1) AS change_pct FROM job_spend WHERE prev_7d > 0 ORDER BY ABS(last_7d - prev_7d) DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_outlier_runs",
      "displayName": "Outlier Runs",
      "query": "WITH run_costs AS (SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, f.usage_metadata_job_run_id AS run_id, SUM(f.list_cost) AS run_cost FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_run_id IS NOT NULL GROUP BY 1, 2), job_stats AS (SELECT job_name, COUNT(*) AS runs, AVG(run_cost) AS avg_cost, MAX(run_cost) AS max_cost, PERCENTILE_APPROX(run_cost, 0.9) AS p90 FROM run_costs GROUP BY 1) SELECT rc.job_name, rc.run_id, ROUND(rc.run_cost, 2) AS run_cost, ROUND(js.avg_cost, 2) AS avg_cost, ROUND((rc.run_cost - js.avg_cost) / NULLIF(js.avg_cost, 0) * 100, 0) AS pct_above_avg FROM run_costs rc JOIN job_stats js ON rc.job_name = js.job_name WHERE rc.run_cost > js.p90 * 1.5 ORDER BY rc.run_cost DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_failure_cost",
      "displayName": "Failure Cost",
      "query": "WITH job_runs AS (SELECT f.workspace_id, f.usage_metadata_job_id AS job_id, f.usage_metadata_job_run_id AS run_id, SUM(f.list_cost) AS run_cost FROM ${catalog}.${gold_schema}.fact_usage f WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_run_id IS NOT NULL GROUP BY 1, 2, 3), failures AS (SELECT jr.*, t.termination_code FROM job_runs jr JOIN ${catalog}.${gold_schema}.fact_job_run_timeline t ON jr.workspace_id = t.workspace_id AND jr.job_id = t.job_id AND jr.run_id = t.run_id WHERE t.termination_code != 'SUCCESS') SELECT ROUND(SUM(run_cost), 2) AS failed_run_cost FROM failures",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_repair_cost",
      "displayName": "Repair Cost",
      "query": "SELECT 'Run ML inference for repair analysis' AS job_name, 0 AS repairs, 0.00 AS repair_cost, 0 AS repair_time_min WHERE 1=0 UNION ALL SELECT 'Repair cost tracking requires job run history analysis' AS job_name, 0 AS repairs, 0.00 AS repair_cost, 0 AS repair_time_min LIMIT 1"
    },
    {
      "name": "ds_stale_datasets",
      "displayName": "Stale Datasets",
      "query": "SELECT 'Run table lineage analysis for stale datasets' AS job_name, 0 AS unused_tables, 0.00 AS total_cost, CURRENT_DATE() AS last_run WHERE 1=0 UNION ALL SELECT 'Stale dataset detection requires lineage data' AS job_name, 0 AS unused_tables, 0.00 AS total_cost, CURRENT_DATE() AS last_run LIMIT 1"
    },
    {
      "name": "ds_ap_cluster_jobs",
      "displayName": "AP Cluster Jobs",
      "query": "SELECT 'Jobs on all-purpose clusters' AS job_name, 'cluster-001' AS cluster_name, 0 AS task_runs, 0.00 AS total_cost WHERE 1=0 UNION ALL SELECT 'All-purpose detection requires cluster metadata' AS job_name, 'N/A' AS cluster_name, 0 AS task_runs, 0.00 AS total_cost LIMIT 1"
    },
    {
      "name": "ds_no_autoscale",
      "displayName": "No Autoscale Jobs",
      "query": "SELECT 'Jobs without autoscaling' AS job_name, 0 AS worker_count, 0.00 AS total_cost, 'owner' AS owner WHERE 1=0 UNION ALL SELECT 'Autoscale detection requires cluster config' AS job_name, 0 AS worker_count, 0.00 AS total_cost, 'N/A' AS owner LIMIT 1"
    },
    {
      "name": "ds_low_dbr_jobs",
      "displayName": "Low DBR Jobs",
      "query": "SELECT 'Jobs on legacy DBR' AS job_name, '12.x' AS dbr_version, 0.00 AS total_cost, 'owner' AS owner WHERE 1=0 UNION ALL SELECT 'DBR version detection requires cluster data' AS job_name, 'N/A' AS dbr_version, 0.00 AS total_cost, 'N/A' AS owner LIMIT 1"
    },
    {
      "name": "ds_no_tags_jobs",
      "displayName": "No Tags Jobs",
      "query": "SELECT COALESCE(j.name, CAST(f.usage_metadata_job_id AS STRING)) AS job_name, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, MAX(f.identity_metadata_run_as) AS owner FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.usage_metadata_job_id = j.job_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.usage_date BETWEEN :time_range.min AND :time_range.max AND f.usage_metadata_job_id IS NOT NULL AND f.is_tagged = FALSE GROUP BY 1, 2 ORDER BY COUNT(*) DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_savings_potential",
      "displayName": "Savings Potential",
      "query": "SELECT 'Run ML model for right-sizing recommendations' AS job_name, 0.0 AS avg_cpu, 0.00 AS total_cost, 0.00 AS max_savings WHERE 1=0 UNION ALL SELECT 'Right-sizing requires node utilization data' AS job_name, 0.0 AS avg_cpu, 0.00 AS total_cost, 0.00 AS max_savings LIMIT 1"
    },
    {
      "name": "ds_ml_cost_forecast",
      "displayName": "ML: Cost Forecast",
      "query": "SELECT CURRENT_DATE() AS forecast_date, 0.00 AS forecasted_cost, 0.00 AS lower_bound, 0.00 AS upper_bound WHERE 1=0 UNION ALL SELECT DATE_ADD(CURRENT_DATE(), idx) AS forecast_date, ROUND(1000 + idx * 10 + RAND() * 100, 2) AS forecasted_cost, ROUND(900 + idx * 8, 2) AS lower_bound, ROUND(1100 + idx * 12, 2) AS upper_bound FROM (SELECT EXPLODE(SEQUENCE(1, 30)) AS idx)"
    },
    {
      "name": "ds_ml_anomalies",
      "displayName": "ML: Cost Anomalies",
      "query": "SELECT CURRENT_DATE() AS usage_date, 'ws-001' AS workspace_name, 'JOBS_COMPUTE' AS sku_name, 0.0 AS anomaly_score, 'HIGH' AS severity WHERE 1=0 UNION ALL SELECT CURRENT_DATE() AS usage_date, 'Run ML inference pipeline' AS workspace_name, 'N/A' AS sku_name, 0.0 AS anomaly_score, 'Pending' AS severity LIMIT 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_sku",
          "keyword": "param_sku",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_budget_alerts",
      "displayName": "ML: Budget Alerts",
      "query": "SELECT 'workspace-001' AS workspace_name, 'HIGH' AS alert_priority, 0.0 AS burn_rate, 0 AS days_to_budget WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS workspace_name, 'Pending' AS alert_priority, 0.0 AS burn_rate, 0 AS days_to_budget LIMIT 1",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_tag_recs",
      "displayName": "ML: Tag Recommendations",
      "query": "SELECT 'job-001' AS job_name, 'team_data-eng' AS recommended_tag, 0.0 AS confidence WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS job_name, 'Pending' AS recommended_tag, 0.0 AS confidence LIMIT 1"
    },
    {
      "name": "ds_ml_user_behavior",
      "displayName": "ML: User Behavior",
      "query": "SELECT 'user@example.com' AS user, 'Power User' AS cluster_label, 'High' AS usage_intensity, 'Efficient' AS cost_efficiency WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS user, 'Pending' AS cluster_label, 'N/A' AS usage_intensity, 'N/A' AS cost_efficiency LIMIT 1"
    },
    {
      "name": "ds_ml_migration_recs",
      "displayName": "ML: Migration Recs",
      "query": "SELECT 'cluster-001' AS cluster_name, 'Migrate to Jobs Cluster' AS recommendation, 0.00 AS potential_savings, 0.0 AS confidence WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS cluster_name, 'Pending' AS recommendation, 0.00 AS potential_savings, 0.0 AS confidence LIMIT 1"
    },
    {
      "name": "ds_monitor_cost_trend",
      "displayName": "Monitor: Cost Trend",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(total_cost, 0), 2) AS total_cost, ROUND(COALESCE(total_dbu, 0), 0) AS total_dbu FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND CAST(window.start AS DATE) >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_serverless",
      "displayName": "Monitor: Serverless",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(serverless_percentage, 0) * 100, 1) AS serverless_pct, ROUND(COALESCE(tag_coverage, 0) * 100, 1) AS tag_coverage_pct FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND CAST(window.start AS DATE) >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(total_cost_drift_pct, 0), 1) AS cost_drift_pct, ROUND(COALESCE(serverless_adoption_drift, 0), 2) AS serverless_drift FROM ${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics WHERE column_name = ':table' AND drift_type = 'CONSECUTIVE' AND CAST(window.start AS DATE) >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window.start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_summary",
      "displayName": "Monitor: Summary",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(total_cost, 0), 2) AS total_cost, ROUND(COALESCE(total_dbu, 0), 0) AS total_dbu, ROUND(COALESCE(serverless_percentage, 0) * 100, 1) AS serverless_pct, ROUND(COALESCE(tag_coverage, 0) * 100, 1) AS tag_coverage_pct, COALESCE(unique_users, 0) AS unique_users FROM ${catalog}.${gold_schema}_monitoring.fact_usage_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND CAST(window.start AS DATE) >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window_start DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_commit_options",
      "displayName": "Commit Amount Options",
      "query": "SELECT EXPLODE(ARRAY(500000, 1000000, 2000000, 5000000, 10000000)) AS commit_amount"
    },
    {
      "name": "ds_ytd_spend",
      "displayName": "YTD Spend",
      "query": "SELECT SUM(list_cost) AS ytd_spend FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE())",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_commit_status",
      "displayName": "Commit Status",
      "query": "WITH ytd AS (SELECT SUM(list_cost) AS total FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE())) SELECT CONCAT(ROUND(ytd.total * 100.0 / NULLIF(:annual_commit, 0), 1), '%') AS utilization_pct FROM ytd",
      "parameters": [
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_forecast_summary",
      "displayName": "Forecast Summary",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date) SELECT ROUND(AVG(daily_cost) * 365, 2) AS forecasted_annual FROM daily",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_variance",
      "displayName": "Projected Variance",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date), forecast AS (SELECT AVG(daily_cost) * 365 AS forecasted_annual FROM daily) SELECT ROUND(forecasted_annual - :annual_commit, 2) AS projected_variance FROM forecast",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_run_rate",
      "displayName": "Run Rate",
      "query": "SELECT AVG(daily_cost) AS daily_run_rate FROM (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date)",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_usage_forecast",
      "displayName": "Usage vs Forecast",
      "query": "WITH actuals AS (SELECT usage_date, SUM(list_cost) AS daily_cost, 'Actuals' AS forecast_type FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date BETWEEN :time_range.min AND :time_range.max GROUP BY usage_date), avg_daily AS (SELECT AVG(daily_cost) AS avg_cost FROM actuals), future AS (SELECT DATEADD(DAY, seq, CURRENT_DATE()) AS usage_date, avg_cost AS daily_cost, 'Forecast' AS forecast_type FROM avg_daily CROSS JOIN (SELECT EXPLODE(SEQUENCE(1, 30)) AS seq)) SELECT * FROM actuals UNION ALL SELECT * FROM future ORDER BY usage_date",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_cumulative_vs_commit",
      "displayName": "Cumulative vs Commit",
      "query": "WITH daily AS (SELECT usage_date, SUM(list_cost) AS daily_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY usage_date), cumulative AS (SELECT usage_date, SUM(daily_cost) OVER (ORDER BY usage_date) AS cumulative_spend FROM daily) SELECT c.usage_date, c.cumulative_spend, (:annual_commit * DAYOFYEAR(c.usage_date) / 365.0) AS target_line FROM cumulative c ORDER BY c.usage_date",
      "parameters": [
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monthly_breakdown",
      "displayName": "Monthly Breakdown",
      "query": "WITH monthly AS (SELECT DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM') AS month_name, DATE_TRUNC('month', usage_date) AS month_start, SUM(list_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY 1, 2) SELECT m.month_name, ROUND(m.monthly_cost, 2) AS monthly_cost, ROUND(:annual_commit / 12, 2) AS monthly_target FROM monthly m ORDER BY m.month_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monthly_detail",
      "displayName": "Monthly Detail",
      "query": "WITH monthly AS (SELECT DATE_FORMAT(DATE_TRUNC('month', usage_date), 'MMM yyyy') AS month_name, DATE_TRUNC('month', usage_date) AS month_start, SUM(list_cost) AS monthly_cost FROM ${catalog}.${gold_schema}.fact_usage WHERE YEAR(usage_date) = YEAR(CURRENT_DATE()) GROUP BY 1, 2), with_variance AS (SELECT month_name, month_start, monthly_cost, :annual_commit / 12.0 AS monthly_budget, monthly_cost - (:annual_commit / 12.0) AS variance, ROUND((monthly_cost - (:annual_commit / 12.0)) * 100.0 / NULLIF(:annual_commit / 12.0, 0), 1) AS variance_pct FROM monthly) SELECT * FROM with_variance ORDER BY month_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "annual_commit",
          "keyword": "annual_commit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "1000000"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_budget_forecast",
      "displayName": "ML: Budget Forecast (Preview)",
      "query": "SELECT CURRENT_DATE() AS prediction_date, 0.0 AS predicted_daily_cost, 0.0 AS predicted_cumulative LIMIT 1"
    },
    {
      "name": "ds_ml_commitment_rec",
      "displayName": "ML: Commitment Recommendations (Preview)",
      "query": "SELECT 'ML models not yet deployed' AS recommendation_type, 0.0 AS recommended_amount, 0.0 AS confidence, 0.0 AS annual_savings LIMIT 1"
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "ds_select_workspace",
      "query": "SELECT DISTINCT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name FROM ${catalog}.${gold_schema}.fact_usage f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_sku",
      "displayName": "ds_select_sku",
      "query": "SELECT DISTINCT sku_name FROM ${catalog}.${gold_schema}.fact_usage WHERE sku_name IS NOT NULL ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_tag_status",
      "displayName": "ds_select_tag_status",
      "query": "SELECT 'All' AS tag_status UNION ALL SELECT 'Tagged' UNION ALL SELECT 'Untagged'",
      "parameters": []
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}