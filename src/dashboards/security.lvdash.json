{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_events_time_range",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_high_risk_time_range",
                "query": {
                  "datasetName": "ds_kpi_high_risk",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_denied_time_range",
                "query": {
                  "datasetName": "ds_kpi_denied",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_permissions_time_range",
                "query": {
                  "datasetName": "ds_kpi_permissions",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_admin_time_range",
                "query": {
                  "datasetName": "ds_kpi_admin",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_event_trend_time_range",
                "query": {
                  "datasetName": "ds_event_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_risk_trend_time_range",
                "query": {
                  "datasetName": "ds_risk_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_access_time_range",
                "query": {
                  "datasetName": "ds_denied_access",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_permission_changes_time_range",
                "query": {
                  "datasetName": "ds_permission_changes",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_by_service_time_range",
                "query": {
                  "datasetName": "ds_denied_by_service",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_by_user_time_range",
                "query": {
                  "datasetName": "ds_denied_by_user",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_admin_actions_time_range",
                "query": {
                  "datasetName": "ds_admin_actions",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sensitive_actions_time_range",
                "query": {
                  "datasetName": "ds_sensitive_actions",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_admin_by_action_time_range",
                "query": {
                  "datasetName": "ds_admin_by_action",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_data_access_time_range",
                "query": {
                  "datasetName": "ds_data_access",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_access_by_service_time_range",
                "query": {
                  "datasetName": "ds_access_by_service",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_access_hourly_time_range",
                "query": {
                  "datasetName": "ds_access_hourly",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_access_time_range",
                "query": {
                  "datasetName": "ds_monitor_access",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_events_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_high_risk_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_denied_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_permissions_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_admin_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_event_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_risk_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_access_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_permission_changes_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_by_service_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_by_user_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_admin_actions_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sensitive_actions_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_admin_by_action_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_data_access_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_access_by_service_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_access_hourly_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_access_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_service",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_service_service_name",
                "query": {
                  "datasetName": "ds_select_service",
                  "fields": [
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_access_param_service",
                "query": {
                  "datasetName": "ds_denied_access",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_by_service_param_service",
                "query": {
                  "datasetName": "ds_denied_by_service",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_admin_actions_param_service",
                "query": {
                  "datasetName": "ds_admin_actions",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sensitive_actions_param_service",
                "query": {
                  "datasetName": "ds_sensitive_actions",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_data_access_param_service",
                "query": {
                  "datasetName": "ds_data_access",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_access_by_service_param_service",
                "query": {
                  "datasetName": "ds_access_by_service",
                  "parameters": [
                    {
                      "name": "param_service",
                      "keyword": "param_service"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "service_name",
                    "displayName": "Service",
                    "queryName": "dashboards/dummy/datasets/ds_select_service_service_name"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_access_param_service"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_by_service_param_service"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_admin_actions_param_service"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sensitive_actions_param_service"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_data_access_param_service"
                  },
                  {
                    "parameterName": "param_service",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_access_by_service_param_service"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Service"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_events_param_workspace",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_event_trend_param_workspace",
                "query": {
                  "datasetName": "ds_event_trend",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_denied_access_param_workspace",
                "query": {
                  "datasetName": "ds_denied_access",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_data_access_param_workspace",
                "query": {
                  "datasetName": "ds_data_access",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_access_by_service_param_workspace",
                "query": {
                  "datasetName": "ds_access_by_service",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_events_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_event_trend_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_denied_access_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_data_access_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_access_by_service_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_security_overview",
      "displayName": "\ud83d\udd12 Security Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "fields": [
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Audit Events (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_high_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_high_risk",
                  "fields": [
                    {
                      "name": "high_risk_events",
                      "expression": "`high_risk_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 High Risk Events (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_denied_access",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_denied",
                  "fields": [
                    {
                      "name": "denied_access",
                      "expression": "`denied_access`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "denied_access",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26d4 Access Denied (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_permission_changes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_permissions",
                  "fields": [
                    {
                      "name": "permission_changes",
                      "expression": "`permission_changes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "permission_changes",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd10 Permission Changes (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_admin_actions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_admin",
                  "fields": [
                    {
                      "name": "admin_actions",
                      "expression": "`admin_actions`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "admin_actions",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc51 Admin Actions (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_event_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_event_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "event_count",
                      "expression": "`event_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "event_count",
                      "displayName": "Events"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Audit Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_risk_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_risk_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "high_risk",
                      "expression": "`high_risk`"
                    },
                    {
                      "name": "medium_risk",
                      "expression": "`medium_risk`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "high_risk",
                      "displayName": "High Risk"
                    },
                    {
                      "fieldName": "medium_risk",
                      "displayName": "Medium Risk"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Risk Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_access_control",
      "displayName": "\ud83d\udd10 Access Control",
      "layout": [
        {
          "widget": {
            "name": "table_denied_access",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_denied_access",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    },
                    {
                      "name": "event_time",
                      "expression": "`event_time`"
                    },
                    {
                      "name": "error_message",
                      "expression": "`error_message`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_name",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "service_name",
                    "title": "Service",
                    "type": "string"
                  },
                  {
                    "fieldName": "event_time",
                    "title": "Time",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "error_message",
                    "title": "Error",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26d4 Access Denied Events (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_permission_changes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_permission_changes",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "target_entity",
                      "expression": "`target_entity`"
                    },
                    {
                      "name": "event_time",
                      "expression": "`event_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_name",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "target_entity",
                    "title": "Target",
                    "type": "string"
                  },
                  {
                    "fieldName": "event_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd10 Recent Permission Changes (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_denied_by_service",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_denied_by_service",
                  "fields": [
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    },
                    {
                      "name": "denial_count",
                      "expression": "`denial_count`"
                    },
                    {
                      "name": "affected_users",
                      "expression": "`affected_users`"
                    },
                    {
                      "name": "last_denial",
                      "expression": "`last_denial`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "service_name",
                    "title": "Service"
                  },
                  {
                    "fieldName": "denial_count",
                    "title": "Denials"
                  },
                  {
                    "fieldName": "affected_users",
                    "title": "Users Affected"
                  },
                  {
                    "fieldName": "last_denial",
                    "title": "Last Denial"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "ðŸ”´ Access Denials by Service (Ordered by Count)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_denied_by_user",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_denied_by_user",
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "denial_count",
                      "expression": "`denial_count`"
                    },
                    {
                      "name": "services_affected",
                      "expression": "`services_affected`"
                    },
                    {
                      "name": "last_denial",
                      "expression": "`last_denial`"
                    },
                    {
                      "name": "last_denied_action",
                      "expression": "`last_denied_action`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User"
                  },
                  {
                    "fieldName": "denial_count",
                    "title": "Denials"
                  },
                  {
                    "fieldName": "services_affected",
                    "title": "Services"
                  },
                  {
                    "fieldName": "last_denial",
                    "title": "Last Denial"
                  },
                  {
                    "fieldName": "last_denied_action",
                    "title": "Last Action"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "ðŸ‘¤ Access Denials by User (Ordered by Count)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_admin_audit",
      "displayName": "\ud83d\udc51 Admin Audit",
      "layout": [
        {
          "widget": {
            "name": "table_admin_actions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_admin_actions",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    },
                    {
                      "name": "target_entity",
                      "expression": "`target_entity`"
                    },
                    {
                      "name": "event_time",
                      "expression": "`event_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "Admin",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_name",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "service_name",
                    "title": "Service",
                    "type": "string"
                  },
                  {
                    "fieldName": "target_entity",
                    "title": "Target",
                    "type": "string"
                  },
                  {
                    "fieldName": "event_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc51 Admin Actions (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_sensitive_actions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_sensitive_actions",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    },
                    {
                      "name": "event_time",
                      "expression": "`event_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_name",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "service_name",
                    "title": "Service",
                    "type": "string"
                  },
                  {
                    "fieldName": "event_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Sensitive Actions (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_admin_by_action",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_admin_by_action",
                  "fields": [
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "action_count",
                      "expression": "`action_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "action_name",
                  "displayName": "Action",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "action_count",
                  "displayName": "Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Admin Actions Distribution"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_data_access",
      "displayName": "\ud83d\udcca Data Access",
      "layout": [
        {
          "widget": {
            "name": "table_data_access",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_data_access",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "target_table",
                      "expression": "`target_table`"
                    },
                    {
                      "name": "access_count",
                      "expression": "`access_count`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_name",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "target_table",
                    "title": "Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "access_count",
                    "title": "Accesses",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Data Access Summary (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_access_by_service",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_access_by_service",
                  "fields": [
                    {
                      "name": "service_name",
                      "expression": "`service_name`"
                    },
                    {
                      "name": "access_count",
                      "expression": "`access_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "service_name",
                  "displayName": "Service",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "access_count",
                  "displayName": "Accesses",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd35 Access by Service"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_access_hourly",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_access_hourly",
                  "fields": [
                    {
                      "name": "hour",
                      "expression": "`hour`"
                    },
                    {
                      "name": "access_count",
                      "expression": "`access_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "hour",
                  "displayName": "Hour of Day",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "access_count",
                  "displayName": "Accesses",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f0 Access Pattern by Hour"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "table_ml_threats",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_threats",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "threat_type",
                      "expression": "`threat_type`"
                    },
                    {
                      "name": "risk_score",
                      "expression": "`risk_score`"
                    },
                    {
                      "name": "incident_summary",
                      "expression": "`incident_summary`"
                    },
                    {
                      "name": "last_action",
                      "expression": "`last_action`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "threat_type",
                    "title": "Threat Type",
                    "type": "string"
                  },
                  {
                    "fieldName": "risk_score",
                    "title": "Risk Score",
                    "type": "number"
                  },
                  {
                    "fieldName": "incident_summary",
                    "title": "Evidence",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_action",
                    "title": "Last Suspicious Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Threat Detection",
                "description": "Anomaly detection model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_exfiltration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_exfiltration",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "data_volume",
                      "expression": "`data_volume`"
                    },
                    {
                      "name": "risk_level",
                      "expression": "`risk_level`"
                    },
                    {
                      "name": "access_pattern",
                      "expression": "`access_pattern`"
                    },
                    {
                      "name": "last_action",
                      "expression": "`last_action`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "data_volume",
                    "title": "Read Operations",
                    "type": "number"
                  },
                  {
                    "fieldName": "risk_level",
                    "title": "Risk",
                    "type": "string"
                  },
                  {
                    "fieldName": "access_pattern",
                    "title": "Access Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_action",
                    "title": "Last Data Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Data Exfiltration Risk",
                "description": "Data access pattern analysis"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_privilege",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_privilege",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_identity_email",
                      "expression": "`user_identity_email`"
                    },
                    {
                      "name": "current_role",
                      "expression": "`current_role`"
                    },
                    {
                      "name": "escalation_risk",
                      "expression": "`escalation_risk`"
                    },
                    {
                      "name": "activity_summary",
                      "expression": "`activity_summary`"
                    },
                    {
                      "name": "last_action",
                      "expression": "`last_action`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity_email",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "current_role",
                    "title": "Role",
                    "type": "string"
                  },
                  {
                    "fieldName": "escalation_risk",
                    "title": "Risk",
                    "type": "string"
                  },
                  {
                    "fieldName": "activity_summary",
                    "title": "Activity Summary",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_action",
                    "title": "Last Privilege Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Privilege Escalation Risk",
                "description": "Permission and IAM activity analysis"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": "ðŸ“ˆ Security Metrics Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Total Events"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Unique Users"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "high_risk_rate",
                      "expression": "`high_risk_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk_rate",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: High Risk Rate %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_event_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "high_risk_events",
                      "expression": "`high_risk_events`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_events",
                      "displayName": "Total Events"
                    },
                    {
                      "fieldName": "high_risk_events",
                      "displayName": "High Risk"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Event Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_access_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_access",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "denied_accesses",
                      "expression": "`denied_accesses`"
                    },
                    {
                      "name": "permission_changes",
                      "expression": "`permission_changes`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "denied_accesses",
                      "displayName": "Denials"
                    },
                    {
                      "fieldName": "permission_changes",
                      "displayName": "Perm Changes"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Access Control Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "event_volume_drift",
                      "expression": "`event_volume_drift`"
                    },
                    {
                      "name": "risk_level_drift",
                      "expression": "`risk_level_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "event_volume_drift",
                      "displayName": "Volume Drift %"
                    },
                    {
                      "fieldName": "risk_level_drift",
                      "displayName": "Risk Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Security Drift Detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "high_risk_events",
                      "expression": "`high_risk_events`"
                    },
                    {
                      "name": "denied_accesses",
                      "expression": "`denied_accesses`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_events",
                    "title": "Events",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "high_risk_events",
                    "title": "High Risk",
                    "type": "number"
                  },
                  {
                    "fieldName": "denied_accesses",
                    "title": "Denials",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Security Metrics"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "security_lakehouse_monitoring",
      "displayName": "ðŸ”¬ Advanced Audit Metrics",
      "layout": [
        {
          "widget": {
            "name": "security_time_start_filter",
            "queries": [
              {
                "name": "param_ds_monitor_security_aggregate_time_start",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_derived_time_start",
                "query": {
                  "datasetName": "ds_monitor_security_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_keys_time_start",
                "query": {
                  "datasetName": "ds_monitor_security_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_values_time_start",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_security_aggregate_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_security_derived_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_security_slice_keys_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_security_slice_values_time_start"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "security_time_end_filter",
            "queries": [
              {
                "name": "param_ds_monitor_security_aggregate_time_end",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_derived_time_end",
                "query": {
                  "datasetName": "ds_monitor_security_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_keys_time_end",
                "query": {
                  "datasetName": "ds_monitor_security_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_values_time_end",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_security_aggregate_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_security_derived_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_security_slice_keys_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_security_slice_values_time_end"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "End Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "security_slice_key_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_security_slice_keys",
                  "fields": [
                    {
                      "name": "slice_key",
                      "expression": "`slice_key`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_security_aggregate_slice_key",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_derived_slice_key",
                "query": {
                  "datasetName": "ds_monitor_security_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Key",
                    "fieldName": "slice_key",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_security_aggregate_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_security_derived_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_security_slice_values_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_security_slice_values_slice_key"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Key:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "security_slice_value_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "fields": [
                    {
                      "name": "slice_value",
                      "expression": "`slice_value`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_security_aggregate_slice_value",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_derived_slice_value",
                "query": {
                  "datasetName": "ds_monitor_security_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_security_slice_values_slice_value",
                "query": {
                  "datasetName": "ds_monitor_security_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Value",
                    "fieldName": "slice_value",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_security_aggregate_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_security_derived_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_security_slice_values_slice_value"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Value:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 9,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "security_aggregate_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "distinct_users",
                      "expression": "`distinct_users`"
                    },
                    {
                      "name": "admin_actions",
                      "expression": "`admin_actions`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Total Events",
                      "fieldName": "total_events"
                    },
                    {
                      "displayName": "Distinct Users",
                      "fieldName": "distinct_users"
                    },
                    {
                      "displayName": "Admin Actions",
                      "fieldName": "admin_actions"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track security aggregate metrics over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Security Aggregate Metrics Over Time"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "security_derived_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_security_derived",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "admin_action_rate",
                      "expression": "`admin_action_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Admin Action Rate",
                      "fieldName": "admin_action_rate"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track security business ratios over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Security KPI Trends"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 6,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "security_aggregate_table",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_security_aggregate",
                  "fields": [
                    { "name": "window_start", "expression": "`window_start`" },
                    { "name": "total_events", "expression": "`total_events`" },
                    { "name": "distinct_users", "expression": "`distinct_users`" },
                    { "name": "admin_actions", "expression": "`admin_actions`" },
                    { "name": "high_risk_events", "expression": "`high_risk_events`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Security Aggregate Metrics"
              },
              "encodings": {
                "columns": [
                  { "fieldName": "window_start", "title": "Date" },
                  { "fieldName": "total_events", "title": "Total Events" },
                  { "fieldName": "distinct_users", "title": "Distinct Users" },
                  { "fieldName": "admin_actions", "title": "Admin Actions" },
                  { "fieldName": "high_risk_events", "title": "High Risk Events" }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 12,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_events",
      "displayName": "KPI: Events",
      "query": "SELECT COUNT(*) AS total_events, COUNT(DISTINCT user_identity_email) AS unique_users FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING))))",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_high_risk",
      "displayName": "KPI: High Risk",
      "query": "SELECT SUM(CASE WHEN action_name LIKE '%delete%' OR action_name LIKE '%drop%' OR action_name LIKE '%revoke%' OR action_name LIKE '%destroy%' OR action_name LIKE '%terminate%' THEN 1 ELSE 0 END) AS high_risk_events FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_denied",
      "displayName": "KPI: Denied",
      "query": "SELECT COUNT(*) AS denied_access FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (is_failed_action = true OR response_status_code >= 400 OR LOWER(action_name) LIKE '%denied%' OR LOWER(action_name) LIKE '%unauthorized%')",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_permissions",
      "displayName": "KPI: Permissions",
      "query": "SELECT SUM(CASE WHEN action_name LIKE '%grant%' OR action_name LIKE '%revoke%' OR action_name LIKE '%permission%' OR action_name LIKE '%updatePermissions%' THEN 1 ELSE 0 END) AS permission_changes FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_admin",
      "displayName": "KPI: Admin",
      "query": "SELECT SUM(CASE WHEN service_name IN ('accounts', 'settings', 'clusters', 'workspaces') OR action_name LIKE '%admin%' OR action_name LIKE '%config%' THEN 1 ELSE 0 END) AS admin_actions FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_time BETWEEN :time_range.min AND :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_event_trend",
      "displayName": "Event Trend",
      "query": "SELECT DATE(event_time) AS day, COUNT(*) AS event_count, COUNT(DISTINCT user_identity_email) AS unique_users FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)))) GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_risk_trend",
      "displayName": "Risk Trend",
      "query": "SELECT DATE(event_time) AS day, SUM(CASE WHEN action_name LIKE '%delete%' OR action_name LIKE '%drop%' THEN 1 ELSE 0 END) AS high_risk, SUM(CASE WHEN action_name LIKE '%update%' OR action_name LIKE '%modify%' THEN 1 ELSE 0 END) AS medium_risk FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_denied_access",
      "displayName": "Denied Access",
      "query": "SELECT f.user_identity_email, f.action_name, f.service_name, f.event_time, f.source_ip_address AS source_ip, f.response_error_message AS error_message FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.event_time BETWEEN :time_range.min AND :time_range.max AND (f.is_failed_action = true OR f.response_status_code >= 400 OR LOWER(f.action_name) LIKE '%denied%' OR LOWER(f.action_name) LIKE '%unauthorized%') AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)))) ORDER BY f.event_time DESC LIMIT 50",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_permission_changes",
      "displayName": "Permission Changes",
      "query": "SELECT user_identity_email, action_name, COALESCE(get_json_object(to_json(request_params), '$.securable_full_name'), COALESCE(get_json_object(to_json(request_params), '$.full_name'), get_json_object(to_json(request_params), '$.name')), 'N/A') AS target_entity, event_time FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (action_name LIKE '%grant%' OR action_name LIKE '%revoke%' OR action_name LIKE '%permission%') ORDER BY event_time DESC LIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_denied_by_service",
      "displayName": "Denied by Service",
      "query": "SELECT \n  COALESCE(service_name, 'Unknown') AS service_name, \n  COUNT(*) AS denial_count,\n  COUNT(DISTINCT user_identity_email) AS affected_users,\n  MAX(event_time) AS last_denial\nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_time BETWEEN :time_range.min AND :time_range.max \n  AND (\n    response_result = 'DENIED'\n    OR response_result = 'denied' \n    OR response_result = 'UNAUTHORIZED'\n    OR LOWER(action_name) LIKE '%accessdenied%'\n    OR LOWER(action_name) LIKE '%unauthorized%'\n    OR LOWER(action_name) LIKE '%forbidden%'\n    OR (response_status_code IN (401, 403) AND response_status_code IS NOT NULL)\n  )\nGROUP BY 1 \nORDER BY denial_count DESC \nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_denied_by_user",
      "displayName": "Denied by User",
      "query": "SELECT \n  COALESCE(user_identity_email, 'Unknown') AS user_identity_email, \n  COUNT(*) AS denial_count,\n  COUNT(DISTINCT service_name) AS services_affected,\n  COUNT(DISTINCT action_name) AS distinct_actions,\n  MAX(event_time) AS last_denial,\n  MAX(action_name) AS last_denied_action\nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_time BETWEEN :time_range.min AND :time_range.max \n  AND (\n    response_result = 'DENIED'\n    OR response_result = 'denied' \n    OR response_result = 'UNAUTHORIZED'\n    OR LOWER(action_name) LIKE '%accessdenied%'\n    OR LOWER(action_name) LIKE '%unauthorized%'\n    OR LOWER(action_name) LIKE '%forbidden%'\n    OR (response_status_code IN (401, 403) AND response_status_code IS NOT NULL)\n  )\nGROUP BY 1 \nORDER BY denial_count DESC \nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_admin_actions",
      "displayName": "Admin Actions",
      "query": "SELECT user_identity_email, action_name, service_name, COALESCE(get_json_object(to_json(request_params), '$.securable_full_name'), COALESCE(get_json_object(to_json(request_params), '$.full_name'), get_json_object(to_json(request_params), '$.name')), 'N/A') AS target_entity, event_time FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (action_name LIKE '%admin%' OR action_name LIKE '%create%' OR action_name LIKE '%delete%') ORDER BY event_time DESC LIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_sensitive_actions",
      "displayName": "Sensitive Actions",
      "query": "SELECT user_identity_email, action_name, service_name, event_time FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (action_name LIKE '%delete%' OR action_name LIKE '%drop%' OR action_name LIKE '%revoke%') ORDER BY event_time DESC LIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_admin_by_action",
      "displayName": "Admin by Action",
      "query": "SELECT action_name, COUNT(*) AS action_count FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max AND (action_name LIKE '%admin%' OR action_name LIKE '%create%' OR action_name LIKE '%delete%') GROUP BY 1 ORDER BY 2 DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_data_access",
      "displayName": "Data Access",
      "query": "SELECT f.user_identity_email, f.action_name, COALESCE(get_json_object(to_json(f.request_params), '$.securable_full_name'), COALESCE(get_json_object(to_json(f.request_params), '$.full_name'), get_json_object(to_json(f.request_params), '$.name')), 'N/A') AS target_table, COUNT(*) AS access_count FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.event_time BETWEEN :time_range.min AND :time_range.max AND f.service_name = 'unityCatalog' AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)))) GROUP BY 1, 2, 3 ORDER BY 4 DESC LIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_access_by_service",
      "displayName": "Access by Service",
      "query": "SELECT f.service_name, COUNT(*) AS access_count FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.event_time BETWEEN :time_range.min AND :time_range.max AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)))) GROUP BY 1 ORDER BY 2 DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_service",
          "keyword": "param_service",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_access_hourly",
      "displayName": "Access Hourly",
      "query": "SELECT HOUR(event_time) AS hour, COUNT(*) AS access_count FROM ${catalog}.${gold_schema}.fact_audit_logs  WHERE event_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_threats",
      "displayName": "ML: Threats",
      "query": "WITH user_risk AS (\n  SELECT\n    user_identity_email,\n    COUNT(*) AS total_events,\n    SUM(CASE WHEN is_failed_action = true THEN 1 ELSE 0 END) AS failed_actions,\n    SUM(CASE WHEN response_result = 'denied' OR response_status_code >= 400 THEN 1 ELSE 0 END) AS access_denials,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%delete%' OR LOWER(action_name) LIKE '%drop%' OR LOWER(action_name) LIKE '%destroy%' THEN 1 ELSE 0 END) AS destructive_actions,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%permission%' OR LOWER(action_name) LIKE '%grant%' OR LOWER(action_name) LIKE '%revoke%' THEN 1 ELSE 0 END) AS permission_changes,\n    MAX(CASE WHEN is_failed_action = true OR response_result = 'denied' THEN action_name END) AS last_suspicious_action,\n    MAX(CASE WHEN is_failed_action = true OR response_result = 'denied' THEN service_name END) AS last_affected_service,\n    MAX(event_time) AS last_event\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= :time_range.min AND event_date <= :time_range.max\n    AND user_identity_email IS NOT NULL\n    AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n    AND user_identity_email NOT LIKE 'service-principal-%'\n    AND LOWER(user_identity_email) NOT IN ('system-user', 'system', 'databricks')\n  GROUP BY user_identity_email\n  HAVING (SUM(CASE WHEN is_failed_action = true THEN 1 ELSE 0 END) > 5\n       OR SUM(CASE WHEN response_result = 'denied' OR response_status_code >= 400 THEN 1 ELSE 0 END) > 10\n       OR SUM(CASE WHEN LOWER(action_name) LIKE '%delete%' OR LOWER(action_name) LIKE '%drop%' THEN 1 ELSE 0 END) > 3)\n)\nSELECT\n  user_identity_email,\n  CASE \n    WHEN access_denials > 50 OR failed_actions > 20 THEN 'Potential Data Breach'\n    WHEN destructive_actions > 5 THEN 'Data Destruction Risk'\n    WHEN permission_changes > 10 THEN 'Privilege Abuse'\n    ELSE 'Suspicious Activity'\n  END AS threat_type,\n  LEAST(100, ROUND((access_denials + failed_actions * 2 + destructive_actions * 5) * 2, 0)) AS risk_score,\n  ROUND(LEAST(1.0, (access_denials + failed_actions + destructive_actions * 3) / 100.0), 2) AS confidence,\n  last_event AS prediction_date,\n  CONCAT(failed_actions, ' failed actions, ', access_denials, ' access denials, ', destructive_actions, ' deletes') AS incident_summary,\n  COALESCE(last_suspicious_action, 'N/A') AS last_action,\n  COALESCE(last_affected_service, 'N/A') AS affected_service,\n  CASE\n    WHEN access_denials > 50 THEN 'Immediate review - verify user identity and recent access patterns'\n    WHEN destructive_actions > 5 THEN 'Audit deleted resources and review user permissions'\n    WHEN failed_actions > 20 THEN 'Review failed operation patterns and verify authorization'\n    ELSE 'Monitor user activity closely for next 7 days'\n  END AS recommended_action\nFROM user_risk\nORDER BY (access_denials + failed_actions * 2 + destructive_actions * 5) DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_exfiltration",
      "displayName": "ML: Exfiltration",
      "query": "WITH user_data_access AS (\n  SELECT\n    user_identity_email,\n    COUNT(*) AS total_access_events,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%read%' OR LOWER(action_name) LIKE '%select%' OR LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' THEN 1 ELSE 0 END) AS read_operations,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' THEN 1 ELSE 0 END) AS export_operations,\n    COUNT(DISTINCT service_name) AS distinct_services,\n    COUNT(DISTINCT source_ip_address) AS distinct_ips,\n    MAX(action_name) FILTER (WHERE LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' OR LOWER(action_name) LIKE '%read%') AS last_data_action,\n    MAX(service_name) FILTER (WHERE LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' OR LOWER(action_name) LIKE '%read%') AS last_accessed_service,\n    MAX(event_time) AS last_event\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= :time_range.min AND event_date <= :time_range.max\n    AND user_identity_email IS NOT NULL\n    AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n    AND user_identity_email NOT LIKE 'service-principal-%'\n    AND LOWER(user_identity_email) NOT IN ('system-user', 'system', 'databricks')\n  GROUP BY user_identity_email\n  HAVING SUM(CASE WHEN LOWER(action_name) LIKE '%read%' OR LOWER(action_name) LIKE '%select%' OR LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' THEN 1 ELSE 0 END) > 100\n     OR SUM(CASE WHEN LOWER(action_name) LIKE '%download%' OR LOWER(action_name) LIKE '%export%' THEN 1 ELSE 0 END) > 10\n)\nSELECT\n  user_identity_email,\n  read_operations AS data_volume,\n  CASE \n    WHEN export_operations > 50 OR (read_operations > 1000 AND distinct_ips > 3) THEN 'HIGH'\n    WHEN export_operations > 20 OR read_operations > 500 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS risk_level,\n  ROUND(LEAST(1.0, (export_operations * 10 + read_operations) / 5000.0), 3) AS anomaly_score,\n  CONCAT(export_operations, ' exports, ', read_operations, ' reads, ', distinct_ips, ' IPs') AS access_pattern,\n  COALESCE(last_data_action, 'N/A') AS last_action,\n  COALESCE(last_accessed_service, 'N/A') AS accessed_service,\n  CASE\n    WHEN export_operations > 50 THEN 'URGENT: Review export activity - potential bulk data extraction'\n    WHEN distinct_ips > 5 THEN 'Investigate access from multiple locations - possible credential sharing'\n    WHEN read_operations > 1000 THEN 'Analyze read patterns for unusual data access scope'\n    ELSE 'Monitor for escalation in data access volume'\n  END AS recommended_action,\n  last_event AS scored_at\nFROM user_data_access\nORDER BY (export_operations * 10 + read_operations) DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_privilege",
      "displayName": "ML: Privilege",
      "query": "WITH privilege_activity AS (\n  SELECT\n    user_identity_email,\n    COUNT(*) AS total_actions,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%permission%' OR LOWER(action_name) LIKE '%grant%' OR LOWER(action_name) LIKE '%access%' THEN 1 ELSE 0 END) AS permission_actions,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%adduser%' OR LOWER(action_name) LIKE '%creategroup%' OR LOWER(action_name) LIKE '%setadmin%' THEN 1 ELSE 0 END) AS admin_actions,\n    SUM(CASE WHEN service_name IN ('accounts', 'iamRole', 'groups', 'users') THEN 1 ELSE 0 END) AS iam_events,\n    SUM(CASE WHEN LOWER(action_name) LIKE '%update%' AND service_name IN ('accounts', 'groups', 'users') THEN 1 ELSE 0 END) AS role_changes,\n    MAX(action_name) FILTER (WHERE LOWER(action_name) LIKE '%permission%' OR LOWER(action_name) LIKE '%grant%' OR service_name IN ('accounts', 'iamRole')) AS last_privilege_action,\n    MAX(service_name) FILTER (WHERE LOWER(action_name) LIKE '%permission%' OR LOWER(action_name) LIKE '%grant%' OR service_name IN ('accounts', 'iamRole')) AS target_service,\n    MAX(event_time) AS last_event\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= :time_range.min AND event_date <= :time_range.max\n    AND user_identity_email IS NOT NULL\n    AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n    AND user_identity_email NOT LIKE 'service-principal-%'\n    AND LOWER(user_identity_email) NOT IN ('system-user', 'system', 'databricks')\n  GROUP BY user_identity_email\n  HAVING SUM(CASE WHEN LOWER(action_name) LIKE '%permission%' OR LOWER(action_name) LIKE '%grant%' OR LOWER(action_name) LIKE '%access%' THEN 1 ELSE 0 END) > 5\n      OR SUM(CASE WHEN service_name IN ('accounts', 'iamRole', 'groups', 'users') THEN 1 ELSE 0 END) > 10\n)\nSELECT\n  user_identity_email,\n  CASE\n    WHEN admin_actions > 5 THEN 'Admin'\n    WHEN iam_events > 20 THEN 'IAM User'\n    WHEN permission_actions > 10 THEN 'Power User'\n    ELSE 'User'\n  END AS current_role,\n  CASE \n    WHEN admin_actions > 10 OR (permission_actions > 20 AND iam_events > 30) THEN 'HIGH'\n    WHEN admin_actions > 5 OR permission_actions > 10 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS escalation_risk,\n  ROUND(LEAST(1.0, (admin_actions * 10 + permission_actions + iam_events) / 100.0), 2) AS confidence,\n  CONCAT(permission_actions, ' permission changes, ', admin_actions, ' admin actions, ', iam_events, ' IAM events') AS activity_summary,\n  COALESCE(last_privilege_action, 'N/A') AS last_action,\n  COALESCE(target_service, 'N/A') AS target_service,\n  CASE\n    WHEN admin_actions > 10 THEN 'CRITICAL: Review admin action logs - possible unauthorized privilege escalation'\n    WHEN permission_actions > 20 THEN 'Review permission grants - verify authorization for changes'\n    WHEN iam_events > 30 THEN 'Audit IAM activity - high volume of identity changes'\n    ELSE 'Monitor for unusual privilege patterns'\n  END AS recommended_action,\n  last_event AS scored_at\nFROM privilege_activity\nORDER BY (admin_actions * 10 + permission_actions + iam_events) DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_latest",
      "displayName": "Monitor: Latest",
      "query": "-- Latest security KPIs from fact_audit_logs\nSELECT \n  COUNT(*) AS total_events,\n  COUNT(DISTINCT user_identity) AS unique_users,\n  ROUND(SUM(CASE \n    WHEN action_name IN ('deleteCluster', 'deleteJob', 'deleteWarehouse', 'deleteSecret', \n                         'removePermissions', 'revokeToken', 'deleteUser', 'removeGroupMember') THEN 1\n    WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' OR action_name LIKE '%permission%' THEN 1\n    ELSE 0\n  END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS high_risk_rate\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE DATE(event_time) >= :time_range.min\n  AND DATE(event_time) <= :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_trend",
      "displayName": "Monitor: Trend",
      "query": "-- Daily security event trend from fact_audit_logs\nSELECT \n  DATE(event_time) AS window_start,\n  COUNT(*) AS total_events,\n  SUM(CASE \n    WHEN action_name IN ('deleteCluster', 'deleteJob', 'deleteWarehouse', 'deleteSecret', \n                         'removePermissions', 'revokeToken', 'deleteUser', 'removeGroupMember') THEN 1\n    WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' OR action_name LIKE '%permission%' THEN 1\n    ELSE 0\n  END) AS high_risk_events,\n  COUNT(DISTINCT user_identity) AS unique_users\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE DATE(event_time) >= :time_range.min\n  AND DATE(event_time) <= :time_range.max\nGROUP BY DATE(event_time)\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_access",
      "displayName": "Monitor: Access",
      "query": "-- Daily access patterns from fact_audit_logs\nSELECT \n  DATE(event_time) AS window_start,\n  SUM(CASE WHEN response.status_code >= 400 OR response.error_message IS NOT NULL THEN 1 ELSE 0 END) AS denied_accesses,\n  SUM(CASE WHEN action_name LIKE '%Permission%' OR action_name LIKE '%permission%' OR action_name LIKE '%grant%' OR action_name LIKE '%revoke%' THEN 1 ELSE 0 END) AS permission_changes,\n  SUM(CASE WHEN service_name = 'accounts' OR action_name LIKE '%admin%' OR action_name LIKE '%Admin%' THEN 1 ELSE 0 END) AS admin_actions\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE DATE(event_time) >= :time_range.min\n  AND DATE(event_time) <= :time_range.max\nGROUP BY DATE(event_time)\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "-- Calculate week-over-week drift from fact_audit_logs\nWITH daily_metrics AS (\n  SELECT \n    DATE(event_time) AS day,\n    COUNT(*) AS daily_events,\n    SUM(CASE WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' OR action_name LIKE '%permission%' THEN 1 ELSE 0 END) AS daily_high_risk\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE DATE(event_time) >= :time_range.min\n    AND DATE(event_time) <= :time_range.max\n  GROUP BY DATE(event_time)\n),\nweekly_avg AS (\n  SELECT \n    day,\n    daily_events,\n    daily_high_risk,\n    AVG(daily_events) OVER (ORDER BY day ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS seven_day_avg,\n    LAG(AVG(daily_events) OVER (ORDER BY day ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 7) OVER (ORDER BY day) AS prev_seven_day_avg,\n    AVG(daily_high_risk) OVER (ORDER BY day ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS seven_day_high_risk_avg,\n    LAG(AVG(daily_high_risk) OVER (ORDER BY day ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 7) OVER (ORDER BY day) AS prev_seven_day_high_risk_avg\n  FROM daily_metrics\n)\nSELECT \n  day AS window_start,\n  ROUND((seven_day_avg - prev_seven_day_avg) * 100.0 / NULLIF(prev_seven_day_avg, 0), 1) AS event_volume_drift,\n  ROUND((seven_day_high_risk_avg - prev_seven_day_high_risk_avg) * 100.0 / NULLIF(prev_seven_day_high_risk_avg, 0), 1) AS risk_level_drift\nFROM weekly_avg\nWHERE prev_seven_day_avg IS NOT NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_detailed",
      "displayName": "Monitor: Detailed",
      "query": "-- Detailed daily security metrics from fact_audit_logs\nSELECT \n  DATE(event_time) AS window_start,\n  COUNT(*) AS total_events,\n  COUNT(DISTINCT user_identity) AS unique_users,\n  SUM(CASE \n    WHEN action_name IN ('deleteCluster', 'deleteJob', 'deleteWarehouse', 'deleteSecret', \n                         'removePermissions', 'revokeToken', 'deleteUser', 'removeGroupMember') THEN 1\n    WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' OR action_name LIKE '%permission%' THEN 1\n    ELSE 0\n  END) AS high_risk_events,\n  SUM(CASE WHEN response.status_code >= 400 OR response.error_message IS NOT NULL THEN 1 ELSE 0 END) AS denied_accesses\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE DATE(event_time) >= :time_range.min\n  AND DATE(event_time) <= :time_range.max\nGROUP BY DATE(event_time)\nORDER BY window_start DESC\nLIMIT 30",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name"
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name"
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "ds_select_workspace",
      "query": "SELECT DISTINCT COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name FROM ${catalog}.${gold_schema}.fact_audit_logs f LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.workspace_id IS NOT NULL ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_service",
      "displayName": "ds_select_service",
      "query": "SELECT DISTINCT service_name FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE service_name IS NOT NULL ORDER BY 1 LIMIT 50",
      "parameters": []
    },
    {
      "name": "ds_select_action",
      "displayName": "ds_select_action",
      "query": "SELECT DISTINCT action_name FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE action_name IS NOT NULL ORDER BY 1 LIMIT 50",
      "parameters": []
    },
    {
      "name": "ds_monitor_security_aggregate",
      "displayName": "Security Aggregate Metrics",
      "query": "-- Security aggregate metrics from fact_audit_logs\nSELECT \n  DATE(event_time) AS window_start,\n  COUNT(*) AS total_events,\n  COUNT(DISTINCT user_identity_email) AS distinct_users,\n  SUM(CASE WHEN service_name = 'accounts' OR action_name LIKE '%admin%' THEN 1 ELSE 0 END) AS admin_actions,\n  SUM(CASE \n    WHEN action_name IN ('deleteCluster', 'deleteJob', 'deleteWarehouse', 'deleteSecret', \n                         'removePermissions', 'revokeToken', 'deleteUser', 'removeGroupMember',\n                         'updateClusterPermissions', 'updateJobPermissions') THEN 1\n    WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' OR action_name LIKE '%permission%' THEN 1\n    ELSE 0\n  END) AS high_risk_events\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE event_time >= :monitor_time_start\n  AND event_time <= COALESCE(:monitor_time_end, CURRENT_TIMESTAMP())\nGROUP BY DATE(event_time)\nORDER BY window_start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_security_derived",
      "displayName": "Security Derived KPIs",
      "query": "-- Derived security KPIs from fact_audit_logs\nSELECT \n  DATE(event_time) AS window_start,\n  ROUND(SUM(CASE WHEN service_name = 'accounts' OR action_name LIKE '%admin%' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS admin_action_rate,\n  ROUND(SUM(CASE \n    WHEN action_name IN ('deleteCluster', 'deleteJob', 'deleteWarehouse', 'deleteSecret') THEN 1\n    WHEN action_name LIKE '%secret%' OR action_name LIKE '%token%' THEN 1\n    ELSE 0\n  END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS high_risk_event_rate\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE event_time >= :monitor_time_start\n  AND event_time <= COALESCE(:monitor_time_end, CURRENT_TIMESTAMP())\nGROUP BY DATE(event_time)\nORDER BY window_start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_security_slice_keys",
      "displayName": "Security Slice Keys",
      "query": "-- Available slice keys for security analysis\nSELECT 'All' AS slice_key\nUNION ALL\nSELECT 'service_name' AS slice_key\nUNION ALL\nSELECT 'user_identity' AS slice_key\nUNION ALL\nSELECT 'action_name' AS slice_key\nORDER BY slice_key",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_security_slice_values",
      "displayName": "Security Slice Values",
      "query": "-- Available slice values based on selected slice key\nSELECT 'All' AS slice_value\nUNION ALL\nSELECT DISTINCT \n  CASE \n    WHEN :monitor_slice_key = 'service_name' THEN service_name\n    WHEN :monitor_slice_key = 'user_identity' THEN user_identity\n    WHEN :monitor_slice_key = 'action_name' THEN action_name\n    ELSE 'All'\n  END AS slice_value\nFROM ${catalog}.${gold_schema}.fact_audit_logs\nWHERE event_time >= :monitor_time_start\n  AND event_time <= COALESCE(:monitor_time_end, CURRENT_TIMESTAMP())\n  AND :monitor_slice_key != 'All'\nLIMIT 50",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}