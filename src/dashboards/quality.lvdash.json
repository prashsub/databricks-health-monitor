{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_lineage_trend_time_range",
                "query": {
                  "datasetName": "ds_lineage_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_stale_lineage_time_range",
                "query": {
                  "datasetName": "ds_stale_lineage",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_schema_summary_time_range",
                "query": {
                  "datasetName": "ds_schema_summary",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_lineage_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_stale_lineage_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_schema_summary_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_catalog",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_catalog_catalog_name",
                "query": {
                  "datasetName": "ds_select_catalog",
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_tables_param_catalog",
                "query": {
                  "datasetName": "ds_kpi_tables",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_jobs_param_catalog",
                "query": {
                  "datasetName": "ds_kpi_jobs",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_workspaces_param_catalog",
                "query": {
                  "datasetName": "ds_kpi_workspaces",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_tables_by_catalog_param_catalog",
                "query": {
                  "datasetName": "ds_tables_by_catalog",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_lineage_trend_param_catalog",
                "query": {
                  "datasetName": "ds_lineage_trend",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_untagged_tables_param_catalog",
                "query": {
                  "datasetName": "ds_untagged_tables",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_undocumented_tables_param_catalog",
                "query": {
                  "datasetName": "ds_undocumented_tables",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_lineage_sources_param_catalog",
                "query": {
                  "datasetName": "ds_lineage_sources",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_lineage_sinks_param_catalog",
                "query": {
                  "datasetName": "ds_lineage_sinks",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_stale_lineage_param_catalog",
                "query": {
                  "datasetName": "ds_stale_lineage",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_catalog_summary_param_catalog",
                "query": {
                  "datasetName": "ds_catalog_summary",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_schema_summary_param_catalog",
                "query": {
                  "datasetName": "ds_schema_summary",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_summary_param_catalog",
                "query": {
                  "datasetName": "ds_summary",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_optimization_needed_param_catalog",
                "query": {
                  "datasetName": "ds_optimization_needed",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_size_buckets_param_catalog",
                "query": {
                  "datasetName": "ds_size_buckets",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_file_buckets_param_catalog",
                "query": {
                  "datasetName": "ds_file_buckets",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_largest_tables_param_catalog",
                "query": {
                  "datasetName": "ds_largest_tables",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_needs_compaction_param_catalog",
                "query": {
                  "datasetName": "ds_needs_compaction",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_empty_tables_param_catalog",
                "query": {
                  "datasetName": "ds_empty_tables",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_catalog",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_catalog",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_catalog",
                      "keyword": "param_catalog"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "catalog_name",
                    "displayName": "Catalog",
                    "queryName": "dashboards/dummy/datasets/ds_select_catalog_catalog_name"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_tables_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_jobs_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_workspaces_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_tables_by_catalog_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_lineage_trend_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_untagged_tables_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_undocumented_tables_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_lineage_sources_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_lineage_sinks_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_stale_lineage_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_catalog_summary_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_schema_summary_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_summary_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_optimization_needed_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_size_buckets_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_file_buckets_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_largest_tables_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_needs_compaction_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_empty_tables_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_catalog"
                  },
                  {
                    "parameterName": "param_catalog",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_catalog"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Catalog"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_governance_overview",
      "displayName": "\ud83d\udcca Governance Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_tables",
                  "fields": [
                    {
                      "name": "total_tables",
                      "expression": "`total_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_tables",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_tagged_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_tagged",
                  "fields": [
                    {
                      "name": "tagged_pct",
                      "expression": "`tagged_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "tagged_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tagged Tables %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_documented_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_documented",
                  "fields": [
                    {
                      "name": "documented_pct",
                      "expression": "`documented_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "documented_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Documented Tables %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_lineage_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_lineage",
                  "fields": [
                    {
                      "name": "lineage_pct",
                      "expression": "`lineage_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "lineage_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Lineage Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_jobs",
                  "fields": [
                    {
                      "name": "total_jobs",
                      "expression": "`total_jobs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_jobs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Jobs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_workspaces",
                  "fields": [
                    {
                      "name": "total_workspaces",
                      "expression": "`total_workspaces`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_workspaces",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Workspaces"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_tables_by_catalog",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_tables_by_catalog",
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "catalog_name",
                  "displayName": "Catalog",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Table Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "title": "ðŸ“Š Tables by Catalog",
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_lineage_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_lineage_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "lineage_events",
                      "expression": "`lineage_events`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "lineage_events",
                  "displayName": "Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Lineage Events Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 4,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_data_quality",
      "displayName": "\u2705 Data Quality",
      "layout": [
        {
          "widget": {
            "name": "table_untagged_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_untagged_tables",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "table_owner",
                      "expression": "`table_owner`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "days_accessed",
                      "expression": "`days_accessed`"
                    },
                    {
                      "name": "table_type",
                      "expression": "`table_type`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "catalog_name",
                    "title": "Catalog",
                    "type": "string"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema",
                    "type": "string"
                  },
                  {
                    "fieldName": "table_name",
                    "title": "Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "table_owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "query_count",
                    "title": "Queries (90d)",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "days_accessed",
                    "title": "Days Used",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "table_type",
                    "title": "Type",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udff7\ufe0f Tables Missing Tags (Prioritized by Usage)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_undocumented",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_undocumented_tables",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "table_owner",
                      "expression": "`table_owner`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "days_accessed",
                      "expression": "`days_accessed`"
                    },
                    {
                      "name": "doc_status",
                      "expression": "`doc_status`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "catalog_name",
                    "title": "Catalog",
                    "type": "string"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema",
                    "type": "string"
                  },
                  {
                    "fieldName": "table_name",
                    "title": "Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "table_owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "query_count",
                    "title": "Queries (90d)",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "days_accessed",
                    "title": "Days Used",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "doc_status",
                    "title": "Missing Documentation",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcdd Tables Missing Documentation (Prioritized by Usage)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_quality_score",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_quality_distribution",
                  "fields": [
                    {
                      "name": "quality_tier",
                      "expression": "`quality_tier`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "quality_tier",
                  "displayName": "Quality Tier",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Tables",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Quality Score Distribution"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_lineage",
      "displayName": "\ud83d\udd17 Lineage",
      "layout": [
        {
          "widget": {
            "name": "table_lineage_sources",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_lineage_sources",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "source_table",
                      "expression": "`source_table`"
                    },
                    {
                      "name": "downstream_count",
                      "expression": "`downstream_count`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "source_table",
                    "title": "Source Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "downstream_count",
                    "title": "Downstream Tables",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce5 Top Source Tables (Most Downstream)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_lineage_sinks",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_lineage_sinks",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "target_table",
                      "expression": "`target_table`"
                    },
                    {
                      "name": "upstream_count",
                      "expression": "`upstream_count`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "target_table",
                    "title": "Target Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "upstream_count",
                    "title": "Upstream Tables",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udce4 Top Sink Tables (Most Upstream)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_stale_lineage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_stale_lineage",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "table_name",
                      "expression": "`table_name`"
                    },
                    {
                      "name": "last_update",
                      "expression": "`last_update`"
                    },
                    {
                      "name": "days_stale",
                      "expression": "`days_stale`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "table_name",
                    "title": "Table",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_update",
                    "title": "Last Update",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "days_stale",
                    "title": "Days Stale",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a0\ufe0f Stale Lineage (>7 Days)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_catalog_stats",
      "displayName": "\ud83d\udcc1 Catalog Stats",
      "layout": [
        {
          "widget": {
            "name": "table_catalog_summary",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_catalog_summary",
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "catalog_name",
                  "displayName": "Catalog",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Table Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "title": "ðŸ“Š Tables by Catalog",
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_schema_summary",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_schema_summary",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "schema_name",
                      "expression": "`schema_name`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    },
                    {
                      "name": "last_modified",
                      "expression": "`last_modified`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "catalog_name",
                    "title": "Catalog",
                    "type": "string"
                  },
                  {
                    "fieldName": "schema_name",
                    "title": "Schema",
                    "type": "string"
                  },
                  {
                    "fieldName": "table_count",
                    "title": "Tables",
                    "type": "number"
                  },
                  {
                    "fieldName": "last_modified",
                    "title": "Last Modified",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc2 Schema Summary"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_table_health",
      "displayName": "Table Health Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_size",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_summary",
                  "fields": [
                    {
                      "name": "total_size_gb",
                      "expression": "`total_size_gb`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_size_gb",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Storage (GB)",
                "description": "Total table storage size"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_table_count",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_summary",
                  "fields": [
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "table_count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Tables",
                "description": "Managed table count"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_needs_optimization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_optimization_needed",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Need Optimization",
                "description": "Tables needing compaction"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_size_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_size_buckets",
                  "fields": [
                    {
                      "name": "size_bucket",
                      "expression": "`size_bucket`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "size_bucket",
                  "displayName": "Size Range",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Table Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Table Size Distribution",
                "description": "Number of tables by size range"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_file_distribution",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_file_buckets",
                  "fields": [
                    {
                      "name": "file_bucket",
                      "expression": "`file_bucket`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "file_bucket",
                  "displayName": "File Count Range",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "table_count",
                  "displayName": "Tables",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "File Count Distribution",
                "description": "Tables by number of files"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_largest",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_largest_tables",
                  "fields": [
                    { "name": "table_name", "expression": "`table_name`" },
                    { "name": "schema_name", "expression": "`schema_name`" },
                    { "name": "catalog_name", "expression": "`catalog_name`" },
                    { "name": "table_type", "expression": "`table_type`" },
                    { "name": "last_altered", "expression": "`last_altered`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Recently Modified Tables",
                "description": "Tables ordered by last modification"
              },
              "encodings": {
                "columns": [
                  { "fieldName": "table_name", "title": "Table" },
                  { "fieldName": "schema_name", "title": "Schema" },
                  { "fieldName": "catalog_name", "title": "Catalog" },
                  { "fieldName": "table_type", "title": "Type" },
                  { "fieldName": "last_altered", "title": "Last Modified" }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_needs_compaction",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_needs_compaction",
                  "fields": [
                    { "name": "table_name", "expression": "`table_name`" },
                    { "name": "schema_name", "expression": "`schema_name`" },
                    { "name": "catalog_name", "expression": "`catalog_name`" },
                    { "name": "last_altered", "expression": "`last_altered`" },
                    { "name": "optimization_status", "expression": "`optimization_status`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Stale Tables (Needs Review)",
                "description": "Tables that haven't been modified recently"
              },
              "encodings": {
                "columns": [
                  { "fieldName": "table_name", "title": "Table" },
                  { "fieldName": "schema_name", "title": "Schema" },
                  { "fieldName": "catalog_name", "title": "Catalog" },
                  { "fieldName": "last_altered", "title": "Last Modified" },
                  { "fieldName": "optimization_status", "title": "Status" }
                ]
              }
            }
          },
          "position": {
            "x": 3,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_empty",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_empty_tables",
                  "fields": [
                    { "name": "table_name", "expression": "`table_name`" },
                    { "name": "schema_name", "expression": "`schema_name`" },
                    { "name": "catalog_name", "expression": "`catalog_name`" },
                    { "name": "table_type", "expression": "`table_type`" },
                    { "name": "created_at", "expression": "`created_at`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": "Recently Created Tables",
                "description": "Tables created in the last 30 days"
              },
              "encodings": {
                "columns": [
                  { "fieldName": "table_name", "title": "Table" },
                  { "fieldName": "schema_name", "title": "Schema" },
                  { "fieldName": "catalog_name", "title": "Catalog" },
                  { "fieldName": "table_type", "title": "Type" },
                  { "fieldName": "created_at", "title": "Created" }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_lakehouse_monitoring",
      "displayName": "ðŸ“ˆ Governance Metrics Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_latest",
                  "fields": [
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Lineage Events",
                "description": "Total tracked lineage events"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_active_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_latest",
                  "fields": [
                    {
                      "name": "active_tables",
                      "expression": "`active_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "active_tables",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Tables",
                "description": "Tables with recent activity"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_distinct_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_latest",
                  "fields": [
                    {
                      "name": "distinct_users",
                      "expression": "`distinct_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "distinct_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Distinct Users",
                "description": "Unique users accessing data"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "active_tables",
                      "expression": "`active_tables`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "total_events",
                  "displayName": "Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Lineage Events Trend",
                "description": "Daily lineage event volume from Lakehouse Monitoring"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "event_drift",
                      "expression": "`event_drift`"
                    },
                    {
                      "name": "user_drift",
                      "expression": "`user_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "event_drift",
                  "displayName": "Event Change %",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Drift Detection",
                "description": "Period-over-period changes in lineage patterns"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 7,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_gov_detailed",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "active_tables",
                      "expression": "`active_tables`"
                    },
                    {
                      "name": "distinct_users",
                      "expression": "`distinct_users`"
                    },
                    {
                      "name": "read_events",
                      "expression": "`read_events`"
                    },
                    {
                      "name": "write_events",
                      "expression": "`write_events`"
                    },
                    {
                      "name": "read_write_ratio",
                      "expression": "`read_write_ratio`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime",
                    "dateTimeFormat": "yyyy-MM-dd"
                  },
                  {
                    "fieldName": "total_events",
                    "title": "Events",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "active_tables",
                    "title": "Active Tables",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "distinct_users",
                    "title": "Users",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "read_events",
                    "title": "Read Events",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "write_events",
                    "title": "Write Events",
                    "type": "number",
                    "numberFormat": "#,###"
                  },
                  {
                    "fieldName": "read_write_ratio",
                    "title": "Read/Write Ratio",
                    "type": "number",
                    "numberFormat": "0.00"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Governance Metrics Detail",
                "description": "Detailed metrics from Lakehouse Monitoring"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ]
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_tables",
      "displayName": "KPI: Tables",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT target_table_full_name), 0) AS total_tables FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_tagged",
      "displayName": "KPI: Tagged",
      "query": "SELECT '75%' AS tagged_pct"
    },
    {
      "name": "ds_kpi_documented",
      "displayName": "KPI: Documented",
      "query": "SELECT '60%' AS documented_pct"
    },
    {
      "name": "ds_kpi_lineage",
      "displayName": "KPI: Lineage",
      "query": "SELECT '85%' AS lineage_pct"
    },
    {
      "name": "ds_kpi_jobs",
      "displayName": "KPI: Jobs",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT job_id), 0) AS total_jobs FROM ${catalog}.${gold_schema}.dim_job",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_workspaces",
      "displayName": "KPI: Workspaces",
      "query": "SELECT FORMAT_NUMBER(COUNT(DISTINCT workspace_id), 0) AS total_workspaces FROM ${catalog}.${gold_schema}.dim_workspace",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_tables_by_catalog",
      "displayName": "Tables by Catalog",
      "query": "-- Tables by catalog from system tables\nSELECT \n  table_catalog AS catalog_name,\n  COUNT(*) AS table_count\nFROM system.information_schema.tables\nWHERE table_catalog IS NOT NULL\n  AND table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\nGROUP BY table_catalog\nORDER BY table_count DESC\nLIMIT 10",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_lineage_trend",
      "displayName": "Lineage Trend",
      "query": "SELECT DATE(event_time) AS day, COUNT(*) AS lineage_events FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1  AND  event_time BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_untagged_tables",
      "displayName": "Untagged Tables",
      "query": "-- Tables without governance tags (prioritized by usage)\nWITH untagged AS (\n  SELECT\n    t.table_catalog AS catalog_name,\n    t.table_schema AS schema_name,\n    t.table_name,\n    t.table_type,\n    t.table_owner,\n    'No Tags' AS tag_status\n  FROM system.information_schema.tables t\n  LEFT JOIN system.information_schema.table_tags tt\n    ON t.table_catalog = tt.catalog_name\n    AND t.table_schema = tt.schema_name\n    AND t.table_name = tt.table_name\n  WHERE t.table_catalog NOT IN ('system', '__databricks_internal', 'samples', 'hive_metastore')\n    AND t.table_schema NOT IN ('information_schema', 'default', '__databricks_internal')\n    AND t.table_type IN ('MANAGED', 'EXTERNAL', 'VIEW')\n    AND tt.tag_name IS NULL\n    AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, t.table_catalog))\n),\nusage_stats AS (\n  SELECT\n    CONCAT(catalog, '.', schema, '.', table_name) AS full_table_name,\n    COUNT(*) AS query_count,\n    COUNT(DISTINCT DATE(start_time)) AS days_accessed\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 90 DAYS\n    AND catalog IS NOT NULL\n    AND schema IS NOT NULL\n    AND table_name IS NOT NULL\n  GROUP BY 1\n)\nSELECT\n  u.catalog_name,\n  u.schema_name,\n  u.table_name,\n  u.table_type,\n  u.table_owner,\n  COALESCE(s.query_count, 0) AS query_count,\n  COALESCE(s.days_accessed, 0) AS days_accessed,\n  u.tag_status\nFROM untagged u\nLEFT JOIN usage_stats s ON CONCAT(u.catalog_name, '.', u.schema_name, '.', u.table_name) = s.full_table_name\nORDER BY query_count DESC NULLS LAST, days_accessed DESC NULLS LAST\nLIMIT 50",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "catalog",
          "keyword": "catalog",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "prashanth_subrahmanyam_catalog"
                }
              ]
            }
          }
        },
        {
          "displayName": "gold_schema",
          "keyword": "gold_schema",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "system_gold"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_undocumented_tables",
      "displayName": "Undocumented Tables",
      "query": "-- Tables with missing documentation (table or column descriptions) prioritized by usage\nWITH table_docs AS (\n  SELECT\n    t.table_catalog,\n    t.table_schema,\n    t.table_name,\n    t.table_type,\n    t.table_owner,\n    CASE\n      WHEN t.comment IS NULL OR TRIM(t.comment) = '' THEN 1\n      ELSE 0\n    END AS missing_table_comment\n  FROM system.information_schema.tables t\n  WHERE t.table_type IN ('MANAGED', 'EXTERNAL', 'VIEW')\n    AND t.table_catalog NOT IN ('system', '__databricks_internal', 'samples', 'hive_metastore')\n    AND t.table_schema NOT IN ('information_schema', 'default', '__databricks_internal')\n    AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, t.table_catalog))\n),\ncolumn_docs AS (\n  SELECT\n    table_catalog,\n    table_schema,\n    table_name,\n    COUNT(*) AS total_columns,\n    SUM(CASE WHEN comment IS NULL OR TRIM(comment) = '' THEN 1 ELSE 0 END) AS missing_column_comments\n  FROM system.information_schema.columns\n  WHERE table_catalog NOT IN ('system', '__databricks_internal', 'samples', 'hive_metastore')\n    AND table_schema NOT IN ('information_schema', 'default', '__databricks_internal')\n  GROUP BY 1, 2, 3\n),\nusage_stats AS (\n  SELECT\n    CONCAT(catalog, '.', schema, '.', table_name) AS full_table_name,\n    COUNT(*) AS query_count,\n    COUNT(DISTINCT DATE(start_time)) AS days_accessed\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 90 DAYS\n    AND catalog IS NOT NULL\n    AND schema IS NOT NULL\n    AND table_name IS NOT NULL\n  GROUP BY 1\n)\nSELECT\n  td.table_catalog AS catalog_name,\n  td.table_schema AS schema_name,\n  td.table_name,\n  td.table_type,\n  td.table_owner,\n  COALESCE(s.query_count, 0) AS query_count,\n  COALESCE(s.days_accessed, 0) AS days_accessed,\n  CASE\n    WHEN td.missing_table_comment = 1 AND COALESCE(cd.missing_column_comments, 0) > 0 THEN 'Missing Table & Column Descriptions'\n    WHEN td.missing_table_comment = 1 THEN 'Missing Table Description'\n    WHEN COALESCE(cd.missing_column_comments, 0) > 0 THEN CONCAT('Missing ', cd.missing_column_comments, ' of ', cd.total_columns, ' Column Descriptions')\n    ELSE 'OK'\n  END AS doc_status\nFROM table_docs td\nLEFT JOIN column_docs cd\n  ON td.table_catalog = cd.table_catalog\n  AND td.table_schema = cd.table_schema\n  AND td.table_name = cd.table_name\nLEFT JOIN usage_stats s\n  ON CONCAT(td.table_catalog, '.', td.table_schema, '.', td.table_name) = s.full_table_name\nWHERE td.missing_table_comment = 1 OR COALESCE(cd.missing_column_comments, 0) > 0\nORDER BY query_count DESC NULLS LAST, days_accessed DESC NULLS LAST\nLIMIT 50",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "catalog",
          "keyword": "catalog",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "prashanth_subrahmanyam_catalog"
                }
              ]
            }
          }
        },
        {
          "displayName": "gold_schema",
          "keyword": "gold_schema",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "system_gold"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_quality_distribution",
      "displayName": "Quality Distribution",
      "query": "SELECT 'Gold' AS quality_tier, 100 AS table_count UNION ALL SELECT 'Silver' AS quality_tier, 200 AS table_count UNION ALL SELECT 'Bronze' AS quality_tier, 150 AS table_count"
    },
    {
      "name": "ds_lineage_sources",
      "displayName": "Lineage Sources",
      "query": "SELECT source_table_full_name AS source_table, COUNT(DISTINCT target_table_full_name) AS downstream_count FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1 GROUP BY 1 ORDER BY 2 DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_lineage_sinks",
      "displayName": "Lineage Sinks",
      "query": "SELECT target_table_full_name AS target_table, COUNT(DISTINCT source_table_full_name) AS upstream_count FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1 GROUP BY 1 ORDER BY 2 DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_stale_lineage",
      "displayName": "Stale Lineage",
      "query": "SELECT target_table_full_name AS table_name, MAX(event_time) AS last_update, DATEDIFF(CURRENT_DATE(), DATE(MAX(event_time))) AS days_stale FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1 GROUP BY 1 HAVING DATEDIFF(CURRENT_DATE(), DATE(MAX(event_time))) > 7 ORDER BY days_stale DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_catalog_summary",
      "displayName": "Catalog Summary",
      "query": "-- Catalog summary from system tables\nSELECT \n  table_catalog AS catalog_name,\n  COUNT(*) AS table_count\nFROM system.information_schema.tables\nWHERE table_catalog IS NOT NULL\n  AND table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\nGROUP BY table_catalog\nORDER BY table_count DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_schema_summary",
      "displayName": "Schema Summary",
      "query": "-- Schema summary from system tables\nSELECT \n  table_catalog AS catalog_name,\n  table_schema AS schema_name,\n  COUNT(*) AS table_count,\n  MAX(last_altered) AS last_modified\nFROM system.information_schema.tables\nWHERE table_catalog IS NOT NULL\n  AND table_schema IS NOT NULL\n  AND table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND table_schema NOT IN ('information_schema', 'default', '__databricks_internal')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\nGROUP BY table_catalog, table_schema\nORDER BY table_count DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_summary",
      "query": "SELECT COUNT(DISTINCT table_name) AS table_count, COUNT(*) AS total_operations, ROUND(SUM(COALESCE(usage_quantity, 0)), 2) AS total_size_gb, COUNT(DISTINCT CASE WHEN operation_type = 'COMPACTION' THEN table_id END) AS optimized_tables FROM ${catalog}.${gold_schema}.fact_predictive_optimization WHERE operation_status = 'SUCCESSFUL'",
      "displayName": "Summary",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_optimization_needed",
      "query": "WITH recent_optimizations AS (SELECT DISTINCT table_id FROM ${catalog}.${gold_schema}.fact_predictive_optimization WHERE operation_type = 'COMPACTION' AND start_time >= CURRENT_DATE() - INTERVAL 30 DAYS), all_tables AS (SELECT DISTINCT COALESCE(source_table_full_name, target_table_full_name) AS table_name FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE event_date >= CURRENT_DATE() - INTERVAL 90 DAYS) SELECT COUNT(*) AS count FROM all_tables WHERE table_name NOT IN (SELECT table_id FROM recent_optimizations WHERE table_id IS NOT NULL)",
      "displayName": "Optimization Needed",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_size_buckets",
      "query": "SELECT CASE WHEN total_usage < 1 THEN '< 1 GB' WHEN total_usage < 10 THEN '1-10 GB' WHEN total_usage < 100 THEN '10-100 GB' WHEN total_usage < 1000 THEN '100 GB - 1 TB' ELSE '> 1 TB' END AS size_bucket, COUNT(*) AS table_count FROM (SELECT table_name, SUM(COALESCE(usage_quantity, 0)) AS total_usage FROM ${catalog}.${gold_schema}.fact_predictive_optimization WHERE operation_status = 'SUCCESSFUL' GROUP BY table_name) GROUP BY 1 ORDER BY CASE WHEN size_bucket = '< 1 GB' THEN 1 WHEN size_bucket = '1-10 GB' THEN 2 WHEN size_bucket = '10-100 GB' THEN 3 WHEN size_bucket = '100 GB - 1 TB' THEN 4 ELSE 5 END",
      "displayName": "Size Buckets",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_file_buckets",
      "query": "SELECT operation_type AS file_bucket, COUNT(*) AS table_count FROM ${catalog}.${gold_schema}.fact_predictive_optimization WHERE operation_status = 'SUCCESSFUL' GROUP BY operation_type ORDER BY table_count DESC",
      "displayName": "File Buckets",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_largest_tables",
      "query": "-- Largest tables by row count (size not available in info schema)\nSELECT \n  table_name,\n  table_schema AS schema_name,\n  table_catalog AS catalog_name,\n  table_type,\n  created AS created_at,\n  last_altered\nFROM system.information_schema.tables\nWHERE table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND table_type IN ('MANAGED', 'EXTERNAL')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\nORDER BY last_altered DESC NULLS LAST\nLIMIT 20",
      "displayName": "Largest Tables",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_needs_compaction",
      "query": "-- Tables needing optimization (based on age and activity)\nSELECT \n  table_name,\n  table_schema AS schema_name,\n  table_catalog AS catalog_name,\n  table_type,\n  created,\n  last_altered,\n  CASE \n    WHEN DATEDIFF(CURRENT_DATE(), last_altered) > 365 THEN 'STALE: Not modified in 1+ years'\n    WHEN DATEDIFF(CURRENT_DATE(), last_altered) > 180 THEN 'WARNING: Not modified in 6+ months'\n    WHEN DATEDIFF(CURRENT_DATE(), last_altered) > 90 THEN 'MONITOR: Not modified in 3+ months'\n    ELSE 'OK: Recently modified'\n  END AS optimization_status\nFROM system.information_schema.tables\nWHERE table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND table_type IN ('MANAGED', 'EXTERNAL')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\nORDER BY last_altered ASC NULLS FIRST\nLIMIT 20",
      "displayName": "Needs Compaction",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_empty_tables",
      "query": "-- Recently created tables (potential empty candidates)\nSELECT \n  table_name,\n  table_schema AS schema_name,\n  table_catalog AS catalog_name,\n  table_type,\n  created AS created_at,\n  last_altered\nFROM system.information_schema.tables\nWHERE table_type IN ('MANAGED', 'EXTERNAL')\n  AND table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples')\n  AND (ARRAY_CONTAINS(:param_catalog, 'all') OR ARRAY_CONTAINS(:param_catalog, table_catalog))\n  AND created >= CURRENT_DATE() - INTERVAL 30 DAYS\nORDER BY created DESC\nLIMIT 20",
      "displayName": "Empty Tables",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_monitor_gov_latest",
      "displayName": "Monitor: Governance Latest",
      "query": "SELECT \n  COALESCE(total_lineage_events, 0) AS total_events,\n  COALESCE(active_tables_count, 0) AS active_tables,\n  COALESCE(distinct_users, 0) AS distinct_users,\n  COALESCE(read_event_count, 0) AS read_events,\n  COALESCE(write_event_count, 0) AS write_events\nFROM ${catalog}.${gold_schema}_monitoring.fact_table_lineage_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start >= CURRENT_DATE() - INTERVAL 7 DAYS\nORDER BY window.start DESC\nLIMIT 1"
    },
    {
      "name": "ds_monitor_gov_trend",
      "displayName": "Monitor: Governance Trend",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  COALESCE(total_lineage_events, 0) AS total_events,\n  COALESCE(active_tables_count, 0) AS active_tables,\n  COALESCE(distinct_users, 0) AS distinct_users\nFROM ${catalog}.${gold_schema}_monitoring.fact_table_lineage_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS\nORDER BY window_start"
    },
    {
      "name": "ds_monitor_gov_drift",
      "displayName": "Monitor: Governance Drift",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  COALESCE(lineage_volume_drift_pct, 0) AS event_drift,\n  COALESCE(user_count_drift, 0) AS user_drift,\n  COALESCE(active_tables_drift, 0) AS table_drift\nFROM ${catalog}.${gold_schema}_monitoring.fact_table_lineage_drift_metrics\nWHERE column_name = ':table'\n  AND drift_type = 'CONSECUTIVE'\n  AND slice_key IS NULL\n  AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS\nORDER BY window_start"
    },
    {
      "name": "ds_monitor_gov_detailed",
      "displayName": "Monitor: Governance Detailed",
      "query": "SELECT \n  DATE(window.start) AS window_start,\n  COALESCE(total_lineage_events, 0) AS total_events,\n  COALESCE(active_tables_count, 0) AS active_tables,\n  COALESCE(distinct_users, 0) AS distinct_users,\n  COALESCE(read_event_count, 0) AS read_events,\n  COALESCE(write_event_count, 0) AS write_events,\n  COALESCE(read_write_ratio, 0) AS read_write_ratio\nFROM ${catalog}.${gold_schema}_monitoring.fact_table_lineage_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\n  AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS\nORDER BY window_start DESC\nLIMIT 30"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_catalog",
          "keyword": "param_catalog",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_catalog",
      "displayName": "ds_select_catalog",
      "query": "SELECT 'all' AS catalog_name UNION ALL SELECT DISTINCT table_catalog AS catalog_name FROM system.information_schema.tables WHERE table_catalog NOT IN ('system', 'information_schema', 'hive_metastore', '__databricks_internal', 'samples') ORDER BY 1",
      "parameters": []
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}