{
  "pages": [
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_time_range",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_totals_time_range",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_duration_time_range",
                "query": {
                  "datasetName": "ds_kpi_duration",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_time_range",
                "query": {
                  "datasetName": "ds_kpi_mttr",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_success_trend_time_range",
                "query": {
                  "datasetName": "ds_success_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_status_time_range",
                "query": {
                  "datasetName": "ds_runs_by_status",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_today_time_range",
                "query": {
                  "datasetName": "ds_failed_today",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_time_range",
                "query": {
                  "datasetName": "ds_low_success_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_time_range",
                "query": {
                  "datasetName": "ds_highest_failure_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_by_type_time_range",
                "query": {
                  "datasetName": "ds_failure_by_type",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_trend_by_type_time_range",
                "query": {
                  "datasetName": "ds_failure_trend_by_type",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_time_range",
                "query": {
                  "datasetName": "ds_slowest_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_regression_time_range",
                "query": {
                  "datasetName": "ds_duration_regression",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_outliers_time_range",
                "query": {
                  "datasetName": "ds_duration_outliers",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_hour_time_range",
                "query": {
                  "datasetName": "ds_runs_by_hour",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_day_time_range",
                "query": {
                  "datasetName": "ds_runs_by_day",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_duration_time_range",
                "query": {
                  "datasetName": "ds_monitor_duration",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_run_types_time_range",
                "query": {
                  "datasetName": "ds_monitor_run_types",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_errors_time_range",
                "query": {
                  "datasetName": "ds_monitor_errors",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_stale_count_time_range",
                "query": {
                  "datasetName": "ds_stale_count",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_autoscale_time_range",
                "query": {
                  "datasetName": "ds_no_autoscale",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_stale_datasets_time_range",
                "query": {
                  "datasetName": "ds_stale_datasets",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ap_jobs_time_range",
                "query": {
                  "datasetName": "ds_ap_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outliers_time_range",
                "query": {
                  "datasetName": "ds_outliers",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_totals_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_duration_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_success_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_status_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_today_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_by_type_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_trend_by_type_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_regression_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_outliers_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_hour_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_day_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_latest_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_duration_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_run_types_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_errors_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_detailed_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_stale_count_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_autoscale_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_stale_datasets_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ap_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outliers_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_today_param_workspace",
                "query": {
                  "datasetName": "ds_failed_today",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_low_success_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_highest_failure_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_slowest_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_regression_param_workspace",
                "query": {
                  "datasetName": "ds_duration_regression",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_outliers_param_workspace",
                "query": {
                  "datasetName": "ds_duration_outliers",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_no_autoscale_param_workspace",
                "query": {
                  "datasetName": "ds_no_autoscale",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_stale_datasets_param_workspace",
                "query": {
                  "datasetName": "ds_stale_datasets",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ap_jobs_param_workspace",
                "query": {
                  "datasetName": "ds_ap_jobs",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outliers_param_workspace",
                "query": {
                  "datasetName": "ds_outliers",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_today_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_regression_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_outliers_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_no_autoscale_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_stale_datasets_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ap_jobs_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outliers_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_job_status",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_job_status_status",
                "query": {
                  "datasetName": "ds_select_job_status",
                  "fields": [
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_param_job_status",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_totals_param_job_status",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_duration_param_job_status",
                "query": {
                  "datasetName": "ds_kpi_duration",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_param_job_status",
                "query": {
                  "datasetName": "ds_kpi_mttr",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_success_trend_param_job_status",
                "query": {
                  "datasetName": "ds_success_trend",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_status_param_job_status",
                "query": {
                  "datasetName": "ds_runs_by_status",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_trend_param_job_status",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failed_today_param_job_status",
                "query": {
                  "datasetName": "ds_failed_today",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_param_job_status",
                "query": {
                  "datasetName": "ds_low_success_jobs",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_param_job_status",
                "query": {
                  "datasetName": "ds_highest_failure_jobs",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_by_type_param_job_status",
                "query": {
                  "datasetName": "ds_failure_by_type",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_failure_trend_by_type_param_job_status",
                "query": {
                  "datasetName": "ds_failure_trend_by_type",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_param_job_status",
                "query": {
                  "datasetName": "ds_slowest_jobs",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_regression_param_job_status",
                "query": {
                  "datasetName": "ds_duration_regression",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_outliers_param_job_status",
                "query": {
                  "datasetName": "ds_duration_outliers",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_hour_param_job_status",
                "query": {
                  "datasetName": "ds_runs_by_hour",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_day_param_job_status",
                "query": {
                  "datasetName": "ds_runs_by_day",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_outliers_param_job_status",
                "query": {
                  "datasetName": "ds_outliers",
                  "parameters": [
                    {
                      "name": "param_job_status",
                      "keyword": "param_job_status"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "status",
                    "displayName": "Job Status",
                    "queryName": "dashboards/dummy/datasets/ds_select_job_status_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_totals_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_duration_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_success_trend_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_status_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_trend_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failed_today_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_low_success_jobs_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_highest_failure_jobs_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_by_type_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_failure_trend_by_type_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_slowest_jobs_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_regression_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_outliers_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_hour_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_day_param_job_status"
                  },
                  {
                    "parameterName": "param_job_status",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_outliers_param_job_status"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        }
      ]
    },
    {
      "name": "page_reliability_overview",
      "displayName": "\ud83d\udd04 Reliability Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_success_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "fields": [
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Success Rate (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_runs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Runs (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_failures",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_failures",
                      "expression": "`total_failures`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_failures",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failures (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_duration",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (min)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_mttr",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_mttr",
                  "fields": [
                    {
                      "name": "mttr_minutes",
                      "expression": "`mttr_minutes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mttr_minutes",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTTR (min)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "unique_jobs",
                      "expression": "`unique_jobs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_jobs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Jobs (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_success_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_success_trend",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "success_rate",
                      "displayName": "Success %"
                    },
                    {
                      "fieldName": "failure_rate",
                      "displayName": "Failure %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Success & Failure Rate Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_runs_by_status",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_runs_by_status",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "successful",
                      "expression": "`successful`"
                    },
                    {
                      "name": "failed",
                      "expression": "`failed`"
                    },
                    {
                      "name": "timed_out",
                      "expression": "`timed_out`"
                    },
                    {
                      "name": "cancelled",
                      "expression": "`cancelled`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "successful",
                      "displayName": "Success"
                    },
                    {
                      "fieldName": "failed",
                      "displayName": "Failed"
                    },
                    {
                      "fieldName": "timed_out",
                      "displayName": "Timeout"
                    },
                    {
                      "fieldName": "cancelled",
                      "displayName": "Cancelled"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Runs by Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p50_duration",
                      "expression": "`p50_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg"
                    },
                    {
                      "fieldName": "p50_duration",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f1\ufe0f Duration Percentiles Trend (min)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_failures",
      "displayName": "\u274c Failure Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_failed_today",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_today",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "termination_code",
                      "expression": "`termination_code`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    },
                    {
                      "name": "duration_minutes",
                      "expression": "`duration_minutes`"
                    },
                    {
                      "name": "run_time",
                      "expression": "`run_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "termination_code",
                    "title": "Error",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "tags",
                    "title": "Tags",
                    "type": "string"
                  },
                  {
                    "fieldName": "duration_minutes",
                    "title": "Duration (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "run_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Failed Jobs Today (with Owner & Dependencies)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_low_success",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_low_success_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "failures",
                    "title": "Fails",
                    "type": "number"
                  },
                  {
                    "fieldName": "success_rate",
                    "title": "Success %",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "tags",
                    "title": "Tags",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc9 Jobs with Lowest Success Rate (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_highest_failures",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_highest_failure_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_cost",
                      "expression": "`failure_cost`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "failures",
                    "title": "Failures",
                    "type": "number"
                  },
                  {
                    "fieldName": "success_rate",
                    "title": "Success %",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_cost",
                    "title": "Fail Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "tags",
                    "title": "Tags",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd25 Jobs with Most Failures (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failure_by_type",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failure_by_type",
                  "fields": [
                    {
                      "name": "termination_code",
                      "expression": "`termination_code`"
                    },
                    {
                      "name": "failure_count",
                      "expression": "`failure_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "termination_code",
                  "displayName": "Termination Type",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "angle": {
                  "fieldName": "failure_count",
                  "displayName": "Failures",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Failures by Termination Type (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failure_trend_by_type",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failure_trend_by_type",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "internal_error",
                      "expression": "`internal_error`"
                    },
                    {
                      "name": "timeout",
                      "expression": "`timeout`"
                    },
                    {
                      "name": "cancelled",
                      "expression": "`cancelled`"
                    },
                    {
                      "name": "other",
                      "expression": "`other`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "internal_error",
                      "displayName": "Internal Error"
                    },
                    {
                      "fieldName": "timeout",
                      "displayName": "Timeout"
                    },
                    {
                      "fieldName": "cancelled",
                      "displayName": "Cancelled"
                    },
                    {
                      "fieldName": "other",
                      "displayName": "Other"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Failure Types Over Time"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_most_repaired",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_most_repaired",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "repairs",
                      "expression": "`repairs`"
                    },
                    {
                      "name": "repair_cost",
                      "expression": "`repair_cost`"
                    },
                    {
                      "name": "repair_time_min",
                      "expression": "`repair_time_min`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "tags",
                      "expression": "`tags`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "repairs",
                    "title": "Repairs",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_cost",
                    "title": "Repair Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "repair_time_min",
                    "title": "Repair Time (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "tags",
                    "title": "Tags",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd27 Most Repaired Jobs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_performance",
      "displayName": "\u26a1 Performance Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_slowest_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slowest_jobs",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "max_duration",
                      "expression": "`max_duration`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95 (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_duration",
                    "title": "Max (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc22 Slowest Jobs (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_duration_regression",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_regression",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "last_7d_avg",
                      "expression": "`last_7d_avg`"
                    },
                    {
                      "name": "prev_7d_avg",
                      "expression": "`prev_7d_avg`"
                    },
                    {
                      "name": "increase_pct",
                      "expression": "`increase_pct`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_7d_avg",
                    "title": "Last 7d Avg",
                    "type": "number"
                  },
                  {
                    "fieldName": "prev_7d_avg",
                    "title": "Prev 7d Avg",
                    "type": "number"
                  },
                  {
                    "fieldName": "increase_pct",
                    "title": "Increase %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Jobs with Duration Regression"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_duration_outliers",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_outliers",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "max_duration",
                      "expression": "`max_duration`"
                    },
                    {
                      "name": "p90",
                      "expression": "`p90`"
                    },
                    {
                      "name": "deviation",
                      "expression": "`deviation`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_duration",
                    "title": "Max (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p90",
                    "title": "P90 (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation",
                    "title": "Deviation",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Jobs with Duration Outliers (Max >> P90)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_runs_by_hour",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_runs_by_hour",
                  "fields": [
                    {
                      "name": "hour",
                      "expression": "`hour`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "failures",
                      "expression": "`failures`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hour",
                  "displayName": "Hour of Day",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_runs",
                      "displayName": "Total Runs"
                    },
                    {
                      "fieldName": "failures",
                      "displayName": "Failures"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd50 Job Runs by Hour of Day"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_runs_by_day",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_runs_by_day",
                  "fields": [
                    {
                      "name": "day_name",
                      "expression": "`day_name`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "day_name",
                  "displayName": "Day",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_runs",
                      "displayName": "Runs"
                    },
                    {
                      "fieldName": "success_rate",
                      "displayName": "Success %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc5 Job Runs by Day of Week"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "table_ml_failure_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_failure_risk",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "failure_rate_pct",
                      "expression": "`failure_rate_pct`"
                    },
                    {
                      "name": "risk_level",
                      "expression": "`risk_level`"
                    },
                    {
                      "name": "failure_summary",
                      "expression": "`failure_summary`"
                    },
                    {
                      "name": "last_issue",
                      "expression": "`last_issue`"
                    },
                    {
                      "name": "last_failure",
                      "expression": "`last_failure`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "failure_rate_pct",
                    "title": "Fail Rate %",
                    "type": "number"
                  },
                  {
                    "fieldName": "risk_level",
                    "title": "Risk",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_issue",
                    "title": "Last Error",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_failure",
                    "title": "Last Failure",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Recommended Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Jobs at Risk (Prioritized by Failure Rate)",
                "description": "Based on 30-day failure patterns. Contact owner for resolution."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_pipeline_health",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_pipeline_health",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "health_score",
                      "expression": "`health_score`"
                    },
                    {
                      "name": "health_status",
                      "expression": "`health_status`"
                    },
                    {
                      "name": "trend",
                      "expression": "`trend`"
                    },
                    {
                      "name": "run_summary",
                      "expression": "`run_summary`"
                    },
                    {
                      "name": "action_needed",
                      "expression": "`action_needed`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "health_score",
                    "title": "Health %",
                    "type": "number"
                  },
                  {
                    "fieldName": "health_status",
                    "title": "Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "trend",
                    "title": "Trend",
                    "type": "string"
                  },
                  {
                    "fieldName": "run_summary",
                    "title": "Run Summary",
                    "type": "string"
                  },
                  {
                    "fieldName": "action_needed",
                    "title": "Action Needed",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Pipeline Health Scores",
                "description": "Gradient Boosting health scoring model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_retry_success",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_retry_success",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "retry_success_pct",
                      "expression": "`retry_success_pct`"
                    },
                    {
                      "name": "retry_summary",
                      "expression": "`retry_summary`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    },
                    {
                      "name": "typical_error",
                      "expression": "`typical_error`"
                    },
                    {
                      "name": "action",
                      "expression": "`action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "retry_success_pct",
                    "title": "Retry Success %",
                    "type": "number"
                  },
                  {
                    "fieldName": "retry_summary",
                    "title": "History",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "action",
                    "title": "Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Retry Candidates (Best Success Rate First)",
                "description": "Jobs where auto-retry is most effective based on historical patterns"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_incident_impact",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_incident_impact",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "impact_level",
                      "expression": "`impact_level`"
                    },
                    {
                      "name": "impact_summary",
                      "expression": "`impact_summary`"
                    },
                    {
                      "name": "resource_impact",
                      "expression": "`resource_impact`"
                    },
                    {
                      "name": "last_incident",
                      "expression": "`last_incident`"
                    },
                    {
                      "name": "error_type",
                      "expression": "`error_type`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "impact_level",
                    "title": "Impact",
                    "type": "string"
                  },
                  {
                    "fieldName": "impact_summary",
                    "title": "Summary",
                    "type": "string"
                  },
                  {
                    "fieldName": "resource_impact",
                    "title": "Resources",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_incident",
                    "title": "Last Incident",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " High Impact Jobs (Prioritized by Blast Radius)",
                "description": "Jobs with highest impact when failures occur. Based on frequency, runtime, and active days."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_self_healing",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_self_healing",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "error_pattern",
                      "expression": "`error_pattern`"
                    },
                    {
                      "name": "healing_action",
                      "expression": "`healing_action`"
                    },
                    {
                      "name": "total_occurrences",
                      "expression": "`total_occurrences`"
                    },
                    {
                      "name": "jobs_affected",
                      "expression": "`jobs_affected`"
                    },
                    {
                      "name": "example_affected_job",
                      "expression": "`example_affected_job`"
                    },
                    {
                      "name": "job_owner",
                      "expression": "`job_owner`"
                    },
                    {
                      "name": "implementation_guide",
                      "expression": "`implementation_guide`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "error_pattern",
                    "title": "Error Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "healing_action",
                    "title": "Healing Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_occurrences",
                    "title": "Occurrences",
                    "type": "number"
                  },
                  {
                    "fieldName": "jobs_affected",
                    "title": "Jobs",
                    "type": "number"
                  },
                  {
                    "fieldName": "example_affected_job",
                    "title": "Example Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "job_owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "implementation_guide",
                    "title": "How to Fix",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Error Patterns & Auto-Healing (By Frequency)",
                "description": "Common error patterns with recommended fixes. Ordered by occurrence frequency."
              }
            }
          },
          "position": {
            "x": 3,
            "y": 12,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_duration_forecast",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_duration_forecast",
                  "fields": [
                    {
                      "name": "priority",
                      "expression": "`priority`"
                    },
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "owner",
                      "expression": "`owner`"
                    },
                    {
                      "name": "recent_duration_min",
                      "expression": "`recent_duration_min`"
                    },
                    {
                      "name": "baseline_duration_min",
                      "expression": "`baseline_duration_min`"
                    },
                    {
                      "name": "deviation_pct",
                      "expression": "`deviation_pct`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "priority",
                    "title": "#",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "owner",
                    "title": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "recent_duration_min",
                    "title": "Recent (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "baseline_duration_min",
                    "title": "Baseline (min)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation_pct",
                    "title": "Deviation %",
                    "type": "number"
                  },
                  {
                    "fieldName": "status",
                    "title": "Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Duration Anomalies (Prioritized by Deviation)",
                "description": "Jobs with significant runtime changes vs baseline. Ordered by absolute deviation."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 18,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": " Job Metrics Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_success",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "success_rate_pct",
                      "expression": "`success_rate_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Success Rate"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_runs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Total Runs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_p95",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: P95 Duration"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_rates",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    },
                    {
                      "name": "timeout_rate",
                      "expression": "`timeout_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "success_rate",
                      "displayName": "Success %"
                    },
                    {
                      "fieldName": "failure_rate",
                      "displayName": "Failure %"
                    },
                    {
                      "fieldName": "timeout_rate",
                      "displayName": "Timeout %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Rate Metrics Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_duration",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p50_duration",
                      "expression": "`p50_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "p99_duration",
                      "expression": "`p99_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg"
                    },
                    {
                      "fieldName": "p50_duration",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95"
                    },
                    {
                      "fieldName": "p99_duration",
                      "displayName": "P99"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Duration Percentiles"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_run_types",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_run_types",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "scheduled_runs",
                      "expression": "`scheduled_runs`"
                    },
                    {
                      "name": "manual_runs",
                      "expression": "`manual_runs`"
                    },
                    {
                      "name": "retry_runs",
                      "expression": "`retry_runs`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "scheduled_runs",
                      "displayName": "Scheduled"
                    },
                    {
                      "fieldName": "manual_runs",
                      "displayName": "Manual"
                    },
                    {
                      "fieldName": "retry_runs",
                      "displayName": "Retry"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Run Types Over Time"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_errors",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_errors",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "timeout_count",
                      "expression": "`timeout_count`"
                    },
                    {
                      "name": "cancelled_count",
                      "expression": "`cancelled_count`"
                    },
                    {
                      "name": "internal_error_count",
                      "expression": "`internal_error_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "timeout_count",
                      "displayName": "Timeout"
                    },
                    {
                      "fieldName": "cancelled_count",
                      "displayName": "Cancelled"
                    },
                    {
                      "fieldName": "internal_error_count",
                      "displayName": "Internal Error"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Error Types Breakdown"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 14,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "success_rate_drift",
                      "expression": "`success_rate_drift`"
                    },
                    {
                      "name": "duration_drift",
                      "expression": "`duration_drift`"
                    },
                    {
                      "name": "volume_drift",
                      "expression": "`volume_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "success_rate_drift",
                      "displayName": "Success Rate Drift"
                    },
                    {
                      "fieldName": "duration_drift",
                      "displayName": "Duration Drift %"
                    },
                    {
                      "fieldName": "volume_drift",
                      "displayName": "Volume Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Drift Detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "retry_runs",
                      "expression": "`retry_runs`"
                    },
                    {
                      "name": "distinct_jobs",
                      "expression": "`distinct_jobs`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "success_rate",
                    "title": "Success %",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_rate",
                    "title": "Fail %",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95",
                    "type": "number"
                  },
                  {
                    "fieldName": "retry_runs",
                    "title": "Retries",
                    "type": "number"
                  },
                  {
                    "fieldName": "distinct_jobs",
                    "title": "Jobs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 26,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_optimization",
      "displayName": "Optimization Opportunities",
      "layout": [
        {
          "widget": {
            "name": "kpi_jobs_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_autoscale_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Without Autoscaling",
                "description": "Jobs with fixed worker counts"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_stale_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Stale Dataset Jobs",
                "description": "Jobs producing unused outputs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_ap_cluster_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ap_count",
                  "fields": [
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs on All-Purpose",
                "description": "Jobs running on interactive clusters"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "table_no_autoscale",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_no_autoscale",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cost_30d",
                      "expression": "`cost_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cost_30d",
                    "title": "Cost (30d)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Without Autoscaling"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_stale_datasets",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_stale_datasets",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "unused_tables",
                      "expression": "`unused_tables`"
                    },
                    {
                      "name": "runs_30d",
                      "expression": "`runs_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "unused_tables",
                    "title": "Unused Tables",
                    "type": "number"
                  },
                  {
                    "fieldName": "runs_30d",
                    "title": "Runs (30d)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Producing Stale Datasets"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ap_clusters",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ap_jobs",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cluster_name",
                      "expression": "`cluster_name`"
                    },
                    {
                      "name": "task_runs",
                      "expression": "`task_runs`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "cluster_name",
                    "title": "Cluster",
                    "type": "string"
                  },
                  {
                    "fieldName": "task_runs",
                    "title": "Task Runs",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs Using All-Purpose Clusters"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_outlier_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_outliers",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "runs",
                      "expression": "`runs`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "p90_cost",
                      "expression": "`p90_cost`"
                    },
                    {
                      "name": "max_cost",
                      "expression": "`max_cost`"
                    },
                    {
                      "name": "deviation",
                      "expression": "`deviation`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_cost",
                    "title": "Avg Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p90_cost",
                    "title": "P90 Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "max_cost",
                    "title": "Max Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "deviation",
                    "title": "Deviation ($)",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Jobs with Cost Outliers"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 8,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "reliability_lakehouse_monitoring",
      "displayName": " Advanced Job Metrics",
      "layout": [
        {
          "widget": {
            "name": "reliability_time_start_filter",
            "queries": [
              {
                "name": "param_ds_monitor_reliability_aggregate_time_start",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_derived_time_start",
                "query": {
                  "datasetName": "ds_monitor_reliability_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_drift_time_start",
                "query": {
                  "datasetName": "ds_monitor_reliability_drift",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_keys_time_start",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_values_time_start",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_start",
                      "keyword": "monitor_time_start"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_reliability_aggregate_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_reliability_derived_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_reliability_drift_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_reliability_slice_keys_time_start"
                  },
                  {
                    "parameterName": "monitor_time_start",
                    "queryName": "param_ds_monitor_reliability_slice_values_time_start"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "reliability_time_end_filter",
            "queries": [
              {
                "name": "param_ds_monitor_reliability_aggregate_time_end",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_derived_time_end",
                "query": {
                  "datasetName": "ds_monitor_reliability_derived",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_drift_time_end",
                "query": {
                  "datasetName": "ds_monitor_reliability_drift",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_keys_time_end",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_keys",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_values_time_end",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_time_end",
                      "keyword": "monitor_time_end"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_reliability_aggregate_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_reliability_derived_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_reliability_drift_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_reliability_slice_keys_time_end"
                  },
                  {
                    "parameterName": "monitor_time_end",
                    "queryName": "param_ds_monitor_reliability_slice_values_time_end"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "End Time:"
              },
              "version": 2,
              "widgetType": "filter-date-picker"
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "reliability_slice_key_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_keys",
                  "fields": [
                    {
                      "name": "slice_key",
                      "expression": "`slice_key`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_reliability_aggregate_slice_key",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_derived_slice_key",
                "query": {
                  "datasetName": "ds_monitor_reliability_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_drift_slice_key",
                "query": {
                  "datasetName": "ds_monitor_reliability_drift",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_values_slice_key",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_key",
                      "keyword": "monitor_slice_key"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Key",
                    "fieldName": "slice_key",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_reliability_aggregate_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_reliability_derived_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_reliability_drift_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_reliability_slice_values_slice_key"
                  },
                  {
                    "parameterName": "monitor_slice_key",
                    "queryName": "param_ds_monitor_reliability_slice_values_slice_key"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Key:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "reliability_slice_value_filter",
            "queries": [
              {
                "name": "source_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "fields": [
                    {
                      "name": "slice_value",
                      "expression": "`slice_value`"
                    }
                  ],
                  "disaggregated": true
                }
              },
              {
                "name": "param_ds_monitor_reliability_aggregate_slice_value",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_derived_slice_value",
                "query": {
                  "datasetName": "ds_monitor_reliability_derived",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_drift_slice_value",
                "query": {
                  "datasetName": "ds_monitor_reliability_drift",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ds_monitor_reliability_slice_values_slice_value",
                "query": {
                  "datasetName": "ds_monitor_reliability_slice_values",
                  "parameters": [
                    {
                      "name": "monitor_slice_value",
                      "keyword": "monitor_slice_value"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "encodings": {
                "fields": [
                  {
                    "displayName": "Slice Value",
                    "fieldName": "slice_value",
                    "queryName": "source_query"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_reliability_aggregate_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_reliability_derived_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_reliability_drift_slice_value"
                  },
                  {
                    "parameterName": "monitor_slice_value",
                    "queryName": "param_ds_monitor_reliability_slice_values_slice_value"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Slice Value:"
              },
              "version": 2,
              "widgetType": "filter-single-select"
            }
          },
          "position": {
            "x": 9,
            "y": 0,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "reliability_aggregate_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "success_count",
                      "expression": "`success_count`"
                    },
                    {
                      "name": "failure_count",
                      "expression": "`failure_count`"
                    },
                    {
                      "name": "timeout_count",
                      "expression": "`timeout_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Total Runs",
                      "fieldName": "total_runs"
                    },
                    {
                      "displayName": "Success Count",
                      "fieldName": "success_count"
                    },
                    {
                      "displayName": "Failure Count",
                      "fieldName": "failure_count"
                    },
                    {
                      "displayName": "Timeout Count",
                      "fieldName": "timeout_count"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track reliability aggregate metrics over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Reliability Aggregate Metrics Over Time"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "reliability_derived_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_derived",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    },
                    {
                      "name": "timeout_rate",
                      "expression": "`timeout_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": {
                    "title": "Time"
                  },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "displayName": "Success Rate",
                      "fieldName": "success_rate"
                    },
                    {
                      "displayName": "Failure Rate",
                      "fieldName": "failure_rate"
                    },
                    {
                      "displayName": "Timeout Rate",
                      "fieldName": "timeout_rate"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "description": "Track reliability business ratios over time",
                "showDescription": true,
                "showTitle": true,
                "title": "Reliability KPI Trends"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 6,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "reliability_drift_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_drift",
                  "fields": [
                    { "name": "window_start", "expression": "`window_start`" },
                    { "name": "success_rate_drift", "expression": "`success_rate_drift`" },
                    { "name": "duration_drift", "expression": "`duration_drift`" },
                    { "name": "volume_drift", "expression": "`volume_drift`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "encodings": {
                "x": {
                  "axis": { "title": "Time" },
                  "displayName": "Window",
                  "fieldName": "window_start",
                  "scale": { "type": "temporal" }
                },
                "y": {
                  "fields": [
                    { "displayName": "Success Rate Drift %", "fieldName": "success_rate_drift" },
                    { "displayName": "Duration Drift %", "fieldName": "duration_drift" },
                    { "displayName": "Volume Drift %", "fieldName": "volume_drift" }
                  ],
                  "scale": { "type": "quantitative" }
                }
              },
              "frame": {
                "description": "Track period-over-period changes in success rate, duration, and job volume",
                "showDescription": true,
                "showTitle": true,
                "title": "Drift Metrics (Period Comparison)"
              },
              "version": 3,
              "widgetType": "line"
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 12,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "reliability_aggregate_table",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_reliability_aggregate",
                  "fields": [
                    { "name": "window_start", "expression": "`window_start`" },
                    { "name": "total_runs", "expression": "`total_runs`" },
                    { "name": "success_count", "expression": "`success_count`" },
                    { "name": "failure_count", "expression": "`failure_count`" },
                    { "name": "timeout_count", "expression": "`timeout_count`" },
                    { "name": "distinct_jobs", "expression": "`distinct_jobs`" }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "frame": {
                "showTitle": true,
                "title": " Reliability Aggregate Metrics"
              },
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm",
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 0,
                    "title": "Window Start"
                  },
                  {
                    "fieldName": "window_end",
                    "dateTimeFormat": "DD/MM/YYYY HH:mm",
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 1,
                    "title": "Window End"
                  },
                  {
                    "fieldName": "total_runs",
                    "type": "number",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2,
                    "title": "Total Runs"
                  },
                  {
                    "fieldName": "success_count",
                    "type": "number",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "Success Count"
                  },
                  {
                    "fieldName": "failure_count",
                    "type": "number",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4,
                    "title": "Failure Count"
                  },
                  {
                    "fieldName": "timeout_count",
                    "type": "number",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5,
                    "title": "Timeout Count"
                  },
                  {
                    "fieldName": "distinct_jobs",
                    "type": "number",
                    "displayAs": "number",
                    "visible": true,
                    "order": 6,
                    "title": "Distinct Jobs"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 12,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_success_rate",
      "displayName": "KPI: Success Rate",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS success_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code IS NOT NULL",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_totals",
      "displayName": "KPI: Totals",
      "query": "SELECT COUNT(*) AS total_runs, SUM(CASE WHEN termination_code IS NOT NULL AND termination_code != 'SUCCESS' THEN 1 ELSE 0 END) AS total_failures, COUNT(DISTINCT job_id) AS unique_jobs FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code IS NOT NULL",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_duration",
      "displayName": "KPI: Duration",
      "query": "SELECT ROUND(PERCENTILE(run_duration_seconds / 60.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code = 'SUCCESS' AND run_duration_seconds IS NOT NULL",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_kpi_mttr",
      "displayName": "KPI: MTTR",
      "query": "SELECT COALESCE(ROUND(AVG(run_duration_seconds / 60.0), 1), 0) AS mttr_minutes FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code IS NOT NULL AND termination_code != 'SUCCESS'",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_success_trend",
      "displayName": "Success Trend",
      "query": "SELECT DATE(run_date) AS run_date, ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate, ROUND(SUM(CASE WHEN termination_code IS NOT NULL AND termination_code != 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code IS NOT NULL GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_runs_by_status",
      "displayName": "Runs by Status",
      "query": "-- Daily job runs by status using result_state (handles various status spellings)\nSELECT \n  DATE(run_date) AS run_date,\n  SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS successful,\n  SUM(CASE WHEN result_state IN ('FAILED', 'INTERNAL_ERROR', 'ERROR') THEN 1 ELSE 0 END) AS failed,\n  SUM(CASE WHEN result_state IN ('TIMEDOUT', 'TIMED_OUT', 'TIMEOUT') OR termination_code IN ('TIMEDOUT', 'TIMED_OUT') THEN 1 ELSE 0 END) AS timed_out,\n  SUM(CASE WHEN result_state IN ('CANCELED', 'CANCELLED') OR termination_code IN ('CANCELED', 'CANCELLED', 'USER_CANCELLED') THEN 1 ELSE 0 END) AS cancelled\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline\nWHERE run_date BETWEEN :time_range.min AND :time_range.max\n  AND result_state IS NOT NULL\nGROUP BY 1\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_duration_trend",
      "displayName": "Duration Trend",
      "query": "SELECT DATE(run_date) AS run_date, ROUND(AVG(run_duration_seconds / 60.0), 1) AS avg_duration, ROUND(PERCENTILE(run_duration_seconds / 60.0, 0.5), 1) AS p50_duration, ROUND(PERCENTILE(run_duration_seconds / 60.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code = 'SUCCESS' AND run_duration_seconds IS NOT NULL GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_failed_today",
      "displayName": "Failed Today",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name,\n  COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name,\n  f.termination_code,\n  f.run_date AS run_time,\n  ROUND(f.run_duration_seconds / 60.0, 1) AS duration_minutes,\n  COALESCE(u.email, j.run_as, j.creator_id, 'Unknown') AS owner,\n  COALESCE(j.tags_json, '{}') AS tags\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline f\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j \n  ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.dim_workspace w \n  ON f.workspace_id = w.workspace_id\nLEFT JOIN ${catalog}.${gold_schema}.dim_user u \n  ON CAST(COALESCE(j.run_as, j.creator_id) AS STRING) = u.user_id\nWHERE f.run_date BETWEEN :time_range.min AND :time_range.max\n  AND f.termination_code IS NOT NULL \n  AND f.termination_code NOT IN ('SUCCESS', 'SKIPPED')\n  AND (ARRAY_CONTAINS(:param_workspace, 'all') OR ARRAY_CONTAINS(:param_workspace, w.workspace_name))\nORDER BY f.run_date DESC\nLIMIT 50",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_low_success_jobs",
      "displayName": "Low Success Jobs",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name,\n  COUNT(*) AS total_runs,\n  SUM(CASE WHEN f.termination_code IS NOT NULL AND f.termination_code != 'SUCCESS' THEN 1 ELSE 0 END) AS failures,\n  ROUND(SUM(CASE WHEN f.termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS success_rate,\n  COALESCE(u.email, j.run_as, j.creator_id, 'Unknown') AS owner,\n  COALESCE(j.tags_json, '{}') AS tags\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline f\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.dim_user u ON CAST(COALESCE(j.run_as, j.creator_id) AS STRING) = u.user_id\nWHERE f.run_date BETWEEN :time_range.min AND :time_range.max \n  AND f.termination_code IS NOT NULL\nGROUP BY 1, u.email, j.run_as, j.creator_id, j.tags_json\nHAVING COUNT(*) >= 5\nORDER BY success_rate ASC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_highest_failure_jobs",
      "displayName": "Highest Failure Jobs",
      "query": "SELECT \n  COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name,\n  SUM(CASE WHEN f.termination_code IS NOT NULL AND f.termination_code != 'SUCCESS' THEN 1 ELSE 0 END) AS failures,\n  ROUND(SUM(CASE WHEN f.termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 2) AS success_rate,\n  ROUND(SUM(CASE WHEN f.termination_code != 'SUCCESS' THEN COALESCE(f.run_duration_seconds, 0) / 3600.0 * 0.15 ELSE 0 END), 2) AS failure_cost,\n  COALESCE(u.email, j.run_as, j.creator_id, 'Unknown') AS owner,\n  COALESCE(j.tags_json, '{}') AS tags\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline f\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.dim_user u ON CAST(COALESCE(j.run_as, j.creator_id) AS STRING) = u.user_id\nWHERE f.run_date BETWEEN :time_range.min AND :time_range.max \n  AND f.termination_code IS NOT NULL\nGROUP BY 1, u.email, j.run_as, j.creator_id, j.tags_json\nORDER BY failures DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_failure_by_type",
      "displayName": "Failure by Type",
      "query": "SELECT COALESCE(termination_code, 'UNKNOWN') AS termination_code, COUNT(*) AS failure_count FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date BETWEEN :time_range.min AND :time_range.max AND result_state NOT IN ('SUCCESS', 'SUCCEEDED') GROUP BY 1 ORDER BY failure_count DESC LIMIT 10",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_failure_trend_by_type",
      "displayName": "Failure Trend by Type",
      "query": "SELECT DATE(run_date) AS run_date, SUM(CASE WHEN termination_code = 'INTERNAL_ERROR' THEN 1 ELSE 0 END) AS internal_error, SUM(CASE WHEN termination_code = 'TIMED_OUT' THEN 1 ELSE 0 END) AS timeout, SUM(CASE WHEN termination_code = 'CANCELLED' THEN 1 ELSE 0 END) AS cancelled, SUM(CASE WHEN termination_code NOT IN ('SUCCESS', 'INTERNAL_ERROR', 'TIMED_OUT', 'CANCELLED') AND termination_code IS NOT NULL THEN 1 ELSE 0 END) AS other FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_most_repaired",
      "displayName": "Most Repaired",
      "query": "-- Jobs with most retry/repair runs (failures followed by success within same job)\nWITH job_runs AS (\n  SELECT \n    f.job_id,\n    f.workspace_id,\n    f.run_date,\n    f.result_state,\n    f.run_duration_seconds,\n    LEAD(f.result_state) OVER (PARTITION BY f.job_id ORDER BY f.period_start_time) AS next_state,\n    LEAD(f.run_duration_seconds) OVER (PARTITION BY f.job_id ORDER BY f.period_start_time) AS retry_duration\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline f\n  WHERE f.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nrepair_runs AS (\n  SELECT \n    job_id,\n    workspace_id,\n    COUNT(*) AS repairs,\n    SUM(retry_duration) AS total_repair_seconds\n  FROM job_runs\n  WHERE result_state IN ('FAILED', 'ERROR', 'INTERNAL_ERROR')\n    AND next_state IN ('SUCCESS', 'SUCCEEDED')\n  GROUP BY job_id, workspace_id\n)\nSELECT \n  COALESCE(j.name, CAST(r.job_id AS STRING)) AS job_name,\n  r.repairs,\n  ROUND(r.repairs * 0.50, 2) AS repair_cost,\n  ROUND(r.total_repair_seconds / 60.0, 1) AS repair_time_min,\n  COALESCE(u.email, j.run_as, j.creator_id, 'Unknown') AS owner,\n  COALESCE(j.tags_json, '{}') AS tags\nFROM repair_runs r\nLEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\nLEFT JOIN ${catalog}.${gold_schema}.dim_user u ON CAST(COALESCE(j.run_as, j.creator_id) AS STRING) = u.user_id\nWHERE r.repairs > 0\nORDER BY r.repairs DESC\nLIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_slowest_jobs",
      "displayName": "Slowest Jobs",
      "query": "SELECT COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name, ROUND(AVG(f.run_duration_seconds / 60.0), 1) AS avg_duration, ROUND(PERCENTILE(f.run_duration_seconds / 60.0, 0.95), 1) AS p95_duration, ROUND(MAX(f.run_duration_seconds / 60.0), 1) AS max_duration, COUNT(*) AS runs FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id WHERE f.run_date BETWEEN :time_range.min AND :time_range.max AND f.termination_code = 'SUCCESS' AND f.run_duration_seconds IS NOT NULL GROUP BY 1 HAVING COUNT(*) >= 3 ORDER BY avg_duration DESC LIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_duration_regression",
      "displayName": "Duration Regression",
      "query": "WITH job_duration AS (SELECT COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name, AVG(CASE WHEN f.run_date BETWEEN :time_range.min AND :time_range.max THEN f.run_duration_seconds / 60.0 END) AS last_7d_avg, AVG(CASE WHEN f.run_date BETWEEN CURRENT_DATE() - INTERVAL 14 DAYS AND CURRENT_DATE() - INTERVAL 8 DAYS THEN f.run_duration_seconds / 60.0 END) AS prev_7d_avg FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id WHERE f.run_date BETWEEN :time_range.min AND :time_range.max AND f.termination_code = 'SUCCESS' AND f.run_duration_seconds IS NOT NULL GROUP BY 1) SELECT job_name, ROUND(last_7d_avg, 1) AS last_7d_avg, ROUND(prev_7d_avg, 1) AS prev_7d_avg, ROUND((last_7d_avg - prev_7d_avg) * 100.0 / NULLIF(prev_7d_avg, 0), 1) AS increase_pct FROM job_duration WHERE prev_7d_avg > 0 AND last_7d_avg > prev_7d_avg * 1.2 ORDER BY increase_pct DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_duration_outliers",
      "displayName": "Duration Outliers",
      "query": "WITH job_stats AS (SELECT COALESCE(j.name, CAST(f.job_id AS STRING)) AS job_name, AVG(f.run_duration_seconds / 60.0) AS avg_duration, MAX(f.run_duration_seconds / 60.0) AS max_duration, PERCENTILE(f.run_duration_seconds / 60.0, 0.9) AS p90 FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.workspace_id = j.workspace_id AND f.job_id = j.job_id WHERE f.run_date BETWEEN :time_range.min AND :time_range.max AND f.termination_code = 'SUCCESS' AND f.run_duration_seconds IS NOT NULL GROUP BY 1 HAVING COUNT(*) >= 5) SELECT job_name, ROUND(avg_duration, 1) AS avg_duration, ROUND(max_duration, 1) AS max_duration, ROUND(p90, 1) AS p90, ROUND(max_duration - p90, 1) AS deviation FROM job_stats WHERE max_duration > p90 * 1.5 ORDER BY deviation DESC LIMIT 15",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_runs_by_hour",
      "displayName": "Runs by Hour",
      "query": "SELECT HOUR(run_date) AS hour, COUNT(*) AS total_runs, SUM(CASE WHEN termination_code IS NOT NULL AND termination_code != 'SUCCESS' THEN 1 ELSE 0 END) AS failures FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max GROUP BY 1 ORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_runs_by_day",
      "displayName": "Runs by Day",
      "query": "SELECT DATE_FORMAT(run_date, 'EEEE') AS day_name, COUNT(*) AS total_runs, ROUND(SUM(CASE WHEN termination_code = 'SUCCESS' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate FROM ${catalog}.${gold_schema}.fact_job_run_timeline  WHERE run_date BETWEEN :time_range.min AND :time_range.max AND termination_code IS NOT NULL GROUP BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ml_failure_risk",
      "displayName": "ML: Failure Risk",
      "query": "-- Actionable failure risk with context, owner, and last failure details\nWITH job_stats AS (\n  SELECT \n    r.job_id,\n    COALESCE(j.name, CAST(r.job_id AS STRING)) AS job_name,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS failed_runs,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.run_date END) AS last_failure_date,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.result_state END) AS last_failure_state,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.termination_code END) AS last_error_code,\n    ROUND(STDDEV(r.run_duration_seconds), 1) AS duration_variance,\n    AVG(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.run_duration_seconds END) AS avg_failure_duration\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\n  WHERE r.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY r.job_id, j.name, j.creator_id\n  HAVING COUNT(*) >= 3\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY (failed_runs * 100.0 / total_runs) DESC) AS priority,\n  job_name,\n  owner,\n  ROUND(failed_runs * 100.0 / total_runs, 1) AS failure_rate_pct,\n  CASE \n    WHEN failed_runs * 100.0 / total_runs > 50 THEN 'CRITICAL'\n    WHEN failed_runs * 100.0 / total_runs > 25 THEN 'HIGH'\n    WHEN failed_runs * 100.0 / total_runs > 10 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS risk_level,\n  failed_runs || ' of ' || total_runs || ' runs failed' AS failure_summary,\n  COALESCE(last_failure_state, 'N/A') || COALESCE(' (' || last_error_code || ')', '') AS last_issue,\n  COALESCE(CAST(last_failure_date AS STRING), 'N/A') AS last_failure,\n  CASE \n    WHEN last_error_code LIKE '%TIMEOUT%' THEN 'Increase timeout or optimize job'\n    WHEN last_error_code LIKE '%OOM%' OR last_error_code LIKE '%MEMORY%' THEN 'Increase cluster memory'\n    WHEN last_error_code LIKE '%INTERNAL%' THEN 'Check cluster health, retry may help'\n    WHEN duration_variance > 300 THEN 'High duration variance - investigate data skew'\n    WHEN failed_runs * 100.0 / total_runs > 50 THEN 'Critical: Review job config and dependencies'\n    ELSE 'Review logs for recent failures'\n  END AS recommended_action\nFROM job_stats\nWHERE failed_runs > 0\nORDER BY (failed_runs * 100.0 / total_runs) DESC\nLIMIT 15"
    },
    {
      "name": "ds_ml_pipeline_health",
      "displayName": "ML: Pipeline Health",
      "query": "-- Pipeline health score based on success rate, consistency, and recent trend\nWITH job_health AS (\n  SELECT \n    r.job_id,\n    COALESCE(j.name, CAST(r.job_id AS STRING)) AS job_name,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN r.result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS success_runs,\n    AVG(r.run_duration_seconds) AS avg_duration,\n    STDDEV(r.run_duration_seconds) AS duration_stddev,\n    MAX(r.run_date) AS last_run_date,\n    MAX(CASE WHEN r.result_state IN ('SUCCESS', 'SUCCEEDED') THEN r.run_date END) AS last_success_date,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.run_date END) AS last_failure_date\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\n  WHERE r.run_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n  GROUP BY r.job_id, j.name, j.creator_id\n  HAVING COUNT(*) >= 3\n),\nrecent_health AS (\n  SELECT job_id,\n    SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS recent_success_rate\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= CURRENT_DATE() - INTERVAL 3 DAYS\n  GROUP BY job_id\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY (jh.success_runs * 100.0 / jh.total_runs) ASC) AS priority,\n  jh.job_name,\n  jh.owner,\n  ROUND(jh.success_runs * 100.0 / jh.total_runs, 0) AS health_score,\n  CASE \n    WHEN jh.success_runs * 100.0 / jh.total_runs >= 95 THEN ' Healthy'\n    WHEN jh.success_runs * 100.0 / jh.total_runs >= 80 THEN ' Degraded'\n    WHEN jh.success_runs * 100.0 / jh.total_runs >= 50 THEN ' Poor'\n    ELSE ' Critical'\n  END AS health_status,\n  CASE \n    WHEN COALESCE(rh.recent_success_rate, 0) > jh.success_runs * 100.0 / jh.total_runs THEN ' Improving'\n    WHEN COALESCE(rh.recent_success_rate, 0) < jh.success_runs * 100.0 / jh.total_runs - 10 THEN ' Declining'\n    ELSE ' Stable'\n  END AS trend,\n  jh.total_runs || ' runs, ' || (jh.total_runs - jh.success_runs) || ' failed' AS run_summary,\n  CASE \n    WHEN jh.last_failure_date > jh.last_success_date THEN 'Last run failed - investigate immediately'\n    WHEN jh.success_runs * 100.0 / jh.total_runs < 50 THEN 'Critical: Review job config and dependencies'\n    WHEN COALESCE(rh.recent_success_rate, 0) < 80 THEN 'Recent degradation - check recent changes'\n    ELSE 'Monitor for further issues'\n  END AS action_needed\nFROM job_health jh\nLEFT JOIN recent_health rh ON jh.job_id = rh.job_id\nWHERE jh.success_runs * 100.0 / jh.total_runs < 95\nORDER BY (jh.success_runs * 100.0 / jh.total_runs) ASC\nLIMIT 15"
    },
    {
      "name": "ds_ml_retry_success",
      "displayName": "ML: Retry Success",
      "query": "-- Jobs where retry is likely to succeed based on historical retry patterns\nWITH job_retries AS (\n  SELECT \n    r1.job_id,\n    COALESCE(j.name, CAST(r1.job_id AS STRING)) AS job_name,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    r1.result_state AS initial_state,\n    r1.termination_code AS error_code,\n    r2.result_state AS retry_state,\n    r1.run_date\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r1\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r1.job_id = j.job_id\n  JOIN ${catalog}.${gold_schema}.fact_job_run_timeline r2 \n    ON r1.job_id = r2.job_id \n    AND DATE(r1.run_date) = DATE(r2.run_date)\n    AND r2.period_start_time > r1.period_start_time\n    AND r2.period_start_time < r1.period_start_time + INTERVAL 4 HOURS\n  WHERE r1.result_state NOT IN ('SUCCESS', 'SUCCEEDED')\n    AND r1.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nretry_stats AS (\n  SELECT \n    job_id,\n    job_name,\n    owner,\n    COUNT(*) AS total_retries,\n    SUM(CASE WHEN retry_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS successful_retries,\n    MAX(error_code) AS common_error,\n    MAX(run_date) AS last_retry_date\n  FROM job_retries\n  GROUP BY job_id, job_name, owner\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY (successful_retries * 100.0 / total_retries) DESC) AS priority,\n  job_name,\n  owner,\n  ROUND(successful_retries * 100.0 / total_retries, 0) AS retry_success_pct,\n  successful_retries || ' of ' || total_retries || ' retries succeeded' AS retry_summary,\n  CASE \n    WHEN successful_retries * 100.0 / total_retries >= 80 THEN ' Auto-retry recommended'\n    WHEN successful_retries * 100.0 / total_retries >= 50 THEN ' Retry may help'\n    ELSE ' Investigate first'\n  END AS recommendation,\n  COALESCE(common_error, 'Unknown') AS typical_error,\n  CASE \n    WHEN successful_retries * 100.0 / total_retries >= 80 THEN 'Configure max_retries=3 in job settings'\n    WHEN common_error LIKE '%TIMEOUT%' THEN 'Increase timeout before retry'\n    WHEN common_error LIKE '%OOM%' THEN 'Increase cluster resources'\n    ELSE 'Review logs before enabling auto-retry'\n  END AS action\nFROM retry_stats\nWHERE total_retries >= 2\nORDER BY (successful_retries * 100.0 / total_retries) DESC, total_retries DESC\nLIMIT 15"
    },
    {
      "name": "ds_ml_incident_impact",
      "displayName": "ML: Incident Impact",
      "query": "-- Jobs with highest impact when they fail (based on frequency and recent failures)\nWITH job_impact AS (\n  SELECT \n    r.job_id,\n    COALESCE(j.name, CAST(r.job_id AS STRING)) AS job_name,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS failed_runs,\n    AVG(r.run_duration_seconds / 60.0) AS avg_duration_min,\n    COUNT(DISTINCT DATE(r.run_date)) AS active_days,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.run_date END) AS last_failure,\n    MAX(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN r.termination_code END) AS last_error\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\n  WHERE r.run_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n  GROUP BY r.job_id, j.name, j.creator_id\n  HAVING SUM(CASE WHEN r.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) > 0\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY (active_days * failed_runs * avg_duration_min) DESC) AS priority,\n  job_name,\n  owner,\n  CASE \n    WHEN active_days >= 12 AND failed_runs > 5 THEN ' Critical'\n    WHEN active_days >= 7 AND failed_runs > 2 THEN ' High'\n    WHEN active_days >= 3 THEN ' Medium'\n    ELSE ' Low'\n  END AS impact_level,\n  active_days || ' days active, ' || failed_runs || ' failures' AS impact_summary,\n  ROUND(avg_duration_min, 1) || ' min avg runtime' AS resource_impact,\n  COALESCE(CAST(last_failure AS STRING), 'N/A') AS last_incident,\n  COALESCE(last_error, 'Unknown') AS error_type,\n  CASE \n    WHEN active_days >= 12 THEN 'Critical path job - prioritize fix and add monitoring'\n    WHEN failed_runs > 5 THEN 'Frequent failures - investigate root cause'\n    WHEN avg_duration_min > 60 THEN 'Long-running job - failures waste significant resources'\n    ELSE 'Monitor and fix when capacity allows'\n  END AS recommended_action\nFROM job_impact\nORDER BY (active_days * failed_runs * avg_duration_min) DESC\nLIMIT 15"
    },
    {
      "name": "ds_ml_self_healing",
      "displayName": "ML: Self Healing",
      "query": "-- Self-healing recommendations based on error patterns and historical resolution\nWITH error_patterns AS (\n  SELECT \n    r.termination_code AS error_pattern,\n    COALESCE(j.name, CAST(r.job_id AS STRING)) AS example_job,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    COUNT(*) AS occurrences,\n    COUNT(DISTINCT r.job_id) AS affected_jobs,\n    MAX(r.run_date) AS last_seen\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\n  WHERE r.result_state NOT IN ('SUCCESS', 'SUCCEEDED')\n    AND r.run_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n    AND r.termination_code IS NOT NULL\n  GROUP BY r.termination_code, j.name, r.job_id, j.creator_id\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY occurrences DESC) AS priority,\n  error_pattern,\n  CASE \n    WHEN error_pattern LIKE '%TIMEOUT%' OR error_pattern LIKE '%TIMED_OUT%' THEN ' Auto-retry with backoff'\n    WHEN error_pattern LIKE '%OOM%' OR error_pattern LIKE '%MEMORY%' THEN ' Scale cluster memory'\n    WHEN error_pattern LIKE '%INTERNAL%' THEN ' Auto-retry (transient)'\n    WHEN error_pattern LIKE '%CANCEL%' THEN ' Manual review needed'\n    WHEN error_pattern LIKE '%DRIVER%' THEN ' Check driver logs'\n    WHEN error_pattern LIKE '%NETWORK%' OR error_pattern LIKE '%CONNECTION%' THEN ' Retry with network check'\n    ELSE ' Manual investigation'\n  END AS healing_action,\n  occurrences AS total_occurrences,\n  affected_jobs AS jobs_affected,\n  example_job AS example_affected_job,\n  owner AS job_owner,\n  CASE \n    WHEN error_pattern LIKE '%TIMEOUT%' THEN 'Configure retry policy: max_retries=3, retry_on_timeout=true'\n    WHEN error_pattern LIKE '%OOM%' THEN 'Increase spark.executor.memory or use larger instance type'\n    WHEN error_pattern LIKE '%INTERNAL%' THEN 'Usually transient - auto-retry resolves 80%+ cases'\n    WHEN error_pattern LIKE '%CANCEL%' THEN 'Check if job was manually cancelled or hit cluster termination'\n    ELSE 'Review job logs in Spark UI for detailed error'\n  END AS implementation_guide\nFROM error_patterns\nWHERE occurrences >= 2\nORDER BY occurrences DESC\nLIMIT 15"
    },
    {
      "name": "ds_ml_duration_forecast",
      "displayName": "ML: Duration Forecast",
      "query": "-- Duration analysis: Jobs with significant deviation from baseline (prioritized by impact)\nWITH job_durations AS (\n  SELECT \n    r.job_id,\n    COALESCE(j.name, CAST(r.job_id AS STRING)) AS job_name,\n    COALESCE(j.creator_id, 'Unknown') AS owner,\n    COUNT(*) AS total_runs,\n    ROUND(AVG(r.run_duration_seconds / 60.0), 1) AS avg_duration_min,\n    ROUND(PERCENTILE(r.run_duration_seconds / 60.0, 0.5), 1) AS median_duration_min,\n    ROUND(PERCENTILE(r.run_duration_seconds / 60.0, 0.95), 1) AS p95_duration_min,\n    ROUND(MAX(r.run_duration_seconds / 60.0), 1) AS max_duration_min,\n    ROUND(STDDEV(r.run_duration_seconds / 60.0), 1) AS std_dev_min\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON r.job_id = j.job_id\n  WHERE r.run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n    AND r.result_state IN ('SUCCESS', 'SUCCEEDED')\n    AND r.run_duration_seconds > 0\n  GROUP BY r.job_id, j.name, j.creator_id\n  HAVING COUNT(*) >= 5\n),\nrecent_runs AS (\n  SELECT \n    r.job_id,\n    ROUND(AVG(r.run_duration_seconds / 60.0), 1) AS recent_avg_min\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline r\n  WHERE r.run_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n    AND r.result_state IN ('SUCCESS', 'SUCCEEDED')\n  GROUP BY r.job_id\n)\nSELECT \n  ROW_NUMBER() OVER (ORDER BY ABS(rr.recent_avg_min - jd.avg_duration_min) DESC) AS priority,\n  jd.job_name,\n  jd.owner,\n  COALESCE(rr.recent_avg_min, jd.avg_duration_min) AS recent_duration_min,\n  jd.avg_duration_min AS baseline_duration_min,\n  ROUND(((COALESCE(rr.recent_avg_min, jd.avg_duration_min) - jd.avg_duration_min) / NULLIF(jd.avg_duration_min, 0)) * 100, 1) AS deviation_pct,\n  CASE \n    WHEN rr.recent_avg_min > jd.p95_duration_min THEN ' Critical: Exceeds P95'\n    WHEN rr.recent_avg_min > jd.avg_duration_min * 1.5 THEN ' High: >50% slower'\n    WHEN rr.recent_avg_min > jd.avg_duration_min * 1.2 THEN ' Medium: >20% slower'\n    WHEN rr.recent_avg_min < jd.avg_duration_min * 0.7 THEN ' Improved: >30% faster'\n    ELSE ' Normal range'\n  END AS status,\n  CASE \n    WHEN rr.recent_avg_min > jd.p95_duration_min THEN 'Check for data growth, cluster sizing, or new dependencies'\n    WHEN rr.recent_avg_min > jd.avg_duration_min * 1.5 THEN 'Review recent code changes or data volume increases'\n    WHEN jd.std_dev_min > jd.avg_duration_min * 0.5 THEN 'High variability - investigate data skew or resource contention'\n    ELSE 'Duration within expected range'\n  END AS recommendation\nFROM job_durations jd\nLEFT JOIN recent_runs rr ON jd.job_id = rr.job_id\nWHERE ABS(COALESCE(rr.recent_avg_min, jd.avg_duration_min) - jd.avg_duration_min) > jd.avg_duration_min * 0.1\nORDER BY ABS(rr.recent_avg_min - jd.avg_duration_min) DESC\nLIMIT 15"
    },
    {
      "name": "ds_monitor_latest",
      "displayName": "Monitor: Latest",
      "query": "SELECT \n  ROUND(COALESCE(success_rate, 0), 1) AS success_rate_pct,\n  COALESCE(total_runs, 0) AS total_runs,\n  ROUND(COALESCE(p95_duration_minutes, 0), 1) AS p95_duration\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window.start DESC\nLIMIT 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_trend",
      "displayName": "Monitor: Trend",
      "query": "SELECT \n  window.start AS window_start,\n  ROUND(COALESCE(success_rate, 0), 1) AS success_rate,\n  ROUND(COALESCE(failure_rate, 0), 1) AS failure_rate,\n  ROUND(COALESCE(timeout_rate, 0), 1) AS timeout_rate\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_duration",
      "displayName": "Monitor: Duration",
      "query": "SELECT \n  window.start AS window_start,\n  ROUND(COALESCE(avg_duration_minutes, 0), 1) AS avg_duration,\n  ROUND(COALESCE(p50_duration_minutes, 0), 1) AS p50_duration,\n  ROUND(COALESCE(p95_duration_minutes, 0), 1) AS p95_duration,\n  ROUND(COALESCE(p99_duration_minutes, 0), 1) AS p99_duration\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_run_types",
      "displayName": "Monitor: Run Types",
      "query": "SELECT \n  window.start AS window_start,\n  COALESCE(scheduled_runs, 0) AS scheduled_runs,\n  COALESCE(manual_runs, 0) AS manual_runs,\n  COALESCE(retry_runs, 0) AS retry_runs\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_errors",
      "displayName": "Monitor: Errors",
      "query": "SELECT \n  window.start AS window_start,\n  COALESCE(timeout_count, 0) AS timeout_count,\n  COALESCE(cancelled_count, 0) AS cancelled_count,\n  COALESCE(internal_error_count, 0) AS internal_error_count\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "SELECT \n  window.start AS window_start,\n  ROUND(COALESCE(success_rate_drift, 0), 2) AS success_rate_drift,\n  ROUND(COALESCE(duration_drift_pct, 0), 2) AS duration_drift,\n  ROUND(COALESCE(run_count_drift_pct, 0), 2) AS volume_drift\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_drift_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND drift_type = 'CONSECUTIVE'\n  AND slice_key IS NULL\nORDER BY window.start",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_detailed",
      "displayName": "Monitor: Detailed",
      "query": "SELECT \n  window.start AS window_start,\n  COALESCE(total_runs, 0) AS total_runs,\n  ROUND(COALESCE(success_rate, 0), 1) AS success_rate,\n  ROUND(COALESCE(failure_rate, 0), 1) AS failure_rate,\n  ROUND(COALESCE(p95_duration_minutes, 0), 1) AS p95_duration,\n  COALESCE(retry_runs, 0) AS retry_runs,\n  COALESCE(distinct_jobs, 0) AS distinct_jobs\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE window.start >= :time_range.min\n  AND column_name = ':table'\n  AND log_type = 'INPUT'\n  AND slice_key IS NULL\nORDER BY window_start DESC",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_no_autoscale_count",
      "query": "SELECT COUNT(DISTINCT j.job_id) AS count FROM ${catalog}.${gold_schema}.dim_job j WHERE j.delete_time IS NULL",
      "displayName": "No Autoscale Count"
    },
    {
      "name": "ds_stale_count",
      "query": "SELECT COUNT(DISTINCT entity_metadata_job_id) AS count FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE 1=1  AND  event_date BETWEEN :time_range.min AND :time_range.max AND target_table_full_name IS NOT NULL AND entity_type = 'JOB'",
      "displayName": "Stale Count",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_ap_count",
      "query": "SELECT COUNT(DISTINCT j.job_id) AS count FROM ${catalog}.${gold_schema}.dim_job j WHERE j.delete_time IS NULL",
      "displayName": "Ap Count"
    },
    {
      "name": "ds_no_autoscale",
      "query": "SELECT j.name AS job_name, w.workspace_name, ROUND(COALESCE(u.total_cost, 0), 2) AS cost_30d FROM ${catalog}.${gold_schema}.dim_job j LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON j.workspace_id = w.workspace_id LEFT JOIN (SELECT usage_metadata_job_id AS job_id, SUM(list_cost) AS total_cost FROM ${catalog}.${gold_schema}.fact_usage  WHERE usage_date BETWEEN :time_range.min AND :time_range.max AND usage_metadata_job_id IS NOT NULL GROUP BY usage_metadata_job_id) u ON j.job_id = u.job_id AND j.delete_time IS NULL ORDER BY cost_30d DESC LIMIT 20",
      "displayName": "No Autoscale",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_stale_datasets",
      "query": "SELECT COALESCE(j.name, CONCAT('Job ', l.entity_metadata_job_id)) AS job_name, COUNT(DISTINCT l.target_table_full_name) AS unused_tables, COUNT(DISTINCT l.event_date) AS runs_30d FROM ${catalog}.${gold_schema}.fact_table_lineage l LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON l.entity_metadata_job_id = j.job_id AND l.workspace_id = j.workspace_id WHERE 1=1 AND l.event_date BETWEEN :time_range.min AND :time_range.max AND l.target_table_full_name IS NOT NULL AND l.entity_type = 'JOB' GROUP BY COALESCE(j.name, CONCAT('Job ', l.entity_metadata_job_id)) ORDER BY runs_30d DESC LIMIT 20",
      "displayName": "Stale Datasets",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_ap_jobs",
      "query": "SELECT COALESCE(j.name, f.job_id) AS job_name, w.workspace_name, 'Interactive Cluster' AS cluster_name, COUNT(*) AS task_runs FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id WHERE f.run_date BETWEEN :time_range.min AND :time_range.max GROUP BY COALESCE(j.name, f.job_id), w.workspace_name ORDER BY task_runs DESC LIMIT 20",
      "displayName": "Ap Jobs",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_outliers",
      "query": "WITH job_stats AS (SELECT COALESCE(j.name, f.job_id) AS job_name, f.job_id, COUNT(*) AS runs, AVG(TIMESTAMPDIFF(SECOND, f.run_date, f.period_end_time)) AS avg_duration, PERCENTILE(TIMESTAMPDIFF(SECOND, f.run_date, f.period_end_time), 0.9) AS p90_duration, MAX(TIMESTAMPDIFF(SECOND, f.run_date, f.period_end_time)) AS max_duration FROM ${catalog}.${gold_schema}.fact_job_run_timeline f LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id WHERE f.run_date BETWEEN :time_range.min AND :time_range.max AND f.result_state IS NOT NULL GROUP BY COALESCE(j.name, f.job_id), f.job_id HAVING COUNT(*) > 5) SELECT job_name, runs, ROUND(avg_duration / 60, 1) AS avg_cost, ROUND(p90_duration / 60, 1) AS p90_cost, ROUND(max_duration / 60, 1) AS max_cost, ROUND((max_duration - p90_duration) / 60, 1) AS deviation FROM job_stats ORDER BY deviation DESC LIMIT 20",
      "displayName": "Outliers",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "param_job_status",
          "keyword": "param_job_status",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year' UNION ALL SELECT 'All Time'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "query": "SELECT 'All' AS workspace_name UNION ALL SELECT DISTINCT workspace_name FROM ${catalog}.${gold_schema}.dim_workspace WHERE workspace_name IS NOT NULL ORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT explode(array(\n  'Day',\n  'Week',\n  'Month',\n  'Quarter',\n  'Year'\n)) AS time_key"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "ds_select_workspace",
      "query": "SELECT DISTINCT COALESCE(workspace_name, CAST(workspace_id AS STRING)) AS workspace_name FROM ${catalog}.${gold_schema}.dim_workspace ORDER BY 1",
      "parameters": []
    },
    {
      "name": "ds_select_job_status",
      "displayName": "ds_select_job_status",
      "query": "SELECT 'All' AS status UNION ALL SELECT 'SUCCESS' UNION ALL SELECT 'FAILED' UNION ALL SELECT 'CANCELED'",
      "parameters": []
    },
    {
      "name": "ds_monitor_reliability_aggregate",
      "displayName": "Reliability Aggregate Metrics",
      "query": "-- Reliability aggregate metrics from fact_job_run_timeline\nSELECT\n  DATE(period_start_time) AS window_start,\n  COUNT(*) AS total_runs,\n  SUM(CASE WHEN result_state = 'SUCCESS' THEN 1 ELSE 0 END) AS success_count,\n  SUM(CASE WHEN result_state IN ('FAILED', 'ERROR') THEN 1 ELSE 0 END) AS failure_count,\n  SUM(CASE WHEN result_state = 'TIMEDOUT' OR termination_code = 'TIMED_OUT' THEN 1 ELSE 0 END) AS timeout_count,\n  COUNT(DISTINCT job_id) AS distinct_jobs\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline\nWHERE period_start_time >= :monitor_time_start\n  AND period_start_time <= COALESCE(:monitor_time_end, CURRENT_TIMESTAMP())\nGROUP BY DATE(period_start_time)\nORDER BY window_start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_reliability_derived",
      "displayName": "Reliability Derived KPIs",
      "query": "SELECT \n  window.start AS window_start,\n  window.end AS window_end,\n  ROUND(COALESCE(success_rate, 0), 2) AS success_rate,\n  ROUND(COALESCE(failure_rate, 0), 2) AS failure_rate,\n  ROUND(COALESCE(timeout_rate, 0), 2) AS timeout_rate\nFROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\nWHERE column_name = ':table'\n  AND log_type = 'INPUT'\n  AND window.start >= :monitor_time_start\n  AND window.end <= :monitor_time_end\n  AND COALESCE(slice_key, 'No Slice') = :monitor_slice_key\n  AND COALESCE(slice_value, 'No Slice') = :monitor_slice_value\nORDER BY window.start DESC",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_reliability_drift",
      "displayName": "Reliability Drift Metrics",
      "query": "-- Calculate week-over-week drift from fact_job_run_timeline\nWITH weekly_stats AS (\n  SELECT\n    DATE_TRUNC('week', period_start_time) AS week_start,\n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN result_state = 'SUCCESS' THEN 1 ELSE 0 END) AS successes,\n    ROUND(AVG(total_duration_ms / 60000.0), 2) AS avg_duration_min\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE period_start_time >= :monitor_time_start\n    AND period_start_time <= COALESCE(:monitor_time_end, CURRENT_TIMESTAMP())\n  GROUP BY DATE_TRUNC('week', period_start_time)\n),\ndrift_calc AS (\n  SELECT\n    week_start AS window_start,\n    total_runs,\n    successes,\n    avg_duration_min,\n    LAG(total_runs) OVER (ORDER BY week_start) AS prev_runs,\n    LAG(successes) OVER (ORDER BY week_start) AS prev_successes,\n    LAG(avg_duration_min) OVER (ORDER BY week_start) AS prev_duration\n  FROM weekly_stats\n)\nSELECT\n  window_start,\n  ROUND(CASE WHEN prev_successes > 0 THEN ((successes * 100.0 / total_runs) - (prev_successes * 100.0 / prev_runs)) ELSE 0 END, 2) AS success_rate_drift,\n  ROUND(CASE WHEN prev_duration > 0 THEN ((avg_duration_min - prev_duration) / prev_duration * 100) ELSE 0 END, 2) AS duration_drift,\n  ROUND(CASE WHEN prev_runs > 0 THEN ((total_runs - prev_runs) / prev_runs * 100.0) ELSE 0 END, 2) AS volume_drift\nFROM drift_calc\nWHERE prev_runs IS NOT NULL\nORDER BY window_start",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_value",
          "keyword": "monitor_slice_value",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_reliability_slice_keys",
      "displayName": "Reliability Slice Keys",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_key\n  FROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_key IS NOT NULL\n)\nSELECT 'No Slice' AS slice_key\nUNION ALL\nSELECT slice_key FROM profile_metrics\nORDER BY slice_key",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_monitor_reliability_slice_values",
      "displayName": "Reliability Slice Values",
      "query": "WITH profile_metrics AS (\n  SELECT DISTINCT slice_value, COALESCE(slice_key, 'No Slice') AS sk\n  FROM ${catalog}.${gold_schema}_monitoring.fact_job_run_timeline_profile_metrics\n  WHERE window.start >= :monitor_time_start \n    AND window.end <= :monitor_time_end\n    AND slice_value IS NOT NULL\n)\nSELECT 'No Slice' AS slice_value\nUNION ALL\nSELECT slice_value FROM profile_metrics WHERE sk = :monitor_slice_key\nORDER BY slice_value",
      "parameters": [
        {
          "displayName": "monitor_time_start",
          "keyword": "monitor_time_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_time_end",
          "keyword": "monitor_time_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        },
        {
          "displayName": "monitor_slice_key",
          "keyword": "monitor_slice_key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "No Slice"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false
    }
  },
  "warehouse_id": "${warehouse_id}"
}