{
  "displayName": "Query Performance Dashboard",
  "warehouse_id": "${warehouse_id}",
  "pages": [
    {
      "name": "page_performance_overview",
      "displayName": "\u26a1 Performance Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_avg_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Duration (sec)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_slow_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_slow",
                  "fields": [
                    {
                      "name": "slow_queries_pct",
                      "expression": "`slow_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_queries_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Slow Queries %",
                "description": ">30 seconds"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_failed",
                  "fields": [
                    {
                      "name": "failed_queries_pct",
                      "expression": "`failed_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "failed_queries_pct"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failed Queries %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_query_volume",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_query_volume",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "query_count",
                      "displayName": "Queries"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Volume Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg Duration (s)"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95 Duration (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f1\ufe0f Query Duration Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_slow_queries",
      "displayName": "\ud83d\udc0c Slow Queries Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_slowest_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slowest_queries",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_id",
                      "expression": "`query_id`"
                    },
                    {
                      "name": "user_name",
                      "expression": "`user_name`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "duration_sec",
                      "expression": "`duration_sec`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_id",
                    "title": "Query ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "user_name",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "duration_sec",
                    "title": "Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "status",
                    "title": "Status",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc0c Top 20 Slowest Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_slow_by_user",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_by_user",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "user_name",
                      "expression": "`user_name`"
                    },
                    {
                      "name": "slow_queries",
                      "expression": "`slow_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_name",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "slow_queries",
                    "title": "Slow Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc64 Slow Queries by User"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_slow_by_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_by_warehouse",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "slow_queries",
                      "expression": "`slow_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "slow_queries",
                    "title": "Slow Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfed Slow Queries by Warehouse"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_slow_query_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_slow_query_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "slow_queries",
                      "expression": "`slow_queries`"
                    },
                    {
                      "name": "slow_pct",
                      "expression": "`slow_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "slow_queries",
                      "displayName": "Slow Queries"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Slow Query Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_failed_queries",
      "displayName": "\u274c Failed Queries",
      "layout": [
        {
          "widget": {
            "name": "table_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_queries",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_id",
                      "expression": "`query_id`"
                    },
                    {
                      "name": "user_name",
                      "expression": "`user_name`"
                    },
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "error_message",
                      "expression": "`error_message`"
                    },
                    {
                      "name": "execution_time",
                      "expression": "`execution_time`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_id",
                    "title": "Query ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "user_name",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "error_message",
                    "title": "Error",
                    "type": "string"
                  },
                  {
                    "fieldName": "execution_time",
                    "title": "Time",
                    "type": "datetime"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\u274c Recent Failed Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failed_by_error",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_by_error",
                  "fields": [
                    {
                      "name": "error_category",
                      "expression": "`error_category`"
                    },
                    {
                      "name": "failure_count",
                      "expression": "`failure_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "error_category",
                  "displayName": "Error Category",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "failure_count",
                  "displayName": "Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Failures by Error Category"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_failed_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_failed_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "failed_count",
                      "expression": "`failed_count`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "failure_rate",
                      "displayName": "Failure Rate %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Failure Rate Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_warehouse_analysis",
      "displayName": "\ud83c\udfed Warehouse Analysis",
      "layout": [
        {
          "widget": {
            "name": "table_warehouse_perf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_perf",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Total Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg Duration (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95 (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_rate",
                    "title": "Fail Rate %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfed Warehouse Performance Summary (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_queries_by_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_queries_by_warehouse",
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "color": {
                  "fieldName": "warehouse_name",
                  "displayName": "Warehouse"
                },
                "theta": {
                  "fieldName": "query_count",
                  "displayName": "Queries"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Query Distribution by Warehouse"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_warehouse_hourly",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_warehouse_hourly",
                  "fields": [
                    {
                      "name": "hour",
                      "expression": "`hour`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "hour",
                  "displayName": "Hour of Day",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "query_count",
                      "displayName": "Queries"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u23f0 Query Volume by Hour"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_ml_predictions",
      "displayName": "\ud83e\udd16 ML Predictions",
      "layout": [
        {
          "widget": {
            "name": "table_ml_optimization",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_optimization",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_pattern",
                      "expression": "`query_pattern`"
                    },
                    {
                      "name": "current_duration",
                      "expression": "`current_duration`"
                    },
                    {
                      "name": "predicted_duration",
                      "expression": "`predicted_duration`"
                    },
                    {
                      "name": "optimization_tip",
                      "expression": "`optimization_tip`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_pattern",
                    "title": "Query Pattern",
                    "type": "string"
                  },
                  {
                    "fieldName": "current_duration",
                    "title": "Current (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "predicted_duration",
                    "title": "Predicted (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "optimization_tip",
                    "title": "Optimization",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Query Optimization Recommendations",
                "description": "From query optimizer model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_regression",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_regression",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "query_id",
                      "expression": "`query_id`"
                    },
                    {
                      "name": "baseline_duration",
                      "expression": "`baseline_duration`"
                    },
                    {
                      "name": "current_duration",
                      "expression": "`current_duration`"
                    },
                    {
                      "name": "regression_pct",
                      "expression": "`regression_pct`"
                    },
                    {
                      "name": "root_cause",
                      "expression": "`root_cause`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "query_id",
                    "title": "Query ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "baseline_duration",
                    "title": "Baseline (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "current_duration",
                    "title": "Current (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "regression_pct",
                    "title": "Regression %",
                    "type": "number"
                  },
                  {
                    "fieldName": "root_cause",
                    "title": "Root Cause",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Query Regression Detection",
                "description": "Anomaly detection model"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_warehouse",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_warehouse",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "warehouse_name",
                      "expression": "`warehouse_name`"
                    },
                    {
                      "name": "recommendation",
                      "expression": "`recommendation`"
                    },
                    {
                      "name": "reason",
                      "expression": "`reason`"
                    },
                    {
                      "name": "confidence",
                      "expression": "`confidence`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "warehouse_name",
                    "title": "Warehouse",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommendation",
                    "title": "Recommendation",
                    "type": "string"
                  },
                  {
                    "fieldName": "reason",
                    "title": "Reason",
                    "type": "string"
                  },
                  {
                    "fieldName": "confidence",
                    "title": "Confidence",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Warehouse Sizing Recommendations",
                "description": "From capacity planner model"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "page_monitoring",
      "displayName": "\ud83d\udcca Lakehouse Monitoring",
      "layout": [
        {
          "widget": {
            "name": "kpi_monitor_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Total Queries"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_avg",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Avg Duration (s)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_monitor_slow",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_latest",
                  "fields": [
                    {
                      "name": "slow_query_rate",
                      "expression": "`slow_query_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_query_rate"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Slow Query Rate %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_monitor_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_trend",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg_duration",
                      "displayName": "Avg Duration (s)"
                    },
                    {
                      "fieldName": "p95_duration",
                      "displayName": "P95 Duration (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Query Duration Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_volume_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_volume",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "total_queries",
                      "displayName": "Queries"
                    },
                    {
                      "fieldName": "unique_users",
                      "displayName": "Users"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Query Volume Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_monitor_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_drift",
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "duration_drift",
                      "expression": "`duration_drift`"
                    },
                    {
                      "name": "volume_drift",
                      "expression": "`volume_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "window_start",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "duration_drift",
                      "displayName": "Duration Drift %"
                    },
                    {
                      "fieldName": "volume_drift",
                      "displayName": "Volume Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Performance Drift Detection"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 14,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_monitor_detailed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_detailed",
                  "disaggregated": true,
                  "fields": [
                    {
                      "name": "window_start",
                      "expression": "`window_start`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    },
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    },
                    {
                      "name": "slow_query_rate",
                      "expression": "`slow_query_rate`"
                    },
                    {
                      "name": "failure_rate",
                      "expression": "`failure_rate`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "window_start",
                    "title": "Period",
                    "type": "datetime"
                  },
                  {
                    "fieldName": "total_queries",
                    "title": "Queries",
                    "type": "number"
                  },
                  {
                    "fieldName": "avg_duration",
                    "title": "Avg (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "p95_duration",
                    "title": "P95 (s)",
                    "type": "number"
                  },
                  {
                    "fieldName": "slow_query_rate",
                    "title": "Slow %",
                    "type": "number"
                  },
                  {
                    "fieldName": "failure_rate",
                    "title": "Fail %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Monitor: Complete Metrics Table"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        }
      ]
    }
  ],
  "datasets": [
    {
      "name": "ds_kpi_queries",
      "displayName": "KPI: Queries",
      "query": "SELECT FORMAT_NUMBER(COUNT(*), 0) AS total_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration, FORMAT_NUMBER(COUNT(DISTINCT executed_by_user_id), 0) AS unique_users FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "ds_kpi_slow",
      "displayName": "KPI: Slow",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS slow_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "ds_kpi_failed",
      "displayName": "KPI: Failed",
      "query": "SELECT CONCAT(ROUND(SUM(CASE WHEN status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), '%') AS failed_queries_pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "ds_query_volume",
      "displayName": "Query Volume",
      "query": "SELECT DATE(start_time) AS day, COUNT(*) AS query_count, COUNT(DISTINCT executed_by_user_id) AS unique_users FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_duration_trend",
      "displayName": "Duration Trend",
      "query": "SELECT DATE(start_time) AS day, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_slowest_queries",
      "displayName": "Slowest Queries",
      "query": "SELECT query_id, executed_by_user_id AS user_name, warehouse_name, ROUND(total_duration_ms / 1000.0, 1) AS duration_sec, status FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS ORDER BY total_duration_ms DESC LIMIT 20"
    },
    {
      "name": "ds_slow_by_user",
      "displayName": "Slow by User",
      "query": "SELECT executed_by_user_id AS user_name, SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, COUNT(*) AS total_queries FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1 HAVING SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) > 0 ORDER BY slow_queries DESC LIMIT 15"
    },
    {
      "name": "ds_slow_by_warehouse",
      "displayName": "Slow by Warehouse",
      "query": "SELECT warehouse_name, SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, COUNT(*) AS total_queries FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1 HAVING SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) > 0 ORDER BY slow_queries DESC LIMIT 15"
    },
    {
      "name": "ds_slow_query_trend",
      "displayName": "Slow Query Trend",
      "query": "SELECT DATE(start_time) AS day, SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) AS slow_queries, ROUND(SUM(CASE WHEN total_duration_ms > 30000 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS slow_pct FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_failed_queries",
      "displayName": "Failed Queries",
      "query": "SELECT query_id, executed_by_user_id AS user_name, warehouse_name, error_message, start_time AS execution_time FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS AND status = 'FAILED' ORDER BY start_time DESC LIMIT 30"
    },
    {
      "name": "ds_failed_by_error",
      "displayName": "Failed by Error",
      "query": "SELECT COALESCE(SUBSTRING(error_message, 1, 50), 'Unknown') AS error_category, COUNT(*) AS failure_count FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS AND status = 'FAILED' GROUP BY 1 ORDER BY 2 DESC LIMIT 10"
    },
    {
      "name": "ds_failed_trend",
      "displayName": "Failed Trend",
      "query": "SELECT DATE(start_time) AS day, SUM(CASE WHEN status = 'FAILED' THEN 1 ELSE 0 END) AS failed_count, ROUND(SUM(CASE WHEN status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_warehouse_perf",
      "displayName": "Warehouse Performance",
      "query": "SELECT warehouse_name, COUNT(*) AS total_queries, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration, ROUND(PERCENTILE_APPROX(total_duration_ms / 1000.0, 0.95), 1) AS p95_duration, ROUND(SUM(CASE WHEN status = 'FAILED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS failure_rate FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1 ORDER BY total_queries DESC"
    },
    {
      "name": "ds_queries_by_warehouse",
      "displayName": "Queries by Warehouse",
      "query": "SELECT warehouse_name, COUNT(*) AS query_count FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1 ORDER BY 2 DESC LIMIT 10"
    },
    {
      "name": "ds_warehouse_hourly",
      "displayName": "Warehouse Hourly",
      "query": "SELECT HOUR(start_time) AS hour, COUNT(*) AS query_count, ROUND(AVG(total_duration_ms / 1000.0), 1) AS avg_duration FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_ml_optimization",
      "displayName": "ML: Optimization",
      "query": "SELECT 'pattern-001' AS query_pattern, 0.0 AS current_duration, 0.0 AS predicted_duration, 'N/A' AS optimization_tip WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS query_pattern, 0.0 AS current_duration, 0.0 AS predicted_duration, 'Pending' AS optimization_tip LIMIT 1"
    },
    {
      "name": "ds_ml_regression",
      "displayName": "ML: Regression",
      "query": "SELECT 'query-001' AS query_id, 0.0 AS baseline_duration, 0.0 AS current_duration, 0.0 AS regression_pct, 'N/A' AS root_cause WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS query_id, 0.0 AS baseline_duration, 0.0 AS current_duration, 0.0 AS regression_pct, 'Pending' AS root_cause LIMIT 1"
    },
    {
      "name": "ds_ml_warehouse",
      "displayName": "ML: Warehouse",
      "query": "SELECT 'warehouse-001' AS warehouse_name, 'N/A' AS recommendation, 'N/A' AS reason, 0.0 AS confidence WHERE 1=0 UNION ALL SELECT 'Run ML inference pipeline' AS warehouse_name, 'Pending' AS recommendation, 'N/A' AS reason, 0.0 AS confidence LIMIT 1"
    },
    {
      "name": "ds_monitor_latest",
      "displayName": "Monitor: Latest",
      "query": "SELECT FORMAT_NUMBER(COALESCE(total_queries, 0), 0) AS total_queries, ROUND(COALESCE(avg_query_duration_seconds, 0), 1) AS avg_duration, CONCAT(ROUND(COALESCE(slow_query_rate, 0) * 100, 1), '%') AS slow_query_rate FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' ORDER BY window.start DESC LIMIT 1"
    },
    {
      "name": "ds_monitor_trend",
      "displayName": "Monitor: Trend",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(avg_query_duration_seconds, 0), 1) AS avg_duration, ROUND(COALESCE(p95_query_duration_seconds, 0), 1) AS p95_duration FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window.start"
    },
    {
      "name": "ds_monitor_volume",
      "displayName": "Monitor: Volume",
      "query": "SELECT window.start AS window_start, COALESCE(total_queries, 0) AS total_queries, COALESCE(unique_users, 0) AS unique_users FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window.start"
    },
    {
      "name": "ds_monitor_drift",
      "displayName": "Monitor: Drift",
      "query": "SELECT window.start AS window_start, ROUND(COALESCE(query_duration_drift_pct, 0), 1) AS duration_drift, ROUND(COALESCE(query_volume_drift_pct, 0), 1) AS volume_drift FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_drift_metrics WHERE column_name = ':table' AND drift_type = 'CONSECUTIVE' AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window.start"
    },
    {
      "name": "ds_monitor_detailed",
      "displayName": "Monitor: Detailed",
      "query": "SELECT window.start AS window_start, COALESCE(total_queries, 0) AS total_queries, ROUND(COALESCE(avg_query_duration_seconds, 0), 1) AS avg_duration, ROUND(COALESCE(p95_query_duration_seconds, 0), 1) AS p95_duration, ROUND(COALESCE(slow_query_rate, 0) * 100, 1) AS slow_query_rate, ROUND(COALESCE(failure_rate, 0) * 100, 1) AS failure_rate FROM ${catalog}.${gold_schema}_monitoring.fact_query_history_profile_metrics WHERE log_type = 'INPUT' AND column_name = ':table' AND window.start >= CURRENT_DATE() - INTERVAL 30 DAYS ORDER BY window.start DESC"
    }
  ]
}