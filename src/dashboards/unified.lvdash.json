{
  "datasets": [
    {
      "name": "ds_kpi_query",
      "displayName": "KPI: Query",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(AVG(execution_duration_ms)/1000, 1) AS avg_duration \nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max"
    },
    {
      "name": "ds_ml_capacity",
      "displayName": "ML: Capacity",
      "query": "WITH capacity_preds AS (\n  SELECT\n    p.warehouse_id,\n    -- ML prediction is already a percentage (0-100+), NOT 0-1\n    LEAST(COALESCE(p.prediction, 0), 150) AS utilization_pct,\n    p.is_weekend,\n    p.scored_at,\n    COALESCE(w.warehouse_name, 'Unknown Warehouse') AS warehouse_name,\n    COALESCE(w.warehouse_type, 'SERVERLESS') AS resource_type,\n    COALESCE(w.warehouse_size, 'Unknown') AS current_size,\n    COALESCE(w.min_clusters, 1) AS min_clusters,\n    COALESCE(w.max_clusters, 1) AS max_clusters\n  FROM ${catalog}.${feature_schema}.cluster_capacity_predictions p\n  LEFT JOIN ${catalog}.${gold_schema}.dim_warehouse w ON p.warehouse_id = w.warehouse_id\n  WHERE p.scored_at >= CURRENT_DATE() - INTERVAL 7 DAYS\n),\nsize_order AS (\n  SELECT 'X_SMALL' AS sz, 1 AS ord UNION ALL\n  SELECT '2X_SMALL', 2 UNION ALL\n  SELECT 'SMALL', 3 UNION ALL\n  SELECT 'MEDIUM', 4 UNION ALL\n  SELECT 'LARGE', 5 UNION ALL\n  SELECT 'X_LARGE', 6 UNION ALL\n  SELECT '2X_LARGE', 7 UNION ALL\n  SELECT '3X_LARGE', 8 UNION ALL\n  SELECT '4X_LARGE', 9\n),\nwith_recommendations AS (\n  SELECT c.*,\n    so.ord AS current_ord,\n    CASE\n      WHEN c.utilization_pct > 90 THEN so.ord + 2\n      WHEN c.utilization_pct > 75 THEN so.ord + 1\n      ELSE so.ord\n    END AS recommended_ord\n  FROM capacity_preds c\n  LEFT JOIN size_order so ON UPPER(c.current_size) = so.sz\n)\nSELECT\n  CONCAT(r.resource_type, ': ', r.warehouse_name) AS resource_name,\n  CONCAT('Type: ', r.resource_type, ' | Size: ', r.current_size, ' | Clusters: ', r.min_clusters, '-', r.max_clusters) AS resource_type,\n  ROUND(r.utilization_pct, 1) AS utilization_pct,\n  CASE\n    WHEN r.utilization_pct > 90 THEN CONCAT('Scale to ', COALESCE(rec.sz, 'larger size'), ' + add ', LEAST(r.max_clusters + 2, 10) - r.max_clusters, ' clusters')\n    WHEN r.utilization_pct > 75 THEN CONCAT('Scale to ', COALESCE(rec.sz, 'next size'), ' or add 1 cluster')\n    WHEN r.utilization_pct > 60 THEN 'Monitor closely - approaching capacity'\n    ELSE 'Capacity adequate'\n  END AS recommended_action,\n  CONCAT(\n    'Current: ', r.current_size, ' (', r.min_clusters, '-', r.max_clusters, ' clusters) @ ', ROUND(r.utilization_pct, 0), '% util. ',\n    CASE\n      WHEN r.utilization_pct > 90 THEN 'CRITICAL: Significant scaling needed.'\n      WHEN r.utilization_pct > 75 THEN 'WARNING: Approaching limits.'\n      WHEN r.utilization_pct > 60 THEN 'Monitor during peak hours.'\n      ELSE 'Operating normally.'\n    END\n  ) AS rationale\nFROM with_recommendations r\nLEFT JOIN size_order rec ON r.recommended_ord = rec.ord\nWHERE r.utilization_pct > 50\nORDER BY r.utilization_pct DESC\nLIMIT 15"
    },
    {
      "name": "ds_kpi_events",
      "displayName": "KPI: Events",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(*) AS total_events FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_wow_growth",
      "displayName": "WoW Growth",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "WITH weekly AS (SELECT DATE_TRUNC('week', usage_date) AS week_start, SUM(list_cost) AS weekly_cost, COUNT(DISTINCT DATE(usage_date)) AS days FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold.fact_usage f LEFT JOIN prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold.dim_workspace w ON f.workspace_id = w.workspace_id WHERE \n\n usage_date BETWEEN :time_range.min AND :time_range.max\nAND (\n  'all' IN (SELECT EXPLODE(:param_workspace))\n  OR COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) IN (SELECT EXPLODE(:param_workspace))\n) GROUP BY 1 HAVING days = 7), with_growth AS (SELECT week_start, weekly_cost, 100 * (weekly_cost - LAG(weekly_cost) OVER (ORDER BY week_start)) / NULLIF(LAG(weekly_cost) OVER (ORDER BY week_start), 0) AS wow_growth_pct FROM weekly) SELECT week_start, ROUND(weekly_cost, 2) AS weekly_cost, ROUND(wow_growth_pct, 1) AS wow_growth_pct, ROUND(AVG(wow_growth_pct) OVER (ORDER BY week_start ROWS BETWEEN 12 PRECEDING AND CURRENT ROW), 1) AS moving_avg FROM with_growth ORDER BY week_start"
    },
    {
      "name": "ds_kpi_duration",
      "displayName": "KPI: Duration",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(PERCENTILE(run_duration_seconds, 0.95)/60, 1) AS p95_duration \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max"
    },
    {
      "name": "ds_kpi_slow",
      "displayName": "KPI: Slow",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(\n    SUM(CASE WHEN execution_duration_ms > 60000 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0), \n    3) AS slow_queries_pct \nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max"
    },
    {
      "name": "ds_kpi_queries",
      "displayName": "KPI: Queries",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n    COUNT(*) AS total_queries,\n    ROUND(AVG(execution_duration_ms)/1000, 1) AS avg_duration,\n    ROUND(PERCENTILE(execution_duration_ms, 0.95)/1000, 1) AS p95_duration,\n    COUNT(DISTINCT executed_as_user_id) AS unique_users\nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max"
    },
    {
      "name": "ds_top_workspaces",
      "displayName": "Top Workspaces",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ],
      "query": "SELECT \n  COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name, \n  ROUND(SUM(f.list_cost), 2) AS total_cost,\n  SUM(f.usage_quantity) AS total_dbus,\n  COUNT(DISTINCT f.identity_metadata_run_as) AS unique_users,\n  ROUND(SUM(f.list_cost) / NULLIF(COUNT(DISTINCT f.identity_metadata_run_as), 0), 2) AS cost_per_user,\n  COUNT(DISTINCT f.usage_metadata_job_id) AS job_count,\n  COUNT(DISTINCT f.usage_metadata_job_run_id) AS job_runs,\n  ROUND(SUM(CASE WHEN f.sku_name LIKE '%SERVERLESS%' THEN f.list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(f.list_cost), 0), 1) AS serverless_pct\nFROM ${catalog}.${gold_schema}.fact_usage f \nLEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id \nWHERE f.usage_date BETWEEN :time_range.min AND :time_range.max\n  AND ('all' IN (SELECT EXPLODE(:param_workspace)) OR COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) IN (SELECT EXPLODE(:param_workspace)))\nGROUP BY 1 \nORDER BY total_cost DESC \nLIMIT 15"
    },
    {
      "name": "ds_kpi_jobs",
      "displayName": "KPI: Jobs",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT job_id) AS total_jobs \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max"
    },
    {
      "name": "ds_unique_counts",
      "displayName": "Unique Counts",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT user_identity_email) AS active_users\nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_date >= :time_range.min AND event_date <= :time_range.max\n  AND user_identity_email IS NOT NULL\n  AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n  AND user_identity_email NOT LIKE 'service-principal-%'\n  AND user_identity_email NOT LIKE '%[ServicePrincipal]%'\n  AND user_identity_email NOT LIKE '%@databricks.com'\n  AND LOWER(user_identity_email) NOT IN ('system-user', 'system', 'admin', 'root', 'databricks', 'unity-catalog-service')"
    },
    {
      "name": "ds_monitor_query_drift",
      "displayName": "Monitor: Query Drift",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n  DATE(window.start) AS window_start, \n  ROUND(COALESCE(p95_duration_drift_pct, 0) / 100.0, 4) AS drift_pct \nFROM ${catalog}.${gold_schema}_monitoring.fact_query_history_drift_metrics \nWHERE column_name = ':table' \n  AND drift_type = 'CONSECUTIVE'\n  AND slice_key IS NULL\n  AND window.end >= :time_range.min AND window.end <= :time_range.max\nORDER BY window.start DESC\nLIMIT 1"
    },
    {
      "name": "ds_risk_trend",
      "displayName": "Risk Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(event_date) AS day, \n  SUM(CASE WHEN action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropUser', 'deleteCluster', 'createAccessToken') THEN 1 ELSE 0 END) AS high_risk,\n  SUM(CASE WHEN action_name IN ('addUserToGroup', 'removeUserFromGroup', 'updatePermissions', 'createNotebook') THEN 1 ELSE 0 END) AS medium_risk,\n  COUNT(*) AS events \nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_date >= :time_range.min AND event_date <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_tables_by_catalog",
      "displayName": "Tables by Catalog",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT catalog_name, COUNT(DISTINCT table_full_name) AS table_count FROM (SELECT COALESCE(source_table_catalog, target_table_catalog) AS catalog_name, COALESCE(source_table_full_name, target_table_full_name) AS table_full_name FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE (source_table_catalog IS NOT NULL OR target_table_catalog IS NOT NULL) AND event_date BETWEEN :time_range.min AND :time_range.max) WHERE catalog_name IS NOT NULL GROUP BY 1 ORDER BY 2 DESC LIMIT 10"
    },
    {
      "name": "ds_kpi_cost",
      "displayName": "KPI: Cost",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT SUM(list_cost) AS cost_30d \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max"
    },
    {
      "name": "ds_duration_trend",
      "displayName": "Duration Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "WITH daily_stats AS (\n  SELECT DATE(start_time) AS day, \n    ROUND(AVG(execution_duration_ms)/60000, 2) AS avg_duration_min,\n    ROUND(PERCENTILE(execution_duration_ms, 0.95)/60000, 2) AS p95_duration_min\n  FROM ${catalog}.${gold_schema}.fact_query_history \n  WHERE start_time >= :time_range.min AND start_time <= :time_range.max \n  GROUP BY 1\n)\nSELECT day, 'Average' AS metric, avg_duration_min AS duration_min FROM daily_stats\nUNION ALL\nSELECT day, 'P95 (Slow Queries)' AS metric, p95_duration_min AS duration_min FROM daily_stats\nORDER BY day, metric"
    },
    {
      "name": "ds_ml_security_threats",
      "displayName": "ML: Security Threats",
      "query": "WITH security_events AS (\n  SELECT\n    user_identity_email,\n    SUM(CASE WHEN response_result = 'denied' OR LOWER(response_error_message) LIKE '%denied%' OR LOWER(response_error_message) LIKE '%unauthorized%' THEN 1 ELSE 0 END) AS access_denied_count,\n    SUM(CASE WHEN action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropTable', 'dropDatabase', 'deleteExperiment', 'deleteModel', 'deleteFile') THEN 1 ELSE 0 END) AS destructive_actions,\n    SUM(CASE WHEN action_name IN ('updatePermissions', 'grantPermission', 'revokePermission', 'addUserToGroup', 'removeUserFromGroup', 'changeSecuritySettings') THEN 1 ELSE 0 END) AS permission_changes,\n    COUNT(DISTINCT service_name) AS services_accessed,\n    MAX(CASE WHEN response_result = 'denied' THEN action_name END) AS last_denied_action,\n    MAX(CASE WHEN response_result = 'denied' THEN service_name END) AS last_denied_service,\n    MAX(CASE WHEN response_result = 'denied' THEN event_time END) AS last_denied_time\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n    AND user_identity_email IS NOT NULL\n    AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n    AND user_identity_email NOT LIKE 'service-principal-%'\n    AND user_identity_email NOT LIKE '%[ServicePrincipal]%'\n    AND LOWER(user_identity_email) NOT IN ('system', 'admin', 'root', 'databricks')\n  GROUP BY user_identity_email\n  HAVING SUM(CASE WHEN response_result = 'denied' OR LOWER(response_error_message) LIKE '%denied%' THEN 1 ELSE 0 END) > 5\n      OR SUM(CASE WHEN action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropTable', 'dropDatabase') THEN 1 ELSE 0 END) > 2\n      OR SUM(CASE WHEN action_name IN ('updatePermissions', 'grantPermission', 'revokePermission', 'addUserToGroup') THEN 1 ELSE 0 END) > 3\n)\nSELECT\n  s.user_identity_email AS user_identity,\n  CASE \n    WHEN s.access_denied_count > 50 THEN 'High Access Denial Rate'\n    WHEN s.destructive_actions > 5 THEN 'Excessive Data Deletion'\n    WHEN s.permission_changes > 5 THEN 'Permission Modification Activity'\n    ELSE 'Elevated Activity Pattern'\n  END AS threat_type,\n  LEAST(100, ROUND(s.access_denied_count * 0.5 + s.destructive_actions * 10 + s.permission_changes * 5, 0)) AS risk_score,\n  CONCAT(\n    s.access_denied_count, ' access denials, ',\n    s.destructive_actions, ' delete operations, ',\n    s.permission_changes, ' permission changes'\n  ) AS incident_summary,\n  COALESCE(s.last_denied_action, 'None recorded') AS last_suspicious_action,\n  COALESCE(s.last_denied_service, 'N/A') AS affected_service,\n  CASE \n    WHEN s.access_denied_count > 50 THEN 'Review access permissions - user may need correct access'\n    WHEN s.destructive_actions > 5 THEN 'Verify deleted resources were authorized'\n    WHEN s.permission_changes > 5 THEN 'Audit recent permission changes for appropriateness'\n    ELSE 'Monitor user activity pattern'\n  END AS recommended_action\nFROM security_events s\nORDER BY (s.access_denied_count * 0.5 + s.destructive_actions * 10 + s.permission_changes * 5) DESC\nLIMIT 20"
    },
    {
      "name": "ds_runs_by_status",
      "displayName": "Runs by Status",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n  DATE(run_date) AS run_date,\n  CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 'Success' ELSE 'Failed' END AS status, \n  COUNT(*) AS count \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max \nGROUP BY 1, 2 \nORDER BY 1"
    },
    {
      "name": "ds_kpi_tagged",
      "displayName": "KPI: Tagged",
      "query": "SELECT ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) / NULLIF(SUM(list_cost), 0), 3) AS tagged_pct \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_job_trend",
      "displayName": "Job Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(run_date) AS day, \n    COUNT(*) AS runs,\n    ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_health_score",
      "displayName": "Health Score",
      "query": "WITH reliability_health AS (\n  SELECT COALESCE(ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nperformance_health AS (\n  SELECT COALESCE(ROUND(SUM(CASE WHEN execution_status = 'FINISHED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\ncost_health AS (\n  SELECT COALESCE(ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nsecurity_health AS (\n  SELECT COALESCE(ROUND((1 - (SUM(CASE WHEN response_result = 'denied' OR action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropUser') THEN 1 ELSE 0 END) * 1.0 / NULLIF(COUNT(*), 0))) * 100, 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n),\nquality_health AS (\n  SELECT COALESCE(ROUND(COUNT(DISTINCT target_table_full_name) * 100.0 / NULLIF((SELECT COUNT(*) FROM ${catalog}.${gold_schema}.fact_table_lineage), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_table_lineage\n  WHERE event_time >= CURRENT_DATE() - INTERVAL 30 DAYS\n)\nSELECT ROUND((COALESCE(r.score, 100) + COALESCE(p.score, 100) + COALESCE(c.score, 100) + COALESCE(s.score, 100) + COALESCE(q.score, 100)) / 5.0, 1) AS health_score\nFROM reliability_health r, performance_health p, cost_health c, security_health s, quality_health q"
    },
    {
      "name": "ds_health_trend",
      "displayName": "Health Trend",
      "query": "WITH daily_reliability AS (\n  SELECT run_date AS day, \n    COALESCE(ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= :time_range.min AND run_date <= :time_range.max\n  GROUP BY run_date\n),\ndaily_performance AS (\n  SELECT DATE(start_time) AS day, \n    COALESCE(ROUND(SUM(CASE WHEN execution_status = 'FINISHED' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE DATE(start_time) >= :time_range.min AND DATE(start_time) <= :time_range.max\n  GROUP BY DATE(start_time)\n),\ndaily_cost AS (\n  SELECT usage_date AS day, \n    COALESCE(ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= :time_range.min AND usage_date <= :time_range.max\n  GROUP BY usage_date\n),\ndaily_security AS (\n  SELECT event_date AS day, \n    COALESCE(ROUND((1 - (SUM(CASE WHEN response_result = 'denied' OR action_name IN ('deleteTable', 'deleteSchema') THEN 1 ELSE 0 END) * 1.0 / NULLIF(COUNT(*), 0))) * 100, 1), 100) AS score\n  FROM ${catalog}.${gold_schema}.fact_audit_logs\n  WHERE event_date >= :time_range.min AND event_date <= :time_range.max\n  GROUP BY event_date\n)\nSELECT COALESCE(r.day, p.day, c.day, s.day) AS day,\n  ROUND((COALESCE(r.score, 100) + COALESCE(p.score, 100) + COALESCE(c.score, 100) + COALESCE(s.score, 100)) / 4.0, 1) AS health_score\nFROM daily_reliability r\nFULL OUTER JOIN daily_performance p ON r.day = p.day\nFULL OUTER JOIN daily_cost c ON COALESCE(r.day, p.day) = c.day\nFULL OUTER JOIN daily_security s ON COALESCE(r.day, p.day, c.day) = s.day\nORDER BY 1",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_reliability_health",
      "displayName": "Reliability Health",
      "query": "SELECT COALESCE(\n  ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') OR result_state IS NULL THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1),\n  100\n) AS status \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "ds_daily_cost",
      "displayName": "Daily Cost",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(usage_date) AS usage_date, SUM(list_cost) AS daily_cost, SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) AS serverless_cost, SUM(CASE WHEN NOT product_features_is_serverless THEN list_cost ELSE 0 END) AS classic_cost FROM prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold.fact_usage f LEFT JOIN prashanth_subrahmanyam_catalog.dev_prashanth_subrahmanyam_system_gold.dim_workspace w ON f.workspace_id = w.workspace_id WHERE \n\n usage_date BETWEEN :time_range.min AND :time_range.max\nAND (\n  'all' IN (SELECT EXPLODE(:param_workspace))\n  OR COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) IN (SELECT EXPLODE(:param_workspace))\n) GROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_serverless_adoption",
      "displayName": "Serverless Adoption",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(SUM(CASE WHEN product_features_is_serverless THEN list_cost ELSE 0 END) / NULLIF(SUM(list_cost), 0), 3) AS serverless_pct \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max"
    },
    {
      "name": "ds_cost_health",
      "displayName": "Cost Health",
      "query": "SELECT ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) * 100.0 / NULLIF(SUM(list_cost), 0), 1) AS status \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS"
    },
    {
      "name": "ds_ml_job_risks",
      "displayName": "ML: Job Risks",
      "query": "-- Uses ACTUAL job failure data (more reliable than ML predictions that return 1.0 for everything)\nWITH job_stats AS (\n  SELECT\n    f.job_id,\n    COALESCE(j.name, f.run_name, CAST(f.job_id AS STRING)) AS job_name,\n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN f.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS failed_runs,\n    ROUND(SUM(CASE WHEN f.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) AS failure_rate,\n    MAX(CASE WHEN f.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN f.termination_code END) AS last_error_type,\n    MAX(CASE WHEN f.result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN f.run_date END) AS last_failure_date,\n    ROUND(STDDEV(f.run_duration_seconds), 1) AS duration_variance_sec,\n    MAX(f.run_date) AS last_run_date\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id\n  WHERE f.run_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n  GROUP BY f.job_id, j.name, f.run_name\n  HAVING COUNT(*) >= 3  -- Only jobs with enough runs to calculate risk\n)\nSELECT\n  job_name,\n  ROUND(failure_rate / 100.0, 2) AS failure_probability,\n  CASE \n    WHEN failure_rate > 50 THEN 'HIGH'\n    WHEN failure_rate > 20 THEN 'MEDIUM'\n    WHEN failure_rate > 5 THEN 'LOW'\n    ELSE 'HEALTHY'\n  END AS risk_level,\n  CONCAT(\n    failed_runs, ' failures in ', total_runs, ' runs (', failure_rate, '%). ',\n    'Last error: ', COALESCE(last_error_type, 'N/A'), '. ',\n    'Duration variance: ', COALESCE(duration_variance_sec, 0), 's'\n  ) AS rationale,\n  COALESCE(last_error_type, 'No recent errors') AS last_error_preview,\n  last_failure_date,\n  CASE \n    WHEN failure_rate > 50 THEN 'CRITICAL: Add retry logic, check resources, review error patterns'\n    WHEN failure_rate > 20 THEN 'WARNING: Monitor closely, review recent config changes'\n    WHEN failure_rate > 5 THEN 'Watch: Occasional failures, review logs'\n    ELSE 'Healthy: Continue normal monitoring'\n  END AS recommended_action\nFROM job_stats\nWHERE failed_runs > 0  -- Only show jobs with actual failures\nORDER BY failure_rate DESC, failed_runs DESC\nLIMIT 15"
    },
    {
      "name": "ds_kpi_mttr",
      "displayName": "KPI: MTTR",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COALESCE(ROUND(AVG(run_duration_seconds)/60, 1), 0) AS mttr_min \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max \nAND result_state NOT IN ('SUCCESS', 'SUCCEEDED')"
    },
    {
      "name": "ds_kpi_lineage",
      "displayName": "KPI: Lineage",
      "query": "SELECT COUNT(DISTINCT target_table_full_name) AS lineage_tables FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE event_time >= :time_range.min AND event_time <= :time_range.max",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_drift_trend",
      "displayName": "Drift Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "-- Calculates week-over-week drift from actual Gold layer data\nWITH cost_weekly AS (\n  SELECT\n    DATE_TRUNC('week', usage_date) AS week_start,\n    SUM(list_cost) AS weekly_cost\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= :time_range.min AND usage_date <= :time_range.max\n  GROUP BY DATE_TRUNC('week', usage_date)\n),\njob_weekly AS (\n  SELECT\n    DATE_TRUNC('week', run_date) AS week_start,\n    COUNT(*) AS weekly_jobs\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= :time_range.min AND run_date <= :time_range.max\n  GROUP BY DATE_TRUNC('week', run_date)\n),\nquery_weekly AS (\n  SELECT\n    DATE_TRUNC('week', start_time) AS week_start,\n    PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) AS p95_duration\n  FROM ${catalog}.${gold_schema}.fact_query_history\n  WHERE start_time >= :time_range.min AND start_time <= :time_range.max\n  GROUP BY DATE_TRUNC('week', start_time)\n),\ncost_drift AS (\n  SELECT week_start AS day,\n    ROUND(((weekly_cost - LAG(weekly_cost) OVER (ORDER BY week_start)) * 100.0 / NULLIF(LAG(weekly_cost) OVER (ORDER BY week_start), 0)), 1) AS cost_drift\n  FROM cost_weekly\n),\njob_drift AS (\n  SELECT week_start AS day,\n    ROUND(((weekly_jobs - LAG(weekly_jobs) OVER (ORDER BY week_start)) * 100.0 / NULLIF(LAG(weekly_jobs) OVER (ORDER BY week_start), 0)), 1) AS job_drift\n  FROM job_weekly\n),\nquery_drift AS (\n  SELECT week_start AS day,\n    ROUND(((p95_duration - LAG(p95_duration) OVER (ORDER BY week_start)) * 100.0 / NULLIF(LAG(p95_duration) OVER (ORDER BY week_start), 0)), 1) AS query_drift\n  FROM query_weekly\n)\nSELECT\n  COALESCE(c.day, j.day, q.day) AS day,\n  COALESCE(c.cost_drift, 0) AS cost_drift,\n  COALESCE(j.job_drift, 0) AS job_drift,\n  COALESCE(q.query_drift, 0) AS query_drift\nFROM cost_drift c\nFULL OUTER JOIN job_drift j ON c.day = j.day\nFULL OUTER JOIN query_drift q ON COALESCE(c.day, j.day) = q.day\nWHERE COALESCE(c.day, j.day, q.day) IS NOT NULL\nORDER BY day"
    },
    {
      "name": "ds_event_trend",
      "displayName": "Event Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(event_date) AS day, \n  COUNT(*) AS events,\n  COUNT(DISTINCT user_identity_email) AS unique_users \nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_date >= :time_range.min AND event_date <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_kpi_success_rate",
      "displayName": "KPI: Success Rate",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0), 3) AS success_rate \nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max"
    },
    {
      "name": "ds_kpi_cluster",
      "displayName": "KPI: Cluster",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(AVG(CASE WHEN driver THEN 80 ELSE 60 END), 0) AS avg_cpu \nFROM ${catalog}.${gold_schema}.fact_node_timeline \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max"
    },
    {
      "name": "ds_kpi_totals",
      "displayName": "KPI: Totals",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n    COUNT(*) AS total_runs,\n    SUM(CASE WHEN result_state NOT IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) AS total_failures\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max"
    },
    {
      "name": "ds_kpi_tables",
      "displayName": "KPI: Tables",
      "query": "SELECT COUNT(DISTINCT target_table_full_name) AS total_tables FROM ${catalog}.${gold_schema}.fact_table_lineage"
    },
    {
      "name": "ds_monitor_cost_drift",
      "displayName": "Monitor: Cost Drift",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n  DATE(window.start) AS window_start, \n  ROUND(COALESCE(cost_drift_pct, 0) / 100.0, 4) AS drift_pct \nFROM ${catalog}.${gold_schema}_monitoring.fact_usage_drift_metrics \nWHERE column_name = ':table' \n  AND drift_type = 'CONSECUTIVE'\n  AND slice_key IS NULL\n  AND window.end >= :time_range.min AND window.end <= :time_range.max\nORDER BY window.start DESC\nLIMIT 1"
    },
    {
      "name": "ds_kpi_documented",
      "displayName": "KPI: Documented",
      "query": "SELECT COUNT(DISTINCT table_full_name) AS documented_tables FROM (SELECT source_table_full_name AS table_full_name FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE source_table_full_name IS NOT NULL UNION SELECT target_table_full_name AS table_full_name FROM ${catalog}.${gold_schema}.fact_table_lineage WHERE target_table_full_name IS NOT NULL)"
    },
    {
      "name": "ds_kpi_30d",
      "displayName": "KPI: 30d Spend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT SUM(list_cost) AS cost_30d \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS"
    },
    {
      "name": "ds_kpi_denied",
      "displayName": "KPI: Denied",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT request_id) AS denied_access FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE (response_status_code IN ('403', 'FORBIDDEN', 'PERMISSION_DENIED', 'ACCESS_DENIED') OR response_result IN ('DENIED', 'PERMISSION_DENIED', 'FORBIDDEN')) AND event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_tag_coverage",
      "displayName": "Tag Coverage",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(SUM(CASE WHEN is_tagged THEN list_cost ELSE 0 END) / NULLIF(SUM(list_cost), 0), 3) AS tag_coverage \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max"
    },
    {
      "name": "ds_30_60_compare",
      "displayName": "30 vs 60 Day Compare",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "WITH periods AS (SELECT SUM(CASE WHEN usage_date >= CURRENT_DATE() - INTERVAL 30 DAYS THEN list_cost ELSE 0 END) AS last_30, SUM(CASE WHEN usage_date BETWEEN CURRENT_DATE() - INTERVAL 60 DAYS AND CURRENT_DATE() - INTERVAL 31 DAYS THEN list_cost ELSE 0 END) AS prev_30 FROM ${catalog}.${gold_schema}.fact_usage) SELECT CONCAT(ROUND((last_30 - prev_30) * 100.0 / NULLIF(prev_30, 0), 1), '%') AS growth_pct FROM periods"
    },
    {
      "name": "ds_ml_cost_anomalies",
      "displayName": "ML: Cost Anomalies",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ],
      "query": "WITH top_cost_drivers AS (\n  SELECT\n    workspace_id,\n    MAX(usage_date) AS latest_cost_date,\n    billing_origin_product,\n    sku_name,\n    COALESCE(usage_metadata_job_id, usage_metadata_warehouse_id, CONCAT('SKU:', sku_name)) AS resource_id,\n    SUM(list_cost) AS resource_cost,\n    ROW_NUMBER() OVER (PARTITION BY workspace_id ORDER BY SUM(list_cost) DESC) AS cost_rank\n  FROM ${catalog}.${gold_schema}.fact_usage\n  WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n  GROUP BY workspace_id, billing_origin_product, sku_name, COALESCE(usage_metadata_job_id, usage_metadata_warehouse_id, CONCAT('SKU:', sku_name))\n),\nworkspace_names AS (\n  SELECT DISTINCT workspace_id, workspace_name\n  FROM ${catalog}.${gold_schema}.dim_workspace\n)\nSELECT\n  COALESCE(w.workspace_name, CAST(t.workspace_id AS STRING)) AS workspace,\n  CASE \n    WHEN t.resource_cost > 5000 THEN 'HIGH'\n    WHEN t.resource_cost > 1000 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END AS severity,\n  CASE\n    WHEN t.billing_origin_product = 'JOBS' THEN CONCAT('Job ID: ', t.resource_id)\n    WHEN t.billing_origin_product = 'SQL' THEN CONCAT('Warehouse ID: ', t.resource_id)\n    ELSE CONCAT(t.billing_origin_product, ' - ', t.sku_name)\n  END AS cost_driver,\n  ROUND(t.resource_cost, 2) AS daily_cost,\n  CASE \n    WHEN t.resource_cost > 5000 THEN 'Investigate immediately - high cost resource'\n    WHEN t.resource_cost > 1000 THEN 'Review for optimization opportunities'\n    ELSE 'Monitor cost trends'\n  END AS recommended_action,\n  CONCAT(\n    'SKU: ', t.sku_name, '. ',\n    '7-day total: $', FORMAT_NUMBER(t.resource_cost, 2), '. ',\n    'Product: ', t.billing_origin_product, '. ',\n    'Resource: ', t.resource_id\n  ) AS rationale\nFROM top_cost_drivers t\nLEFT JOIN workspace_names w ON t.workspace_id = w.workspace_id\nWHERE t.cost_rank <= 5\nORDER BY t.resource_cost DESC\nLIMIT 20"
    },
    {
      "name": "ds_health_issues",
      "displayName": "Health Issues",
      "query": "-- Top Health Issues with Asset Metadata and Blast Radius\n-- Comprehensive view of platform health issues across all domains\n\nWITH job_issues AS (\n  SELECT \n    ' Reliability' AS category,\n    COALESCE(CAST(j.job_id AS STRING), 'Unknown') AS asset_id,\n    COALESCE(j.name, CAST(j.job_id AS STRING), 'Unknown Job') AS asset_name,\n    'Job' AS asset_type,\n    COALESCE(u.email, j.run_as, j.creator_id, 'Unknown') AS asset_owner,\n    COALESCE(w.workspace_name, CAST(f.workspace_id AS STRING)) AS workspace_name,\n    COUNT(*) AS issue_count,\n    CONCAT(COUNT(*), ' job failures') AS reason,\n    MAX(f.run_date) AS last_occurrence,\n    CASE WHEN COUNT(*) > 10 THEN 'High' WHEN COUNT(*) > 5 THEN 'Medium' ELSE 'Low' END AS severity\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline f\n  LEFT JOIN ${catalog}.${gold_schema}.dim_job j ON f.job_id = j.job_id AND f.workspace_id = j.workspace_id\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON f.workspace_id = w.workspace_id\n  LEFT JOIN ${catalog}.${gold_schema}.dim_user u ON CAST(COALESCE(j.run_as, j.creator_id) AS STRING) = u.user_id\n  WHERE f.run_date >= :time_range.min AND f.run_date <= :time_range.max\n    AND f.result_state NOT IN ('SUCCESS', 'SUCCEEDED') AND f.result_state IS NOT NULL\n  GROUP BY j.job_id, j.name, j.run_as, j.creator_id, u.email, f.workspace_id, w.workspace_name\n  HAVING COUNT(*) > 0\n),\nquery_issues AS (\n  SELECT \n    ' Performance' AS category,\n    COALESCE(q.statement_id, 'Unknown') AS asset_id,\n    COALESCE(LEFT(q.statement_text, 50), 'Unknown Query') AS asset_name,\n    'Query' AS asset_type,\n    COALESCE(u.email, CAST(q.executed_by_user_id AS STRING), 'Unknown') AS asset_owner,\n    COALESCE(q.compute_type, 'Unknown') AS workspace_name,\n    COUNT(*) AS issue_count,\n    CONCAT(COUNT(*), ' query failures') AS reason,\n    MAX(DATE(q.start_time)) AS last_occurrence,\n    CASE WHEN COUNT(*) > 20 THEN 'High' WHEN COUNT(*) > 10 THEN 'Medium' ELSE 'Low' END AS severity\n  FROM ${catalog}.${gold_schema}.fact_query_history q\n  LEFT JOIN ${catalog}.${gold_schema}.dim_user u ON CAST(q.executed_by_user_id AS STRING) = u.user_id\n  WHERE q.start_time >= :time_range.min AND q.start_time <= :time_range.max\n    AND q.execution_status != 'FINISHED'\n  GROUP BY q.statement_id, LEFT(q.statement_text, 50), q.executed_by_user_id, u.email, q.compute_type\n  HAVING COUNT(*) > 0\n),\ncost_issues AS (\n  SELECT \n    ' Cost' AS category,\n    c.workspace_id AS asset_id,\n    COALESCE(w.workspace_name, c.workspace_id, 'Unknown Workspace') AS asset_name,\n    'Workspace' AS asset_type,\n    'Unknown' AS asset_owner,\n    COALESCE(w.workspace_name, c.workspace_id) AS workspace_name,\n    ROUND(SUM(c.list_cost), 2) AS issue_count,\n    CONCAT('$', ROUND(SUM(c.list_cost), 0), ' untagged spend') AS reason,\n    MAX(c.usage_date) AS last_occurrence,\n    CASE WHEN SUM(c.list_cost) > 10000 THEN 'High' WHEN SUM(c.list_cost) > 1000 THEN 'Medium' ELSE 'Low' END AS severity\n  FROM ${catalog}.${gold_schema}.fact_usage c\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON c.workspace_id = w.workspace_id\n  WHERE c.usage_date >= :time_range.min AND c.usage_date <= :time_range.max\n    AND NOT COALESCE(c.is_tagged, false)\n  GROUP BY c.workspace_id, w.workspace_name\n  HAVING SUM(c.list_cost) > 100\n),\nsecurity_issues AS (\n  SELECT \n    ' Security' AS category,\n    COALESCE(a.user_identity_email, 'Unknown User') AS asset_id,\n    COALESCE(a.user_identity_email, 'Unknown User') AS asset_name,\n    'User' AS asset_type,\n    COALESCE(a.user_identity_email, 'Unknown') AS asset_owner,\n    COALESCE(w.workspace_name, 'Multiple Workspaces') AS workspace_name,\n    COUNT(*) AS issue_count,\n    CONCAT(COUNT(*), ' high-risk actions') AS reason,\n    MAX(a.event_date) AS last_occurrence,\n    CASE WHEN COUNT(*) > 50 THEN 'High' WHEN COUNT(*) > 20 THEN 'Medium' ELSE 'Low' END AS severity\n  FROM ${catalog}.${gold_schema}.fact_audit_logs a\n  LEFT JOIN ${catalog}.${gold_schema}.dim_workspace w ON a.workspace_id = w.workspace_id\n  WHERE a.event_date >= :time_range.min AND a.event_date <= :time_range.max\n    AND (a.response_result = 'denied' OR a.action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropUser', 'addUserToGroup', 'removeUserFromGroup'))\n  GROUP BY a.user_identity_email, w.workspace_name\n  HAVING COUNT(*) > 5\n),\nquality_issues AS (\n  SELECT \n    ' Quality' AS category,\n    COALESCE(l.target_table_full_name, 'Unknown Table') AS asset_id,\n    COALESCE(SPLIT(l.target_table_full_name, '.')[2], l.target_table_full_name) AS asset_name,\n    'Table' AS asset_type,\n    COALESCE(t.table_owner, 'Unknown') AS asset_owner,\n    COALESCE(t.table_catalog, 'Unknown') AS workspace_name,\n    COUNT(*) AS issue_count,\n    CONCAT('Low lineage activity (', COUNT(*), ' events)') AS reason,\n    MAX(DATE(l.event_time)) AS last_occurrence,\n    'Medium' AS severity\n  FROM ${catalog}.${gold_schema}.fact_table_lineage l\n  LEFT JOIN system.information_schema.tables t ON l.target_table_full_name = CONCAT(t.table_catalog, '.', t.table_schema, '.', t.table_name)\n  WHERE l.event_time >= :time_range.min AND l.event_time <= :time_range.max\n  GROUP BY l.target_table_full_name, t.table_owner, t.table_catalog\n  HAVING COUNT(*) < 5\n),\n-- Blast Radius: Get lineage data for all issues\nlineage_data AS (\n  SELECT \n    COALESCE(target_table_full_name, source_table_full_name, entity_id) AS related_asset_id,\n    COLLECT_LIST(DISTINCT CASE WHEN source_table_full_name IS NOT NULL THEN source_table_full_name END) AS upstream_tables,\n    COLLECT_LIST(DISTINCT CASE WHEN target_table_full_name IS NOT NULL THEN target_table_full_name END) AS downstream_tables,\n    COLLECT_LIST(DISTINCT entity_type) AS affected_entity_types,\n    COLLECT_LIST(DISTINCT entity_id) AS affected_entities,\n    COUNT(DISTINCT CASE WHEN entity_type IN ('JOB', 'PIPELINE') THEN entity_id END) AS affected_pipelines_count,\n    COUNT(DISTINCT CASE WHEN entity_type IN ('DASHBOARD_V3', 'DBSQL_DASHBOARD') THEN entity_id END) AS affected_dashboards_count,\n    COUNT(DISTINCT target_table_full_name) + COUNT(DISTINCT source_table_full_name) AS total_dependencies\n  FROM system.access.table_lineage\n  WHERE event_date >= CURRENT_DATE() - INTERVAL 30 DAYS\n  GROUP BY COALESCE(target_table_full_name, source_table_full_name, entity_id)\n),\ncombined_issues AS (\n  SELECT \n    category,\n    asset_id,\n    asset_name,\n    asset_type,\n    asset_owner,\n    workspace_name,\n    issue_count,\n    reason,\n    last_occurrence,\n    severity\n  FROM job_issues\n  UNION ALL\n  SELECT * FROM query_issues\n  UNION ALL\n  SELECT * FROM cost_issues\n  UNION ALL\n  SELECT * FROM security_issues\n  UNION ALL\n  SELECT * FROM quality_issues\n)\nSELECT \n  c.category,\n  c.asset_id,\n  c.asset_name,\n  c.asset_type,\n  c.asset_owner,\n  c.workspace_name,\n  c.issue_count,\n  c.reason,\n  c.last_occurrence,\n  c.severity,\n  -- Blast Radius Columns\n  COALESCE(ARRAY_JOIN(ARRAY_DISTINCT(FILTER(l.upstream_tables, x -> x IS NOT NULL)), ', '), 'None') AS upstream_dependencies,\n  COALESCE(ARRAY_JOIN(ARRAY_DISTINCT(FILTER(l.downstream_tables, x -> x IS NOT NULL)), ', '), 'None') AS downstream_dependencies,\n  COALESCE(l.affected_pipelines_count, 0) AS affected_pipelines,\n  COALESCE(l.affected_dashboards_count, 0) AS affected_dashboards,\n  COALESCE(l.total_dependencies, 0) AS total_dependencies,\n  -- Impact Score (0-100): Based on issue severity, count, and blast radius\n  LEAST(100, \n    (CASE c.severity WHEN 'High' THEN 50 WHEN 'Medium' THEN 30 ELSE 10 END) +\n    (LEAST(c.issue_count, 20) * 1.5) +\n    (COALESCE(l.total_dependencies, 0) * 0.5)\n  ) AS impact_score\nFROM combined_issues c\nLEFT JOIN lineage_data l ON c.asset_id = l.related_asset_id OR c.asset_name = l.related_asset_id\nORDER BY \n  CASE c.severity WHEN 'High' THEN 1 WHEN 'Medium' THEN 2 ELSE 3 END,\n  c.issue_count DESC,\n  impact_score DESC\nLIMIT 20",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "ds_sku_breakdown",
      "displayName": "Billing Origin Product Breakdown",
      "parameters": [
        {
          "displayName": "param_sku_type",
          "keyword": "param_sku_type",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [{"value": "all"}]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-30d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT \n  COALESCE(billing_origin_product, 'Unknown') AS product, \n  ROUND(SUM(list_cost), 2) AS cost \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max \n  AND (ARRAY_CONTAINS(:param_sku_type, 'all') OR ARRAY_CONTAINS(:param_sku_type, sku_name) OR :param_sku_type IS NULL)\nGROUP BY 1 \nHAVING SUM(list_cost) > 0\nORDER BY cost DESC \nLIMIT 10"
    },
    {
      "name": "ds_kpi_admin",
      "displayName": "KPI: Admin",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(*) AS admin_actions FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE action_name LIKE '%Admin%' AND event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_kpi_users",
      "displayName": "KPI: Users",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT user_identity_email) AS active_users \nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE event_date >= :time_range.min AND event_date <= :time_range.max\n  AND user_identity_email IS NOT NULL\n  AND user_identity_email NOT LIKE '%.gserviceaccount.com'\n  AND user_identity_email NOT LIKE 'service-principal-%'\n  AND user_identity_email NOT LIKE '%[ServicePrincipal]%'\n  AND user_identity_email NOT IN ('System-User', 'system', 'admin', 'root', 'databricks')"
    },
    {
      "name": "ds_cost_trend",
      "displayName": "Cost Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(usage_date) AS day, SUM(list_cost) AS daily_cost \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= :time_range.min AND usage_date <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_monitor_job_drift",
      "displayName": "Monitor: Job Drift",
      "query": "-- Calculates week-over-week job volume drift from actual data\nWITH current_week AS (\n  SELECT COUNT(*) AS runs\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n),\nprevious_week AS (\n  SELECT COUNT(*) AS runs\n  FROM ${catalog}.${gold_schema}.fact_job_run_timeline\n  WHERE run_date >= CURRENT_DATE() - INTERVAL 14 DAYS\n    AND run_date < CURRENT_DATE() - INTERVAL 7 DAYS\n)\nSELECT\n  ROUND(\n    CASE \n      WHEN p.runs = 0 THEN 0\n      ELSE (c.runs - p.runs) * 1.0 / p.runs\n    END,\n    4\n  ) AS drift_pct\nFROM current_week c, previous_week p"
    },
    {
      "name": "ds_kpi_mtd",
      "displayName": "KPI: MTD Spend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT SUM(list_cost) AS cost_mtd \nFROM ${catalog}.${gold_schema}.fact_usage \nWHERE usage_date >= DATE_TRUNC('month', CURRENT_DATE())"
    },
    {
      "name": "ds_kpi_permissions",
      "displayName": "KPI: Permissions",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT request_id) AS permission_changes FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE action_name IN ('updatePermissions', 'grantPermission', 'revokePermission', 'addUserToGroup', 'removeUserFromGroup', 'setPermissions', 'changeOwner', 'createGrant', 'deleteGrant') AND event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_kpi_high_risk",
      "displayName": "KPI: High Risk",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-7d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT request_id) AS high_risk_events FROM ${catalog}.${gold_schema}.fact_audit_logs WHERE action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropUser', 'deleteCluster', 'deleteWarehouse', 'deletePipeline', 'deleteExperiment', 'deleteModel') AND event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_success_trend",
      "displayName": "Success Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(run_date) AS day, \n  ROUND(SUM(CASE WHEN result_state IN ('SUCCESS', 'SUCCEEDED') THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*), 0), 1) AS success_rate\nFROM ${catalog}.${gold_schema}.fact_job_run_timeline \nWHERE run_date >= :time_range.min AND run_date <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_kpi_workspaces",
      "displayName": "KPI: Workspaces",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(DISTINCT workspace_id) AS total_workspaces FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= :time_range.min AND usage_date <= :time_range.max"
    },
    {
      "name": "ds_drift_alerts",
      "displayName": "Drift Alerts",
      "query": "-- Calculates week-over-week drift alerts from actual Gold layer data\nWITH this_week_cost AS (\n  SELECT SUM(list_cost) AS total FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n),\nlast_week_cost AS (\n  SELECT SUM(list_cost) AS total FROM ${catalog}.${gold_schema}.fact_usage WHERE usage_date >= CURRENT_DATE() - INTERVAL 14 DAYS AND usage_date < CURRENT_DATE() - INTERVAL 7 DAYS\n),\nthis_week_jobs AS (\n  SELECT COUNT(*) AS total FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 7 DAYS\n),\nlast_week_jobs AS (\n  SELECT COUNT(*) AS total FROM ${catalog}.${gold_schema}.fact_job_run_timeline WHERE run_date >= CURRENT_DATE() - INTERVAL 14 DAYS AND run_date < CURRENT_DATE() - INTERVAL 7 DAYS\n),\nthis_week_p95 AS (\n  SELECT PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) AS p95 FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 7 DAYS\n),\nlast_week_p95 AS (\n  SELECT PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_duration_ms) AS p95 FROM ${catalog}.${gold_schema}.fact_query_history WHERE start_time >= CURRENT_DATE() - INTERVAL 14 DAYS AND start_time < CURRENT_DATE() - INTERVAL 7 DAYS\n)\nSELECT \n  'Cost' AS area,\n  'Week-over-Week Cost %' AS metric,\n  ROUND((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0), 2) AS drift_pct,\n  CASE \n    WHEN ABS((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0)) > 20 THEN 'high'\n    WHEN ABS((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0)) > 10 THEN 'medium'\n    ELSE 'low'\n  END AS severity\nFROM this_week_cost tw, last_week_cost lw\nUNION ALL\nSELECT \n  'Reliability' AS area,\n  'Week-over-Week Job Volume %' AS metric,\n  ROUND((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0), 2) AS drift_pct,\n  CASE \n    WHEN ABS((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0)) > 50 THEN 'high'\n    WHEN ABS((tw.total - lw.total) * 100.0 / NULLIF(lw.total, 0)) > 25 THEN 'medium'\n    ELSE 'low'\n  END AS severity\nFROM this_week_jobs tw, last_week_jobs lw\nUNION ALL\nSELECT \n  'Performance' AS area,\n  'Week-over-Week P95 Query Duration %' AS metric,\n  ROUND((tw.p95 - lw.p95) * 100.0 / NULLIF(lw.p95, 0), 2) AS drift_pct,\n  CASE \n    WHEN ABS((tw.p95 - lw.p95) * 100.0 / NULLIF(lw.p95, 0)) > 30 THEN 'high'\n    WHEN ABS((tw.p95 - lw.p95) * 100.0 / NULLIF(lw.p95, 0)) > 15 THEN 'medium'\n    ELSE 'low'\n  END AS severity\nFROM this_week_p95 tw, last_week_p95 lw\nORDER BY ABS(drift_pct) DESC"
    },
    {
      "name": "ds_kpi_failed",
      "displayName": "KPI: Failed Queries",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT ROUND(\n    SUM(CASE WHEN execution_status != 'FINISHED' THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0), \n    3) AS failed_queries_pct \nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max"
    },
    {
      "name": "ds_query_volume",
      "displayName": "Query Volume",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(start_time) AS day, COUNT(*) AS query_count \nFROM ${catalog}.${gold_schema}.fact_query_history \nWHERE start_time >= :time_range.min AND start_time <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_lineage_trend",
      "displayName": "Lineage Trend",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT DATE(event_time) AS day, COUNT(*) AS events, COUNT(DISTINCT target_table_full_name) AS tables \nFROM ${catalog}.${gold_schema}.fact_table_lineage \nWHERE event_time >= :time_range.min AND event_time <= :time_range.max \nGROUP BY 1 ORDER BY 1"
    },
    {
      "name": "ds_kpi_security",
      "displayName": "KPI: Security",
      "parameters": [
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "time_range",
          "keyword": "time_range",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ],
      "query": "SELECT COUNT(*) AS high_risk \nFROM ${catalog}.${gold_schema}.fact_audit_logs \nWHERE action_name IN ('deleteTable', 'deleteSchema', 'deleteCatalog', 'dropUser') \nAND event_date >= :time_range.min AND event_date <= :time_range.max"
    },
    {
      "name": "ds_time_windows",
      "displayName": "Time Windows",
      "query": "SELECT 'Last 7 Days' AS time_window UNION ALL SELECT 'Last 30 Days' UNION ALL SELECT 'Last 90 Days' UNION ALL SELECT 'Last 6 Months' UNION ALL SELECT 'Last Year'"
    },
    {
      "name": "ds_workspaces",
      "displayName": "Workspaces",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ],
      "query": "SELECT 'All' AS workspace_name \nUNION ALL \nSELECT DISTINCT workspace_name \nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL \nORDER BY workspace_name"
    },
    {
      "name": "select_workspace",
      "displayName": "select_workspace",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ],
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CONCAT('id: ', workspace_id)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace \nWHERE workspace_name IS NOT NULL\nORDER BY workspace_name"
    },
    {
      "name": "select_time_key",
      "displayName": "select_time_key",
      "query": "SELECT 'Day' AS time_key UNION ALL SELECT 'Week' UNION ALL SELECT 'Month' UNION ALL SELECT 'Quarter'"
    },
    {
      "name": "ds_select_workspace",
      "displayName": "select_workspace",
      "query": "SELECT DISTINCT \n  COALESCE(workspace_name, CAST(workspace_id AS STRING)) AS workspace_name\nFROM ${catalog}.${gold_schema}.dim_workspace\nORDER BY 1",
      "parameters": [
        {
          "displayName": "param_workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "complexType": "MULTI",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "all"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ds_select_sku",
      "displayName": "ds_select_sku",
      "query": "SELECT 'all' AS sku_category UNION ALL SELECT DISTINCT sku_name AS sku_category FROM ${catalog}.${gold_schema}.fact_usage WHERE sku_name IS NOT NULL ORDER BY 1",
      "parameters": []
    }
  ],
  "pages": [
    {
      "name": "page_executive_summary",
      "displayName": "\ud83d\udcca Executive Summary",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_cost",
                  "fields": [
                    {
                      "name": "cost_30d",
                      "expression": "`cost_30d`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "cost_30d",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Total Cost (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_job_success",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "fields": [
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Job Success Rate"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_query_perf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_query",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a1 Avg Query (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_active_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_users",
                  "fields": [
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "active_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc65 Active Users (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_security_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_security",
                  "fields": [
                    {
                      "name": "high_risk",
                      "expression": "`high_risk`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 High Risk Events"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_cluster_util",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_cluster",
                  "fields": [
                    {
                      "name": "avg_cpu",
                      "expression": "`avg_cpu`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_cpu",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udda5\ufe0f Avg CPU Util %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_cost_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "daily_cost",
                  "displayName": "Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Daily Cost Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_job_success_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_job_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "success_rate",
                  "displayName": "Success Rate %",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u2705 Job Success Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 4,
            "width": 3,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_platform_health",
      "displayName": "\ud83c\udfe5 Platform Health",
      "layout": [
        {
          "widget": {
            "name": "kpi_health_score",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_health_score",
                  "fields": [
                    {
                      "name": "health_score",
                      "expression": "`health_score`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "health_score",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83c\udfe5 Overall Health Score"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_cost_health",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_cost_health",
                  "fields": [
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "status",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Cost Health"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_reliability_health",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_reliability_health",
                  "fields": [
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "status",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u2705 Reliability Health"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "table_health_issues",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_health_issues",
                  "fields": [
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "category",
                      "expression": "`category`"
                    },
                    {
                      "name": "asset_type",
                      "expression": "`asset_type`"
                    },
                    {
                      "name": "asset_name",
                      "expression": "`asset_name`"
                    },
                    {
                      "name": "asset_owner",
                      "expression": "`asset_owner`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "reason",
                      "expression": "`reason`"
                    },
                    {
                      "name": "last_occurrence",
                      "expression": "`last_occurrence`"
                    },
                    {
                      "name": "upstream_dependencies",
                      "expression": "`upstream_dependencies`"
                    },
                    {
                      "name": "downstream_dependencies",
                      "expression": "`downstream_dependencies`"
                    },
                    {
                      "name": "affected_pipelines",
                      "expression": "`affected_pipelines`"
                    },
                    {
                      "name": "affected_dashboards",
                      "expression": "`affected_dashboards`"
                    },
                    {
                      "name": "impact_score",
                      "expression": "`impact_score`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "severity",
                    "displayName": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "category",
                    "displayName": "Category",
                    "type": "string"
                  },
                  {
                    "fieldName": "asset_type",
                    "displayName": "Asset Type",
                    "type": "string"
                  },
                  {
                    "fieldName": "asset_name",
                    "displayName": "Asset Name",
                    "type": "string"
                  },
                  {
                    "fieldName": "asset_owner",
                    "displayName": "Owner",
                    "type": "string"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "reason",
                    "displayName": "Issue",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_occurrence",
                    "displayName": "Last Seen",
                    "type": "date"
                  },
                  {
                    "fieldName": "upstream_dependencies",
                    "displayName": "Upstream (Reads From)",
                    "type": "string"
                  },
                  {
                    "fieldName": "downstream_dependencies",
                    "displayName": "Downstream (Writes To)",
                    "type": "string"
                  },
                  {
                    "fieldName": "affected_pipelines",
                    "displayName": "# Pipelines",
                    "type": "number"
                  },
                  {
                    "fieldName": "affected_dashboards",
                    "displayName": "# Dashboards",
                    "type": "number"
                  },
                  {
                    "fieldName": "impact_score",
                    "displayName": "Impact Score",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Top Health Issues (Jobs, Queries, Costs) with Blast Radius"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_health_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_health_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "health_score",
                      "expression": "`health_score`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "health_score",
                  "displayName": "Health Score",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Health Score Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_ml_insights",
      "displayName": "\ud83e\udd16 ML Insights",
      "layout": [
        {
          "widget": {
            "name": "table_ml_cost_anomalies",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_cost_anomalies",
                  "fields": [
                    {
                      "name": "workspace",
                      "expression": "`workspace`"
                    },
                    {
                      "name": "anomaly_score",
                      "expression": "`anomaly_score`"
                    },
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    },
                    {
                      "name": "cost_driver",
                      "expression": "`cost_driver`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "severity",
                    "title": "Severity",
                    "type": "string"
                  },
                  {
                    "fieldName": "cost_driver",
                    "title": "Cost Driver",
                    "type": "string"
                  },
                  {
                    "fieldName": "daily_cost",
                    "title": "Daily Cost",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Details",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Cost Anomalies Detected"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_job_risks",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_job_risks",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "failure_probability",
                      "expression": "`failure_probability`"
                    },
                    {
                      "name": "risk_level",
                      "expression": "`risk_level`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    },
                    {
                      "name": "last_error_preview",
                      "expression": "`last_error_preview`"
                    },
                    {
                      "name": "last_failure_date",
                      "expression": "`last_failure_date`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "title": "Job",
                    "type": "string"
                  },
                  {
                    "fieldName": "failure_probability",
                    "title": "Fail Prob",
                    "type": "number"
                  },
                  {
                    "fieldName": "risk_level",
                    "title": "Risk",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Stats",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_error_preview",
                    "title": "Last Error",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_failure_date",
                    "title": "Last Failed",
                    "type": "date"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Jobs at Risk"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_security_threats",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_security_threats",
                  "fields": [
                    {
                      "name": "user_identity",
                      "expression": "`user_identity`"
                    },
                    {
                      "name": "threat_type",
                      "expression": "`threat_type`"
                    },
                    {
                      "name": "risk_score",
                      "expression": "`risk_score`"
                    },
                    {
                      "name": "incident_summary",
                      "expression": "`incident_summary`"
                    },
                    {
                      "name": "last_suspicious_action",
                      "expression": "`last_suspicious_action`"
                    },
                    {
                      "name": "affected_service",
                      "expression": "`affected_service`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_identity",
                    "title": "User",
                    "type": "string"
                  },
                  {
                    "fieldName": "threat_type",
                    "title": "Threat",
                    "type": "string"
                  },
                  {
                    "fieldName": "risk_score",
                    "title": "Risk",
                    "type": "number"
                  },
                  {
                    "fieldName": "incident_summary",
                    "title": "Incident Summary (30d)",
                    "type": "string"
                  },
                  {
                    "fieldName": "last_suspicious_action",
                    "title": "Last Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "affected_service",
                    "title": "Service",
                    "type": "string"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Security Threats"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_ml_capacity",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_ml_capacity",
                  "fields": [
                    {
                      "name": "resource_name",
                      "expression": "`resource_name`"
                    },
                    {
                      "name": "resource_type",
                      "expression": "`resource_type`"
                    },
                    {
                      "name": "utilization_pct",
                      "expression": "`utilization_pct`"
                    },
                    {
                      "name": "recommended_action",
                      "expression": "`recommended_action`"
                    },
                    {
                      "name": "rationale",
                      "expression": "`rationale`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "resource_name",
                    "title": "Resource",
                    "type": "string"
                  },
                  {
                    "fieldName": "resource_type",
                    "title": "Type/Size",
                    "type": "string"
                  },
                  {
                    "fieldName": "utilization_pct",
                    "title": "Utilization %",
                    "type": "number"
                  },
                  {
                    "fieldName": "recommended_action",
                    "title": "Action",
                    "type": "string"
                  },
                  {
                    "fieldName": "rationale",
                    "title": "Rationale",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83e\udd16 ML: Capacity Recommendations"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 6,
            "width": 3,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_monitoring_alerts",
      "displayName": "\ud83d\udcca Monitoring Alerts",
      "layout": [
        {
          "widget": {
            "name": "kpi_cost_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "fields": [
                    {
                      "name": "drift_pct",
                      "expression": "`drift_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "drift_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcb0 Cost Drift %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_job_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_job_drift",
                  "fields": [
                    {
                      "name": "drift_pct",
                      "expression": "`drift_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "drift_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Job Volume Drift %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_query_drift",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_monitor_query_drift",
                  "fields": [
                    {
                      "name": "drift_pct",
                      "expression": "`drift_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "drift_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26a1 Query Duration Drift %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "table_drift_alerts",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_drift_alerts",
                  "fields": [
                    {
                      "name": "area",
                      "expression": "`area`"
                    },
                    {
                      "name": "metric",
                      "expression": "`metric`"
                    },
                    {
                      "name": "drift_pct",
                      "expression": "`drift_pct`"
                    },
                    {
                      "name": "severity",
                      "expression": "`severity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "area",
                    "displayName": "Area"
                  },
                  {
                    "fieldName": "metric",
                    "displayName": "Metric"
                  },
                  {
                    "fieldName": "drift_pct",
                    "displayName": "Drift %"
                  },
                  {
                    "fieldName": "severity",
                    "displayName": "Severity"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Active Drift Alerts (>10%)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_drift_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_drift_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "cost_drift",
                      "expression": "`cost_drift`"
                    },
                    {
                      "name": "job_drift",
                      "expression": "`job_drift`"
                    },
                    {
                      "name": "query_drift",
                      "expression": "`query_drift`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "cost_drift",
                      "displayName": "Cost Drift %"
                    },
                    {
                      "fieldName": "job_drift",
                      "displayName": "Job Volume Drift %"
                    },
                    {
                      "fieldName": "query_drift",
                      "displayName": "Query Duration Drift %"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Drift Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_cost_overview",
      "displayName": "\ud83d\udcb0 Cost Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_mtd_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "fields": [
                    {
                      "name": "cost_mtd",
                      "expression": "`cost_mtd`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "cost_mtd",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTD Spend",
                "description": "Month-to-Date Total"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_spend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "fields": [
                    {
                      "name": "cost_30d",
                      "expression": "`cost_30d`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "cost_30d",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Spend"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_30d_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "fields": [
                    {
                      "name": "growth_pct",
                      "expression": "`growth_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "growth_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30d vs 60d Growth %"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_tag_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "fields": [
                    {
                      "name": "tag_coverage",
                      "expression": "`tag_coverage`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "tag_coverage",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tag Coverage %"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_serverless",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "fields": [
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "serverless_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Serverless Adoption %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "fields": [
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "active_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Unique Users"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_wow_growth",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "weekly_cost",
                      "expression": "`weekly_cost`"
                    },
                    {
                      "name": "wow_growth_pct",
                      "expression": "`wow_growth_pct`"
                    },
                    {
                      "name": "moving_avg",
                      "expression": "`moving_avg`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "displayName": "Week",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "weekly_cost",
                      "displayName": "Weekly Cost ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Week-over-Week Cost & Growth Trend"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_daily_cost",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "serverless_cost",
                      "expression": "`serverless_cost`"
                    },
                    {
                      "name": "classic_cost",
                      "expression": "`classic_cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "serverless_cost",
                      "displayName": "Serverless ($)"
                    },
                    {
                      "fieldName": "classic_cost",
                      "displayName": "Classic ($)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcca Daily Cost: Serverless vs Classic"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "table_top_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "total_cost",
                      "expression": "`total_cost`"
                    },
                    {
                      "name": "total_dbus",
                      "expression": "`total_dbus`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "cost_per_user",
                      "expression": "`cost_per_user`"
                    },
                    {
                      "name": "job_count",
                      "expression": "`job_count`"
                    },
                    {
                      "name": "job_runs",
                      "expression": "`job_runs`"
                    },
                    {
                      "name": "serverless_pct",
                      "expression": "`serverless_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "title": "Workspace",
                    "type": "string"
                  },
                  {
                    "fieldName": "total_cost",
                    "title": "Cost ($)",
                    "type": "number"
                  },
                  {
                    "fieldName": "total_dbus",
                    "title": "DBUs",
                    "type": "number"
                  },
                  {
                    "fieldName": "unique_users",
                    "title": "Users",
                    "type": "number"
                  },
                  {
                    "fieldName": "cost_per_user",
                    "title": "$/User",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_count",
                    "title": "Jobs",
                    "type": "number"
                  },
                  {
                    "fieldName": "job_runs",
                    "title": "Runs",
                    "type": "number"
                  },
                  {
                    "fieldName": "serverless_pct",
                    "title": "Serverless %",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": " Top Workspaces (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_product_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "fields": [
                    {
                      "name": "product",
                      "expression": "`product`"
                    },
                    {
                      "name": "cost",
                      "expression": "`cost`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "product",
                  "displayName": "Billing Origin Product",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "cost",
                  "displayName": "Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Spend by Billing Origin Product"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 16,
            "width": 3,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_performance_overview",
      "displayName": "\u26a1 Performance Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_queries",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Queries (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_avg_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "avg_duration",
                      "expression": "`avg_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Duration (sec)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (sec)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_slow_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_slow",
                  "fields": [
                    {
                      "name": "slow_queries_pct",
                      "expression": "`slow_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "slow_queries_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Slow Queries %",
                "description": ">60 seconds"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_failed_queries",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_failed",
                  "fields": [
                    {
                      "name": "failed_queries_pct",
                      "expression": "`failed_queries_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "failed_queries_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failed Queries %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "fields": [
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "unique_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_query_volume",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_query_volume",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "query_count",
                      "expression": "`query_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "query_count",
                  "displayName": "Query Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udcc8 Query Volume Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_duration_trend_perf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "metric",
                      "expression": "`metric`"
                    },
                    {
                      "name": "duration_min",
                      "expression": "`duration_min`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "duration_min",
                  "displayName": "Duration (min)",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "metric",
                  "displayName": "Metric",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Query Duration Trend (Avg vs P95)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_reliability_overview",
      "displayName": "\ud83d\udd04 Reliability Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_success_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "fields": [
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "success_rate",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Success Rate (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_runs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_runs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Runs (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_failures",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_failures",
                      "expression": "`total_failures`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_failures",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Failures (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_p95_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_duration",
                  "fields": [
                    {
                      "name": "p95_duration",
                      "expression": "`p95_duration`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "p95_duration",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "P95 Duration (min)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_mttr",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_mttr",
                  "fields": [
                    {
                      "name": "mttr_min",
                      "expression": "`mttr_min`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "mttr_min",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "MTTR (min)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "fields": [
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_runs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Runs (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_success_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_success_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "success_rate",
                      "expression": "`success_rate`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "success_rate",
                  "displayName": "Success Rate (%)",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Success Rate Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_runs_by_status",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_runs_by_status",
                  "fields": [
                    {
                      "name": "run_date",
                      "expression": "`run_date`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    },
                    {
                      "name": "count",
                      "expression": "`count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "run_date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "count",
                  "displayName": "Runs",
                  "scale": {
                    "type": "quantitative"
                  },
                  "stack": "zero"
                },
                "color": {
                  "fieldName": "status",
                  "displayName": "Status",
                  "scale": {
                    "type": "categorical",
                    "domain": ["Success", "Failed"],
                    "range": ["#2e7d32", "#c62828"]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Daily Runs by Status (Success vs Failed)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_duration_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "metric",
                      "expression": "`metric`"
                    },
                    {
                      "name": "duration_min",
                      "expression": "`duration_min`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fieldName": "duration_min",
                  "displayName": "Duration (min)"
                },
                "color": {
                  "fieldName": "metric",
                  "displayName": "Metric",
                  "scale": {
                    "type": "categorical"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Query Duration Trend (Avg vs P95)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_security_overview",
      "displayName": "\ud83d\udd12 Security Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_events",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "fields": [
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Audit Events (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_unique_users",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_users",
                  "fields": [
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "active_users",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unique Users (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_high_risk",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_high_risk",
                  "fields": [
                    {
                      "name": "high_risk_events",
                      "expression": "`high_risk_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "high_risk_events",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 High Risk Events (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_denied_access",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_denied",
                  "fields": [
                    {
                      "name": "denied_access",
                      "expression": "`denied_access`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "denied_access",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\u26d4 Access Denied (7d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_permission_changes",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_permissions",
                  "fields": [
                    {
                      "name": "permission_changes",
                      "expression": "`permission_changes`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "permission_changes",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd10 Permission Changes (7d)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_admin_actions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_admin",
                  "fields": [
                    {
                      "name": "admin_actions",
                      "expression": "`admin_actions`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "admin_actions",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udc51 Admin Actions (7d)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_event_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_event_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "events",
                      "expression": "`events`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "events",
                  "displayName": "Total Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Audit Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_risk_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_risk_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "high_risk",
                      "expression": "`high_risk`"
                    },
                    {
                      "name": "medium_risk",
                      "expression": "`medium_risk`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "high_risk",
                  "displayName": "High Risk Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "\ud83d\udd34 Risk Event Trend (30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_governance_overview",
      "displayName": "\ud83d\udcca Governance Overview",
      "layout": [
        {
          "widget": {
            "name": "kpi_total_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_tables",
                  "fields": [
                    {
                      "name": "total_tables",
                      "expression": "`total_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_tables",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_tagged_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_tagged",
                  "fields": [
                    {
                      "name": "tagged_pct",
                      "expression": "`tagged_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "tagged_pct",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Tagged Spend %"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_documented_tables",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_documented",
                  "fields": [
                    {
                      "name": "documented_tables",
                      "expression": "`documented_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "documented_tables",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Documented Tables"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_lineage_coverage",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_lineage",
                  "fields": [
                    {
                      "name": "lineage_tables",
                      "expression": "`lineage_tables`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "lineage_tables",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Lineage Tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_jobs",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_jobs",
                  "fields": [
                    {
                      "name": "total_jobs",
                      "expression": "`total_jobs`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_jobs",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Jobs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_total_workspaces",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_kpi_workspaces",
                  "fields": [
                    {
                      "name": "total_workspaces",
                      "expression": "`total_workspaces`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_workspaces",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Workspaces"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "chart_tables_by_catalog",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_tables_by_catalog",
                  "fields": [
                    {
                      "name": "catalog_name",
                      "expression": "`catalog_name`"
                    },
                    {
                      "name": "table_count",
                      "expression": "`table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "catalog_name",
                  "displayName": "Catalog",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "table_count",
                  "displayName": "Table Count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "title": " Tables by Catalog",
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "chart_lineage_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_lineage_trend",
                  "fields": [
                    {
                      "name": "day",
                      "expression": "`day`"
                    },
                    {
                      "name": "events",
                      "expression": "`events`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "day",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "events",
                  "displayName": "Lineage Events",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": " Lineage Events Trend (30d)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 4,
            "width": 3,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "58186255",
      "displayName": "Global Filters",
      "layout": [
        {
          "widget": {
            "name": "filter_time_range",
            "queries": [
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_query_time_range",
                "query": {
                  "datasetName": "ds_kpi_query",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_events_time_range",
                "query": {
                  "datasetName": "ds_kpi_events",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_duration_time_range",
                "query": {
                  "datasetName": "ds_kpi_duration",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_slow_time_range",
                "query": {
                  "datasetName": "ds_kpi_slow",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_queries_time_range",
                "query": {
                  "datasetName": "ds_kpi_queries",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_jobs_time_range",
                "query": {
                  "datasetName": "ds_kpi_jobs",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range",
                "query": {
                  "datasetName": "ds_unique_counts",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_query_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_query_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_risk_trend_time_range",
                "query": {
                  "datasetName": "ds_risk_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_tables_by_catalog_time_range",
                "query": {
                  "datasetName": "ds_tables_by_catalog",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_cost_time_range",
                "query": {
                  "datasetName": "ds_kpi_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range",
                "query": {
                  "datasetName": "ds_duration_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_runs_by_status_time_range",
                "query": {
                  "datasetName": "ds_runs_by_status",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_job_trend_time_range",
                "query": {
                  "datasetName": "ds_job_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range",
                "query": {
                  "datasetName": "ds_serverless_adoption",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_time_range",
                "query": {
                  "datasetName": "ds_kpi_mttr",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_drift_trend_time_range",
                "query": {
                  "datasetName": "ds_drift_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_event_trend_time_range",
                "query": {
                  "datasetName": "ds_event_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_time_range",
                "query": {
                  "datasetName": "ds_kpi_success_rate",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_cluster_time_range",
                "query": {
                  "datasetName": "ds_kpi_cluster",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_totals_time_range",
                "query": {
                  "datasetName": "ds_kpi_totals",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_cost_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_cost_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range",
                "query": {
                  "datasetName": "ds_kpi_30d",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_denied_time_range",
                "query": {
                  "datasetName": "ds_kpi_denied",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range",
                "query": {
                  "datasetName": "ds_tag_coverage",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range",
                "query": {
                  "datasetName": "ds_30_60_compare",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_admin_time_range",
                "query": {
                  "datasetName": "ds_kpi_admin",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_users_time_range",
                "query": {
                  "datasetName": "ds_kpi_users",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_cost_trend_time_range",
                "query": {
                  "datasetName": "ds_cost_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_monitor_job_drift_time_range",
                "query": {
                  "datasetName": "ds_monitor_job_drift",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range",
                "query": {
                  "datasetName": "ds_kpi_mtd",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_permissions_time_range",
                "query": {
                  "datasetName": "ds_kpi_permissions",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_high_risk_time_range",
                "query": {
                  "datasetName": "ds_kpi_high_risk",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_success_trend_time_range",
                "query": {
                  "datasetName": "ds_success_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_drift_alerts_time_range",
                "query": {
                  "datasetName": "ds_drift_alerts",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_failed_time_range",
                "query": {
                  "datasetName": "ds_kpi_failed",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_query_volume_time_range",
                "query": {
                  "datasetName": "ds_query_volume",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_lineage_trend_time_range",
                "query": {
                  "datasetName": "ds_lineage_trend",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_security_time_range",
                "query": {
                  "datasetName": "ds_kpi_security",
                  "parameters": [
                    {
                      "name": "time_range",
                      "keyword": "time_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_query_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_events_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_duration_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_slow_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_queries_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_jobs_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_unique_counts_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_query_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_risk_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_tables_by_catalog_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_duration_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_runs_by_status_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_job_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_serverless_adoption_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mttr_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_drift_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_event_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_success_rate_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_cluster_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_totals_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_cost_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_30d_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_denied_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_tag_coverage_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_30_60_compare_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_admin_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_users_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_cost_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_monitor_job_drift_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_mtd_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_permissions_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_high_risk_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_success_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_drift_alerts_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_failed_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_query_volume_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_lineage_trend_time_range"
                  },
                  {
                    "parameterName": "time_range",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_security_time_range"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Time Window"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_workspace",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_workspace_workspace_name",
                "query": {
                  "datasetName": "ds_select_workspace",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace",
                "query": {
                  "datasetName": "ds_wow_growth",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_top_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace",
                "query": {
                  "datasetName": "ds_daily_cost",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_ml_cost_anomalies_param_workspace",
                "query": {
                  "datasetName": "ds_ml_cost_anomalies",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_kpi_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_kpi_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace",
                "query": {
                  "datasetName": "ds_workspaces",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace",
                "query": {
                  "datasetName": "select_workspace",
                  "parameters": [
                    {
                      "name": "param_workspace",
                      "keyword": "param_workspace"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "dashboards/dummy/datasets/ds_select_workspace_workspace_name"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_wow_growth_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_top_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_daily_cost_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_ml_cost_anomalies_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_kpi_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_workspaces_param_workspace"
                  },
                  {
                    "parameterName": "param_workspace",
                    "queryName": "parameter_dashboards/dummy/datasets/select_workspace_param_workspace"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_param_sku_type",
            "queries": [
              {
                "name": "dashboards/dummy/datasets/ds_select_sku_sku_category",
                "query": {
                  "datasetName": "ds_select_sku",
                  "fields": [
                    {
                      "name": "sku_category",
                      "expression": "`sku_category`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku_type",
                "query": {
                  "datasetName": "ds_sku_breakdown",
                  "parameters": [
                    {
                      "name": "param_sku_type",
                      "keyword": "param_sku_type"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "sku_category",
                    "displayName": "SKU Type",
                    "queryName": "dashboards/dummy/datasets/ds_select_sku_sku_category"
                  },
                  {
                    "parameterName": "param_sku_type",
                    "queryName": "parameter_dashboards/dummy/datasets/ds_sku_breakdown_param_sku_type"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Billing Origin Product"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        }
      ],
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS"
    }
  ],
  "uiSettings": {
    "theme": {
      "canvasBackgroundColor": {
        "light": "#F7F9FA",
        "dark": "#0B0E11"
      },
      "widgetBackgroundColor": {
        "light": "#FFFFFF",
        "dark": "#1A1D21"
      },
      "widgetBorderColor": {
        "light": "#E0E4E8",
        "dark": "#2A2E33"
      },
      "fontColor": {
        "light": "#11171C",
        "dark": "#E8ECF0"
      },
      "selectionColor": {
        "light": "#077A9D",
        "dark": "#8ACAE7"
      },
      "visualizationColors": [
        "#077A9D",
        "#00A972",
        "#FFAB00",
        "#FF3621",
        "#8BCAE7",
        "#99DDB4",
        "#FCA4A1",
        "#AB4057",
        "#6B4FBB",
        "#BF7080"
      ],
      "widgetHeaderAlignment": "LEFT"
    },
    "genieSpace": {
      "isEnabled": false,
      "enablementMode": "ENABLEMENT_MODE_UNSPECIFIED"
    }
  },
  "warehouse_id": "${warehouse_id}"
}