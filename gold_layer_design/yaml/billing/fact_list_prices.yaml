# Gold Layer Table Schema
# Table: fact_list_prices
# Domain: billing
# Bronze Source: billing.list_prices
# Generated with: Enhanced LLM-friendly descriptions

table_name: fact_list_prices
domain: billing
bronze_source: billing.list_prices

description: >
  Fact table containing historical SKU pricing with effective dates.
  Business: Reference for understanding cost changes over time - tracks price adjustments per
  SKU, enabling accurate historical cost analysis and budget variance explanations. Critical
  for finance teams reconciling bills and forecasting future costs. Technical: Indefinite
  retention. New records added each time a SKU price changes. Global data across all regions.

primary_key:
  columns: ['sku_name', 'price_start_time']
  composite: True

foreign_keys:
  - columns: ['sku_name']
    references: dim_sku(sku_name)
    nullable: False

columns:
  - name: account_id
    type: STRING
    nullable: true
    description: "Account identifier. Business: Top-level organizational entity for Databricks deployment, used for account-wide cost rollups, security auditing, and multi-workspace governance. Essential for enterprise billing reconciliation and compliance reporting. Technical: Globally unique STRING identifier from Databricks account management, typically references external billing system. May be nullable in w..."

  - name: price_start_time
    type: TIMESTAMP
    nullable: false
    description: "The time this price became effective in UTC Business: Used for temporal analysis, trend tracking, and time-based filtering. Critical for historical reporting and time-series analytics. Technical: Sourced from Bronze layer. TIMESTAMP type."

  - name: price_end_time
    type: TIMESTAMP
    nullable: true
    description: "The time this price stopped being effective in UTC Business: Used for temporal analysis, trend tracking, and time-based filtering. Critical for historical reporting and time-series analytics. Technical: Sourced from Bronze layer. TIMESTAMP type."

  - name: sku_name
    type: STRING
    nullable: false
    description: "SKU identifier. Business: Product SKU determining pricing rate for this usage record. Maps to specific Databricks product offerings (compute types, storage, API calls). Essential for cost analysis, budget forecasting, and price change tracking. Foreign key to pricing tables. Technical: STRING enum from Databricks billing catalog (e.g. STANDARD_ALL_PURPOSE_COMPUTE, JOBS_LIGHT_COMPUTE), foreign k..."

  - name: cloud
    type: STRING
    nullable: true
    description: "Name of the Cloud this price is applicable to. Possible values are AWS, AZURE, and GCP. Business: Provides essential context for analytics and operational reporting. Used for filtering, grouping, and drill-down analysis. Technical: Sourced from Bronze layer. STRING type."

  - name: currency_code
    type: STRING
    nullable: true
    description: "The currency this price is expressed in Business: Provides essential context for analytics and operational reporting. Used for filtering, grouping, and drill-down analysis. Technical: Sourced from Bronze layer. STRING type."

  - name: usage_unit
    type: STRING
    nullable: true
    description: "Usage unit of measurement. Business: Defines how usage is measured and billed (DBU, requests, GB, hours, tokens). Different SKUs use different units. Critical for understanding cost drivers. Technical: STRING enum (DBU, STORAGE_GB, API_OPERATION, TOKEN, GPU_TIME, etc.) indicating measurement basis. Links to pricing model in list_prices table."

  # === Flattened Nested Columns ===

  - name: pricing_default
    type: DECIMAL(38
    nullable: true
    description: "A structured data field that includes pricing info at the published list price rate. The key default will always return a single price that can be used for simple long-term estimates. The key promotional represents a temporary promotional price that all customers get which could be used for cost estimation during the temporary period. The key effective_list resolves list and promotional price, ..."
    # Flattened from: pricing.default

  - name: pricing_promotional
    type: STRING
    nullable: true
    description: "A structured data field that includes pricing info at the published list price rate. The key default will always return a single price that can be used for simple long-term estimates. The key promotional represents a temporary promotional price that all customers get which could be used for cost estimation during the temporary period. The key effective_list resolves list and promotional price, ..."
    # Flattened from: pricing.promotional

  - name: pricing_effective_list
    type: STRING
    nullable: true
    description: "A structured data field that includes pricing info at the published list price rate. The key default will always return a single price that can be used for simple long-term estimates. The key promotional represents a temporary promotional price that all customers get which could be used for cost estimation during the temporary period. The key effective_list resolves list and promotional price, ..."
    # Flattened from: pricing.effective_list

